1
00:00:07,516 --> 00:00:16,500
[ Music ]


2
00:00:23,516 --> 00:00:30,656
[ Applause ]


3
00:00:31,156 --> 00:00:31,696
>> Good morning.


4
00:00:32,836 --> 00:00:34,026
My name is Keith Rauenbuehler,


5
00:00:34,186 --> 00:00:35,006
and I'm from the HomeKit


6
00:00:35,006 --> 00:00:35,796
Engineering team.


7
00:00:36,666 --> 00:00:37,906
Now, today we're here to talk


8
00:00:37,906 --> 00:00:39,706
about HomeKit with a focus on


9
00:00:39,706 --> 00:00:40,936
three specific areas.


10
00:00:42,276 --> 00:00:44,156
First, we'll give an overview of


11
00:00:44,156 --> 00:00:47,086
HomeKit and the Home app.


12
00:00:47,086 --> 00:00:48,686
Then, we'll outline what it


13
00:00:48,686 --> 00:00:50,286
takes to build a HomeKit


14
00:00:50,286 --> 00:00:50,796
accessory.


15
00:00:51,946 --> 00:00:53,686
And finally, we'll look at some


16
00:00:53,686 --> 00:00:55,206
HomeKit APIs and how to use


17
00:00:55,906 --> 00:00:56,016
them.


18
00:00:56,936 --> 00:00:58,146
So let's jump right in.


19
00:00:58,826 --> 00:01:02,186
So the best way to really


20
00:01:02,186 --> 00:01:04,075
understand the power of HomeKit


21
00:01:04,676 --> 00:01:05,736
is to take a look at the Home


22
00:01:06,596 --> 00:01:06,686
app.


23
00:01:07,356 --> 00:01:09,386
It's a single app interface to


24
00:01:09,416 --> 00:01:10,946
all of your HomeKit accessories.


25
00:01:12,236 --> 00:01:13,066
Now, there are a ton of


26
00:01:13,066 --> 00:01:14,436
capabilities packed into the


27
00:01:14,436 --> 00:01:16,086
Home app, and we'll use this


28
00:01:16,086 --> 00:01:17,816
session today to talk about some


29
00:01:17,816 --> 00:01:18,856
of the most important ones.


30
00:01:19,396 --> 00:01:21,666
And the Home app currently


31
00:01:21,666 --> 00:01:25,356
exists on iPad, iPhone, and


32
00:01:25,356 --> 00:01:25,936
Apple Watch.


33
00:01:26,566 --> 00:01:29,716
And the Home app has three basic


34
00:01:29,716 --> 00:01:30,186
tabs.


35
00:01:30,616 --> 00:01:32,906
There's the Home tab, which is


36
00:01:32,906 --> 00:01:34,376
where you'll find your favorite


37
00:01:34,376 --> 00:01:35,866
HomeKit accessories and your


38
00:01:35,866 --> 00:01:36,436
scenes.


39
00:01:37,446 --> 00:01:39,516
There's the Rooms tab, which is


40
00:01:39,516 --> 00:01:41,906
a great, it's a great tab to dig


41
00:01:41,906 --> 00:01:43,516
into a specific room and view


42
00:01:43,516 --> 00:01:44,786
all of the accessories


43
00:01:44,786 --> 00:01:45,976
associated with that room.


44
00:01:47,056 --> 00:01:49,226
And the Automations tab, which


45
00:01:49,226 --> 00:01:50,556
is where you'll be able to set


46
00:01:50,556 --> 00:01:52,456
up and manage your smart home


47
00:01:52,456 --> 00:01:53,116
automations.


48
00:01:53,696 --> 00:01:57,016
Now, controlling accessory in


49
00:01:57,016 --> 00:01:58,136
the Home app is simple.


50
00:01:59,246 --> 00:02:01,096
To toggle the state of it, just


51
00:02:01,096 --> 00:02:01,866
tap on the tile.


52
00:02:02,926 --> 00:02:04,106
So if you want to turn on a


53
00:02:04,106 --> 00:02:06,286
light, all you need to do is tap


54
00:02:06,286 --> 00:02:07,726
on the tile for it.


55
00:02:11,476 --> 00:02:13,016
Now, if you want finer-grain


56
00:02:13,016 --> 00:02:16,096
control, you can use 3D touch to


57
00:02:16,096 --> 00:02:17,136
bring up our quick controls.


58
00:02:17,686 --> 00:02:18,716
And so if we go back to that


59
00:02:18,716 --> 00:02:20,686
same light and we want to adjust


60
00:02:20,816 --> 00:02:22,146
the overall brightness -- say


61
00:02:22,146 --> 00:02:23,876
it's a dimmer switch -- we can


62
00:02:23,876 --> 00:02:26,296
3D press on the tile, and we can


63
00:02:26,296 --> 00:02:27,196
bring up our quick controls.


64
00:02:32,506 --> 00:02:33,806
Now, we've also added scenes to


65
00:02:33,806 --> 00:02:35,716
the Home app, and scenes are a


66
00:02:35,716 --> 00:02:37,266
great way to allow you control--


67
00:02:37,516 --> 00:02:38,636
allow you to control multiple


68
00:02:38,636 --> 00:02:40,876
accessories with a single tap.


69
00:02:41,916 --> 00:02:43,406
A scene is our simple interface


70
00:02:43,746 --> 00:02:45,016
for tying multiple accessories


71
00:02:45,016 --> 00:02:46,716
together, whether it's kicking


72
00:02:46,716 --> 00:02:49,406
off your morning routine or


73
00:02:49,406 --> 00:02:50,536
setting up your living room to


74
00:02:50,536 --> 00:02:51,536
the perfect movie-watching


75
00:02:51,536 --> 00:02:51,956
environment.


76
00:02:52,306 --> 00:02:53,866
Now, throughout the day, your


77
00:02:53,866 --> 00:02:54,826
home is always changing.


78
00:02:55,586 --> 00:02:56,666
People may come and go.


79
00:02:57,326 --> 00:02:59,276
Lights might turn on or off.


80
00:02:59,826 --> 00:03:00,996
Blinds can open and close.


81
00:03:01,306 --> 00:03:02,406
And scenes allow you to


82
00:03:02,406 --> 00:03:03,966
basically specify a desired


83
00:03:03,966 --> 00:03:05,346
state for all these accessories.


84
00:03:06,136 --> 00:03:07,126
So you can have a good night


85
00:03:07,126 --> 00:03:08,956
scene that turns off the lights,


86
00:03:09,496 --> 00:03:11,596
closes the blinds, locks the


87
00:03:11,596 --> 00:03:13,216
door, and sets the thermostat.


88
00:03:14,386 --> 00:03:15,576
Then, when you're ready for bed,


89
00:03:16,086 --> 00:03:17,676
you simply tap on the tile for


90
00:03:17,676 --> 00:03:19,596
"Good Night," and HomeKit


91
00:03:19,596 --> 00:03:20,446
prepares your house for the


92
00:03:20,446 --> 00:03:20,726
evening.


93
00:03:29,326 --> 00:03:32,476
Now, in iOS, we also have quick


94
00:03:32,476 --> 00:03:34,046
access to Home shortcuts via


95
00:03:34,046 --> 00:03:34,736
Control Center.


96
00:03:35,796 --> 00:03:37,196
This is a great way to view and


97
00:03:37,196 --> 00:03:38,756
control your favorite HomeKit


98
00:03:38,756 --> 00:03:40,476
accessories, and it even


99
00:03:40,476 --> 00:03:41,986
provides access to your scenes.


100
00:03:42,586 --> 00:03:44,386
Now, this is very-- really


101
00:03:44,386 --> 00:03:46,466
convenient, but another great


102
00:03:46,466 --> 00:03:47,416
way to control HomeKit


103
00:03:47,416 --> 00:03:48,976
accessories is through Siri.


104
00:03:49,596 --> 00:03:52,066
You can tell Siri good morning,


105
00:03:52,066 --> 00:03:54,046
and that will kick off your good


106
00:03:54,046 --> 00:03:54,686
morning scene.


107
00:03:55,336 --> 00:03:57,816
You can also use Siri to control


108
00:03:57,816 --> 00:03:59,356
individual HomeKit accessories.


109
00:04:00,046 --> 00:04:01,346
So you can use Siri to turn on


110
00:04:01,346 --> 00:04:03,826
your light in the kitchen or to


111
00:04:03,826 --> 00:04:04,966
make sure your door is locked.


112
00:04:05,756 --> 00:04:06,946
You could even use Siri to bring


113
00:04:06,946 --> 00:04:08,116
up your favorite HomeKit camera


114
00:04:08,116 --> 00:04:08,566
stream.


115
00:04:09,636 --> 00:04:13,196
Now, up until now, HomeKit has


116
00:04:13,456 --> 00:04:16,956
only existed on iOS, watchOS,


117
00:04:17,076 --> 00:04:17,776
and tvOS.


118
00:04:18,776 --> 00:04:20,086
But this year, we're excited to


119
00:04:20,086 --> 00:04:21,386
announce that we're bringing the


120
00:04:21,386 --> 00:04:22,926
Home app to the Mac.


121
00:04:24,516 --> 00:04:29,176
[ Applause ]


122
00:04:29,676 --> 00:04:30,766
Now, we're really excited about


123
00:04:30,796 --> 00:04:32,396
this, as it's a great way to


124
00:04:32,396 --> 00:04:34,096
control your home using your


125
00:04:34,096 --> 00:04:36,136
computer, all without taking


126
00:04:36,136 --> 00:04:37,126
your phone out of your pocket.


127
00:04:38,656 --> 00:04:41,016
It's also a great way to monitor


128
00:04:41,016 --> 00:04:42,306
your home because you'll get


129
00:04:42,306 --> 00:04:44,166
your HomeKit notifications right


130
00:04:44,166 --> 00:04:44,656
on your Mac.


131
00:04:45,916 --> 00:04:47,416
And we've even built HomeKit


132
00:04:47,626 --> 00:04:49,696
Siri integration on the Mac as


133
00:04:49,696 --> 00:04:51,416
well, so you can use all of your


134
00:04:51,416 --> 00:04:53,586
favorite Siri triggers to


135
00:04:53,586 --> 00:04:54,586
control your accessories


136
00:04:54,586 --> 00:04:55,596
directly from your computer.


137
00:04:55,926 --> 00:04:57,366
Now, one of Apple's newest


138
00:04:57,366 --> 00:04:59,916
products, the HomePod, is my


139
00:04:59,916 --> 00:05:00,926
favorite way to control my


140
00:05:00,926 --> 00:05:01,826
HomeKit accessories.


141
00:05:02,356 --> 00:05:03,576
Not only is it a great music


142
00:05:03,576 --> 00:05:06,836
speaker, it's also a great way


143
00:05:06,836 --> 00:05:07,676
to control your HomeKit


144
00:05:07,676 --> 00:05:09,566
accessories because anyone in


145
00:05:09,616 --> 00:05:11,236
your house can use it using just


146
00:05:11,236 --> 00:05:11,756
their voice.


147
00:05:13,276 --> 00:05:15,276
This hands-free Siri interface


148
00:05:15,936 --> 00:05:17,126
allows you to quickly and easily


149
00:05:17,126 --> 00:05:18,206
control these accessories in


150
00:05:18,206 --> 00:05:18,636
your home.


151
00:05:19,176 --> 00:05:21,226
It's really simple to get


152
00:05:21,226 --> 00:05:23,286
started, and I love using my


153
00:05:23,286 --> 00:05:24,946
HomePod to control the lights in


154
00:05:24,946 --> 00:05:25,486
my house.


155
00:05:26,836 --> 00:05:27,996
It's especially convenient when


156
00:05:27,996 --> 00:05:29,556
I walk into the kitchen with my


157
00:05:29,556 --> 00:05:31,736
arms full of stuff, and I can


158
00:05:31,826 --> 00:05:33,096
use my voice to tell Siri to


159
00:05:33,096 --> 00:05:33,806
turn on the lights.


160
00:05:35,736 --> 00:05:37,086
Now, we've also gotten a lot of


161
00:05:37,086 --> 00:05:39,496
feedback from users saying they


162
00:05:39,496 --> 00:05:41,036
love using their HomePod to


163
00:05:41,036 --> 00:05:42,056
trigger their good night scene.


164
00:05:43,126 --> 00:05:44,466
They simply tell Siri good night


165
00:05:44,466 --> 00:05:45,506
as they head off to bed.


166
00:05:46,186 --> 00:05:50,356
Now, the HomePod also plays a


167
00:05:50,356 --> 00:05:53,816
much more powerful role in the


168
00:05:53,976 --> 00:05:56,946
home, as it helps control remote


169
00:05:56,946 --> 00:05:58,686
access and automations.


170
00:05:59,326 --> 00:06:01,846
Now, remote access is one of my


171
00:06:01,846 --> 00:06:03,766
favorite features in HomeKit, as


172
00:06:03,966 --> 00:06:05,936
it allows you to monitor your


173
00:06:05,936 --> 00:06:07,286
home when you're not there.


174
00:06:08,646 --> 00:06:09,826
So you can have peace of mind,


175
00:06:10,106 --> 00:06:11,546
and you can check to make sure


176
00:06:11,546 --> 00:06:14,206
your garage door is closed or


177
00:06:14,206 --> 00:06:15,196
make sure your thermostat's


178
00:06:15,196 --> 00:06:16,006
turned off when you're not at


179
00:06:16,006 --> 00:06:16,396
home.


180
00:06:17,466 --> 00:06:18,586
And you can do this all while


181
00:06:18,586 --> 00:06:19,086
being remote.


182
00:06:19,586 --> 00:06:21,716
Now, this feature requires a


183
00:06:21,716 --> 00:06:25,666
home hub, but HomePod, Apple TV,


184
00:06:25,906 --> 00:06:27,536
and iPad have the home hub


185
00:06:27,536 --> 00:06:32,236
functionality built right in.


186
00:06:32,456 --> 00:06:33,956
So with remote access, you can


187
00:06:33,956 --> 00:06:35,436
keep tabs on your home while


188
00:06:35,436 --> 00:06:35,756
you're away.


189
00:06:36,566 --> 00:06:38,136
And you may also want to share


190
00:06:38,136 --> 00:06:39,856
some of this support from this


191
00:06:39,856 --> 00:06:41,486
control with other users.


192
00:06:42,516 --> 00:06:43,876
With HomeKit, you have control


193
00:06:43,996 --> 00:06:45,316
over granting remote access to


194
00:06:45,316 --> 00:06:47,276
some users and then specifying


195
00:06:47,276 --> 00:06:48,536
other users to only control


196
00:06:48,536 --> 00:06:49,646
accessories while locally.


197
00:06:49,926 --> 00:06:53,186
So let's talk a little bit about


198
00:06:53,186 --> 00:06:54,526
how remote access works.


199
00:06:55,956 --> 00:06:56,936
So when you're in your home,


200
00:06:57,866 --> 00:06:59,626
your Apple device communicates


201
00:06:59,626 --> 00:07:01,506
directly with your accessories.


202
00:07:02,746 --> 00:07:04,176
But when you leave your home,


203
00:07:05,476 --> 00:07:07,236
you'll need a home hub -- again,


204
00:07:07,236 --> 00:07:09,556
this is a HomePod, an Apple TV,


205
00:07:09,896 --> 00:07:12,546
or an iPad -- and your iPhone


206
00:07:12,546 --> 00:07:13,606
will communicate with your home


207
00:07:13,606 --> 00:07:15,606
hub, and your home hub will talk


208
00:07:15,606 --> 00:07:16,616
to your accessories directly.


209
00:07:17,156 --> 00:07:20,666
You can look at the latest state


210
00:07:20,666 --> 00:07:21,656
of these accessories.


211
00:07:22,086 --> 00:07:23,306
You can view the stream from one


212
00:07:23,306 --> 00:07:24,116
of your cameras.


213
00:07:24,116 --> 00:07:26,416
You can even lock your door if


214
00:07:26,416 --> 00:07:27,456
you've forgotten to secure your


215
00:07:27,456 --> 00:07:28,556
house before you left for the


216
00:07:29,216 --> 00:07:29,283
day.


217
00:07:29,446 --> 00:07:31,336
Now, we saw earlier how easy it


218
00:07:31,336 --> 00:07:32,926
to leverage scenes to get


219
00:07:32,926 --> 00:07:33,996
devices to work together.


220
00:07:34,506 --> 00:07:35,916
Now, scenes are great, but


221
00:07:35,916 --> 00:07:37,186
automations allow you to run


222
00:07:37,186 --> 00:07:38,276
scenes automatically.


223
00:07:39,196 --> 00:07:41,166
So you can do so without


224
00:07:41,166 --> 00:07:43,406
launching the Home app or using


225
00:07:43,906 --> 00:07:46,396
your voice.


226
00:07:46,586 --> 00:07:47,846
Automations allow you to control


227
00:07:47,846 --> 00:07:50,446
individual accessories or entire


228
00:07:50,446 --> 00:07:51,876
scenes based on some key


229
00:07:51,876 --> 00:07:53,796
triggers -- things like someone


230
00:07:53,796 --> 00:07:56,116
arriving home or having it run


231
00:07:56,116 --> 00:07:57,336
at a specific time of the day.


232
00:07:58,246 --> 00:08:00,056
You can even use other


233
00:08:00,056 --> 00:08:01,096
accessories in the house to


234
00:08:01,096 --> 00:08:02,086
trigger automations.


235
00:08:03,346 --> 00:08:05,216
Automations can be as simple as


236
00:08:05,486 --> 00:08:06,866
turning on the back porch light


237
00:08:06,966 --> 00:08:09,476
when the back door opens or


238
00:08:10,746 --> 00:08:11,886
turning down the air conditioner


239
00:08:12,486 --> 00:08:13,926
when someone leaves.


240
00:08:15,546 --> 00:08:16,996
Now, we also support more


241
00:08:16,996 --> 00:08:21,436
complex automations so you can


242
00:08:21,496 --> 00:08:23,506
open your garage door, turn on


243
00:08:23,506 --> 00:08:25,456
your lights, open your shades,


244
00:08:25,606 --> 00:08:27,546
and set your thermostat to just


245
00:08:27,546 --> 00:08:29,066
the right temperature all as you


246
00:08:29,066 --> 00:08:29,916
pull into your driveway.


247
00:08:30,516 --> 00:08:31,516
Now, this is one of my favorite


248
00:08:31,516 --> 00:08:33,895
automations, as I'm frequently


249
00:08:34,426 --> 00:08:37,606
juggling groceries, or kids, or


250
00:08:37,606 --> 00:08:38,846
even finishing up a phone call


251
00:08:38,976 --> 00:08:39,796
as I get home.


252
00:08:40,446 --> 00:08:41,576
This allows me to get in my


253
00:08:41,576 --> 00:08:43,456
house without needing to fumble


254
00:08:43,456 --> 00:08:44,356
with my keys as well.


255
00:08:47,356 --> 00:08:49,286
Now, one of the key things that


256
00:08:49,286 --> 00:08:50,656
HomeKit provides to the customer


257
00:08:50,736 --> 00:08:53,506
is an incredibly easy way to add


258
00:08:53,506 --> 00:08:54,946
an accessory to your home and to


259
00:08:54,946 --> 00:08:55,576
your home network.


260
00:08:56,966 --> 00:08:58,516
Other services often require


261
00:08:58,516 --> 00:09:00,606
downloading an app, following


262
00:09:00,916 --> 00:09:03,366
custom instructions, and jumping


263
00:09:03,366 --> 00:09:04,466
through a lot of hoops to get an


264
00:09:04,466 --> 00:09:05,316
accessory on your network.


265
00:09:06,036 --> 00:09:08,076
Now, if you've ever set up a


266
00:09:08,076 --> 00:09:10,136
non-HomeKit accessory, you know


267
00:09:10,136 --> 00:09:11,276
just how frustrating of an


268
00:09:11,276 --> 00:09:12,896
experience this can be.


269
00:09:13,696 --> 00:09:15,486
With HomeKit, the add accessory


270
00:09:15,486 --> 00:09:16,416
flow is really simple.


271
00:09:17,456 --> 00:09:19,146
All you do is launch the Home


272
00:09:19,146 --> 00:09:21,306
app and scan the accessory code.


273
00:09:22,596 --> 00:09:24,086
HomeKit handles the rest.


274
00:09:24,706 --> 00:09:25,626
It's really that easy.


275
00:09:26,166 --> 00:09:29,186
And accessories can also use NFC


276
00:09:29,376 --> 00:09:31,326
to make this setup even easier.


277
00:09:32,426 --> 00:09:33,576
So you can launch the Home app,


278
00:09:34,156 --> 00:09:35,306
tap on the accessory with your


279
00:09:35,306 --> 00:09:36,816
phone, and you're done.


280
00:09:40,916 --> 00:09:42,586
Now, the great thing about


281
00:09:42,586 --> 00:09:44,166
HomeKit is that it's both secure


282
00:09:44,166 --> 00:09:44,636
and private.


283
00:09:45,906 --> 00:09:47,956
All accessory communication is


284
00:09:47,956 --> 00:09:50,666
encrypted, and we create a new


285
00:09:50,666 --> 00:09:52,096
shared secret for each session.


286
00:09:52,676 --> 00:09:56,806
The data is also private, so


287
00:09:56,806 --> 00:09:58,246
Apple doesn't have access to


288
00:09:58,246 --> 00:09:59,566
your camera streams.


289
00:09:59,816 --> 00:10:01,106
Apple can't listen in on your


290
00:10:01,106 --> 00:10:02,056
conversations.


291
00:10:02,376 --> 00:10:03,726
Apple can't even tell if you


292
00:10:03,726 --> 00:10:04,796
have a light bulb turned on or


293
00:10:04,796 --> 00:10:05,046
off.


294
00:10:06,106 --> 00:10:07,216
We know your home is private,


295
00:10:07,216 --> 00:10:08,976
and we want to keep it that way.


296
00:10:09,656 --> 00:10:11,316
So you can monitor your home,


297
00:10:12,036 --> 00:10:14,376
control accessories, execute


298
00:10:14,376 --> 00:10:16,536
scenes, and even use full Siri


299
00:10:16,536 --> 00:10:17,836
support all in a secure and


300
00:10:17,836 --> 00:10:18,296
private way.


301
00:10:18,296 --> 00:10:22,816
We want this communication to be


302
00:10:22,816 --> 00:10:24,726
super secure, and so all


303
00:10:24,876 --> 00:10:26,076
messaging is done directly


304
00:10:26,076 --> 00:10:28,466
between the Apple device and the


305
00:10:28,466 --> 00:10:29,066
accessory.


306
00:10:29,486 --> 00:10:32,016
So your accessory never needs to


307
00:10:32,016 --> 00:10:35,306
talk to the cloud.


308
00:10:35,306 --> 00:10:36,136
In addition to this being


309
00:10:36,136 --> 00:10:37,956
secure, it's also really fast


310
00:10:38,456 --> 00:10:40,226
because all the messaging is


311
00:10:40,226 --> 00:10:42,846
done locally and there's no need


312
00:10:42,846 --> 00:10:44,000
to round trip to a server.


313
00:10:48,776 --> 00:10:51,756
Now, our HomeKit Accessory


314
00:10:51,756 --> 00:10:53,636
Protocol is the communication


315
00:10:53,636 --> 00:10:55,216
channel for secure messaging


316
00:10:55,466 --> 00:10:56,576
between an accessory and your


317
00:10:56,576 --> 00:10:57,276
Apple device.


318
00:10:58,456 --> 00:11:00,616
These messages are encrypted so


319
00:11:00,616 --> 00:11:01,996
that only the trusted devices


320
00:11:01,996 --> 00:11:02,506
can read them.


321
00:11:03,476 --> 00:11:04,676
This means that if someone else,


322
00:11:04,936 --> 00:11:06,006
something does intercept the


323
00:11:06,006 --> 00:11:07,726
message, they can't decrypt it


324
00:11:07,726 --> 00:11:08,826
and understand what it says.


325
00:11:09,896 --> 00:11:11,046
And the HomeKit Accessory


326
00:11:11,046 --> 00:11:13,946
Protocol works over Wi-Fi and


327
00:11:13,946 --> 00:11:14,926
Bluetooth Low Energy.


328
00:11:15,256 --> 00:11:18,056
And by IP, we mean Wi-Fi and


329
00:11:18,056 --> 00:11:18,426
Ethernet.


330
00:11:18,746 --> 00:11:20,386
And Wi-Fi's great because it


331
00:11:20,386 --> 00:11:22,106
provides reliable, fast,


332
00:11:22,236 --> 00:11:23,876
long-range support, so you can


333
00:11:23,876 --> 00:11:25,516
position Wi-Fi accessories


334
00:11:25,606 --> 00:11:26,496
anywhere in your house.


335
00:11:27,346 --> 00:11:29,046
And we also support Bluetooth


336
00:11:29,046 --> 00:11:29,626
Low Energy.


337
00:11:30,516 --> 00:11:31,706
This is also great because --


338
00:11:32,356 --> 00:11:34,156
especially for accessories that


339
00:11:34,156 --> 00:11:35,076
are battery operated.


340
00:11:36,066 --> 00:11:38,056
So for things like sensors, you


341
00:11:38,056 --> 00:11:39,516
can use Bluetooth Low Energy,


342
00:11:39,956 --> 00:11:41,206
and you can position these


343
00:11:41,206 --> 00:11:42,996
sensors in convenient locations


344
00:11:42,996 --> 00:11:43,996
because they don't require a


345
00:11:43,996 --> 00:11:44,506
power cord.


346
00:11:45,056 --> 00:11:48,936
Now, we want everyone to


347
00:11:48,936 --> 00:11:50,556
experience home automation, and


348
00:11:50,556 --> 00:11:51,926
so we provide lots of accessory


349
00:11:51,926 --> 00:11:53,576
categories, and we have some of


350
00:11:53,576 --> 00:11:55,726
the top manufacturers in each


351
00:11:55,726 --> 00:11:56,196
category.


352
00:11:56,496 --> 00:11:59,076
Now, we have an ever-growing


353
00:11:59,076 --> 00:12:00,786
list of categories, and we


354
00:12:00,786 --> 00:12:02,336
support multiple manufacturers


355
00:12:02,336 --> 00:12:03,316
in these categories.


356
00:12:04,046 --> 00:12:05,666
So you can find the one that's


357
00:12:05,666 --> 00:12:06,116
right for you.


358
00:12:07,396 --> 00:12:08,766
With HomeKit, you can even


359
00:12:09,526 --> 00:12:10,866
combine accessories in the same


360
00:12:10,866 --> 00:12:12,206
category from different


361
00:12:12,206 --> 00:12:13,646
manufacturers and have them work


362
00:12:13,646 --> 00:12:14,056
together.


363
00:12:14,836 --> 00:12:16,186
HomeKit makes it easy for you to


364
00:12:16,186 --> 00:12:17,546
choose the accessory that's


365
00:12:17,546 --> 00:12:18,196
right for your home.


366
00:12:18,786 --> 00:12:21,786
Now, with AirPlay 2, we've added


367
00:12:21,786 --> 00:12:23,016
support for adding speakers to


368
00:12:23,016 --> 00:12:24,186
the Home app.


369
00:12:25,236 --> 00:12:27,186
And in iOS 12, we're also


370
00:12:27,186 --> 00:12:28,476
releasing support for remote


371
00:12:28,476 --> 00:12:29,316
control systems.


372
00:12:30,776 --> 00:12:32,016
Now you can create a remote


373
00:12:32,016 --> 00:12:33,846
control accessory that's able to


374
00:12:33,846 --> 00:12:36,306
control your Apple TV, including


375
00:12:36,306 --> 00:12:37,156
support for Siri.


376
00:12:37,766 --> 00:12:41,166
Now that we've given a quick


377
00:12:41,166 --> 00:12:43,166
recap of the benefits of using


378
00:12:43,166 --> 00:12:45,646
HomeKit, let's dive in and see


379
00:12:45,646 --> 00:12:47,266
what resources are available for


380
00:12:47,266 --> 00:12:48,266
making a HomeKit accessory.


381
00:12:48,906 --> 00:12:51,716
So the easiest way to get


382
00:12:51,716 --> 00:12:53,046
started with HomeKit and


383
00:12:53,046 --> 00:12:54,406
building an accessory is to


384
00:12:54,406 --> 00:12:55,746
become an MFI licensee.


385
00:12:57,116 --> 00:12:58,906
It's a great program with lots


386
00:12:58,906 --> 00:13:00,016
of valuable tools that I can't


387
00:13:00,016 --> 00:13:00,896
wait to tell you all about.


388
00:13:00,896 --> 00:13:03,386
Now, if you just want to learn


389
00:13:03,386 --> 00:13:04,356
about the HomeKit Accessory


390
00:13:04,356 --> 00:13:06,066
Protocol, we also have that


391
00:13:06,066 --> 00:13:07,416
available for developers.


392
00:13:08,106 --> 00:13:09,776
Now, this is for noncommercial


393
00:13:09,776 --> 00:13:11,706
use to explore and experiment


394
00:13:11,866 --> 00:13:12,766
with the HomeKit Accessory


395
00:13:12,766 --> 00:13:13,226
Protocol.


396
00:13:14,286 --> 00:13:16,056
So this is great for learning


397
00:13:16,056 --> 00:13:17,286
about the HomeKit Accessory


398
00:13:17,286 --> 00:13:18,906
Protocol, but if you're serious


399
00:13:18,906 --> 00:13:19,756
about building a HomeKit


400
00:13:19,756 --> 00:13:22,026
accessory, we really encourage


401
00:13:22,026 --> 00:13:24,106
you to join the MFI program


402
00:13:24,636 --> 00:13:25,626
because it's the best way to get


403
00:13:25,626 --> 00:13:26,466
off to a quick start.


404
00:13:26,506 --> 00:13:30,096
So let's talk a little bit


405
00:13:30,096 --> 00:13:32,076
about, what are the benefits of


406
00:13:32,076 --> 00:13:36,086
being part of the MFI program?


407
00:13:36,086 --> 00:13:37,846
So becoming an MFI is really


408
00:13:37,846 --> 00:13:39,156
easy, and you'll get lots of


409
00:13:39,156 --> 00:13:40,266
tools and resources.


410
00:13:40,926 --> 00:13:42,396
And one of the newest tools that


411
00:13:42,396 --> 00:13:44,056
we're really excited about is


412
00:13:44,056 --> 00:13:45,046
the HomeKit Accessory


413
00:13:45,046 --> 00:13:46,916
Development Kit.


414
00:13:47,056 --> 00:13:48,046
This is an easy way to get


415
00:13:48,046 --> 00:13:50,006
started on building a HomeKit


416
00:13:50,006 --> 00:13:50,486
accessory.


417
00:13:51,076 --> 00:13:53,506
Now, this Dis a set of code that


418
00:13:53,506 --> 00:13:55,606
runs on the accessory to help


419
00:13:55,606 --> 00:13:56,736
abstract away a lot of the


420
00:13:56,736 --> 00:13:58,076
implementation details that you


421
00:13:58,076 --> 00:13:59,346
previously have to worry about.


422
00:13:59,896 --> 00:14:02,276
Now, we also have tools to help


423
00:14:02,276 --> 00:14:04,316
with certification, and we also


424
00:14:04,316 --> 00:14:05,986
provide access to documentation


425
00:14:05,986 --> 00:14:09,176
to help you get off the ground.


426
00:14:09,176 --> 00:14:10,226
You'll also get a copy of the


427
00:14:10,226 --> 00:14:11,506
specification that has all the


428
00:14:11,506 --> 00:14:13,996
commercial support, including


429
00:14:14,106 --> 00:14:15,356
how to build authentication


430
00:14:15,436 --> 00:14:16,326
right into your accessory.


431
00:14:16,966 --> 00:14:21,266
Now, the ADK makes it easy than


432
00:14:21,266 --> 00:14:22,156
ever to build a HomeKit


433
00:14:22,156 --> 00:14:22,626
accessory.


434
00:14:24,016 --> 00:14:24,966
Previously, you would need to


435
00:14:24,966 --> 00:14:26,116
worry about building your


436
00:14:26,116 --> 00:14:28,516
accessory logic, adopting the


437
00:14:28,516 --> 00:14:30,786
protocol, implementing crypto,


438
00:14:31,326 --> 00:14:32,886
adopting WAC, all these other


439
00:14:32,886 --> 00:14:33,366
steps.


440
00:14:34,006 --> 00:14:35,116
With the accessory development


441
00:14:35,116 --> 00:14:36,976
kit, we've abstracted all this


442
00:14:36,976 --> 00:14:37,486
away for you.


443
00:14:38,126 --> 00:14:39,856
So we provide the platform logic


444
00:14:40,336 --> 00:14:42,396
for your specific accessory, and


445
00:14:42,396 --> 00:14:43,126
the HomeKit Accessory


446
00:14:43,126 --> 00:14:44,516
Development Kit handles a lot of


447
00:14:44,516 --> 00:14:45,216
the details.


448
00:14:46,186 --> 00:14:47,196
This means you only need to


449
00:14:47,196 --> 00:14:48,246
worry about that accessory


450
00:14:48,246 --> 00:14:49,426
logic, which is the part that's


451
00:14:49,426 --> 00:14:51,366
unique to your accessory and is


452
00:14:51,366 --> 00:14:52,696
the part of the code that you


453
00:14:52,696 --> 00:14:53,566
care about.


454
00:14:55,516 --> 00:15:01,436
[ Applause ]


455
00:15:01,936 --> 00:15:03,496
Now, the HomeKit ADK is new, but


456
00:15:03,776 --> 00:15:04,796
we've already gotten a ton of


457
00:15:04,796 --> 00:15:06,416
great feedback from our partners


458
00:15:06,646 --> 00:15:07,906
on how simple it is to use.


459
00:15:08,796 --> 00:15:10,376
MFI licensees are finding it


460
00:15:10,706 --> 00:15:12,256
easier than ever to get started,


461
00:15:12,476 --> 00:15:13,526
and we're seeing that the


462
00:15:13,896 --> 00:15:15,226
ramp-up time for new partners is


463
00:15:15,226 --> 00:15:16,246
faster than ever before.


464
00:15:17,456 --> 00:15:18,976
And of course, the ADK is


465
00:15:18,976 --> 00:15:20,976
reliable and secure, as we've


466
00:15:20,976 --> 00:15:22,336
tested it thoroughly internally,


467
00:15:22,636 --> 00:15:23,536
and it's been reviewed by our


468
00:15:23,536 --> 00:15:24,326
security folks.


469
00:15:25,316 --> 00:15:26,986
Now, the really nice thing about


470
00:15:26,986 --> 00:15:29,066
the ADK is that we'll continue


471
00:15:29,066 --> 00:15:29,946
to update it throughout the


472
00:15:29,946 --> 00:15:31,896
year, so whenever there's an iOS


473
00:15:31,896 --> 00:15:33,846
update that releases new support


474
00:15:34,166 --> 00:15:35,456
for accessories or to the spec,


475
00:15:35,806 --> 00:15:37,766
we'll also rev the ADK so that


476
00:15:37,906 --> 00:15:38,926
it'll stay in sync.


477
00:15:39,586 --> 00:15:43,016
So how much faster is it to use


478
00:15:43,016 --> 00:15:43,956
the ADK?


479
00:15:45,136 --> 00:15:46,816
Well, with the ADK, you can


480
00:15:46,816 --> 00:15:48,336
build a functional prototype and


481
00:15:48,336 --> 00:15:49,416
have it up and running within


482
00:15:49,416 --> 00:15:49,906
just a week.


483
00:15:51,446 --> 00:15:52,336
But let's look at how that


484
00:15:52,336 --> 00:15:53,776
impacts the overall timeline.


485
00:15:54,326 --> 00:15:58,716
So previously, our partners were


486
00:15:58,716 --> 00:16:00,306
spending about 6 months for


487
00:16:00,306 --> 00:16:01,556
development, and then they'd


488
00:16:01,556 --> 00:16:03,366
have to do integration,


489
00:16:03,426 --> 00:16:04,816
certification before they could


490
00:16:04,816 --> 00:16:05,566
ship their product.


491
00:16:06,366 --> 00:16:07,576
We were finding this would often


492
00:16:07,576 --> 00:16:09,116
take about a year to complete.


493
00:16:11,136 --> 00:16:13,446
So with the ADK, we're seeing


494
00:16:13,446 --> 00:16:14,646
that timeline get dramatically


495
00:16:14,646 --> 00:16:15,126
decreased.


496
00:16:16,546 --> 00:16:17,416
Based on feedback from our


497
00:16:17,416 --> 00:16:19,886
partners, it's now possible to


498
00:16:19,886 --> 00:16:20,846
ship out HomeKit accessory


499
00:16:20,846 --> 00:16:23,176
within just 3 months.


500
00:16:24,516 --> 00:16:27,556
[ Applause ]


501
00:16:28,056 --> 00:16:30,066
The ADK makes it easier than


502
00:16:30,066 --> 00:16:31,366
ever to build a HomeKit


503
00:16:31,366 --> 00:16:31,796
accessory.


504
00:16:32,416 --> 00:16:33,806
To learn more about it, join the


505
00:16:33,806 --> 00:16:34,566
MFI program.


506
00:16:35,066 --> 00:16:36,126
You'll have access to all the


507
00:16:36,126 --> 00:16:37,506
ADK information that our


508
00:16:37,506 --> 00:16:38,686
licensees are already using


509
00:16:38,686 --> 00:16:39,626
today to build great


510
00:16:39,626 --> 00:16:40,246
accessories.


511
00:16:41,716 --> 00:16:43,456
Now, I mentioned authentication


512
00:16:43,456 --> 00:16:45,016
before, so let's talk a little


513
00:16:45,016 --> 00:16:46,526
bit about that.


514
00:16:46,526 --> 00:16:48,086
So this is an important part of


515
00:16:48,086 --> 00:16:48,976
the MFI program.


516
00:16:49,966 --> 00:16:51,576
Now, our customers trust when


517
00:16:51,576 --> 00:16:52,756
they see that Apple logo.


518
00:16:53,146 --> 00:16:54,076
They trust that they're buying a


519
00:16:54,076 --> 00:16:54,926
high-quality product.


520
00:16:55,706 --> 00:16:58,036
So when they buy an accessory


521
00:16:58,036 --> 00:16:59,396
that works with Apple HomeKit,


522
00:17:01,176 --> 00:17:02,896
they trust that their accessory


523
00:17:02,896 --> 00:17:04,816
has been tested thoroughly and


524
00:17:04,816 --> 00:17:05,556
reviewed by Apple.


525
00:17:06,096 --> 00:17:08,175
Now, this process is similar to


526
00:17:08,175 --> 00:17:10,455
the App Store review process, so


527
00:17:10,455 --> 00:17:11,316
on the HomeKit side, we have a


528
00:17:11,316 --> 00:17:12,925
way of reviewing accessories.


529
00:17:14,056 --> 00:17:15,536
This is so they, we ensure that


530
00:17:15,536 --> 00:17:16,705
they meet our high bar of


531
00:17:16,705 --> 00:17:18,476
quality and that they're ready


532
00:17:18,476 --> 00:17:20,026
to be shipped to customers.


533
00:17:20,486 --> 00:17:23,386
Now, once an accessory is


534
00:17:23,386 --> 00:17:26,626
certified, it uses our


535
00:17:26,626 --> 00:17:27,616
authentication stack for


536
00:17:27,616 --> 00:17:28,046
onboarding.


537
00:17:28,586 --> 00:17:30,976
This helps guarantee that a


538
00:17:30,976 --> 00:17:31,666
customer is getting that


539
00:17:31,666 --> 00:17:32,456
high-quality product.


540
00:17:33,286 --> 00:17:34,596
Now, the authentication itself


541
00:17:34,596 --> 00:17:36,216
can be done using our hardware


542
00:17:36,216 --> 00:17:38,046
chip or via our new


543
00:17:38,076 --> 00:17:39,216
software-based authentication.


544
00:17:39,806 --> 00:17:43,786
Now, as an MFI licensee, you'll


545
00:17:43,786 --> 00:17:45,136
also have access to


546
00:17:45,136 --> 00:17:46,666
manufacturing partners that can


547
00:17:46,666 --> 00:17:47,686
help get your product to market.


548
00:17:48,506 --> 00:17:49,766
So if you're sitting in the


549
00:17:49,766 --> 00:17:51,316
crowd today with a great idea


550
00:17:51,316 --> 00:17:53,036
for a HomeKit accessory, this is


551
00:17:53,036 --> 00:17:55,376
your big opportunity to bring it


552
00:17:56,026 --> 00:17:57,926
to the home.


553
00:17:57,926 --> 00:17:59,206
Now, we've always supported


554
00:17:59,576 --> 00:18:00,826
hardware-based authentication,


555
00:18:01,366 --> 00:18:04,726
but we have also recently began


556
00:18:04,726 --> 00:18:05,966
supporting software-based


557
00:18:05,966 --> 00:18:06,566
authentication.


558
00:18:07,106 --> 00:18:10,956
Now, customers can be guaranteed


559
00:18:10,956 --> 00:18:12,406
the same level of quality and


560
00:18:12,406 --> 00:18:14,296
trust, and the integration


561
00:18:14,296 --> 00:18:15,736
support can be rolled out via a


562
00:18:15,736 --> 00:18:16,466
firmware update.


563
00:18:16,936 --> 00:18:19,836
Now, this is great because this


564
00:18:19,836 --> 00:18:21,096
means you can roll out HomeKit


565
00:18:21,096 --> 00:18:22,366
to accessories that are already


566
00:18:22,366 --> 00:18:23,326
shipping to customers.


567
00:18:23,916 --> 00:18:27,846
Now, there are three other great


568
00:18:27,846 --> 00:18:29,056
tools that I want to talk about


569
00:18:29,056 --> 00:18:29,506
this morning.


570
00:18:30,766 --> 00:18:32,626
The first is a resource for


571
00:18:32,626 --> 00:18:34,506
accessory developers, and this


572
00:18:34,506 --> 00:18:36,146
is available for MFI licensees,


573
00:18:36,376 --> 00:18:37,436
and this is the HomeKit


574
00:18:37,436 --> 00:18:38,356
Accessory Tester.


575
00:18:38,926 --> 00:18:41,846
Now, this is an app that allows


576
00:18:41,846 --> 00:18:43,396
an easy interface for helping


577
00:18:43,396 --> 00:18:44,626
you test your accessory.


578
00:18:46,056 --> 00:18:48,076
This is a great way to validate


579
00:18:48,076 --> 00:18:49,086
that your accessory is ready to


580
00:18:49,086 --> 00:18:50,026
be submitted to the review


581
00:18:50,026 --> 00:18:50,646
process.


582
00:18:51,176 --> 00:18:54,316
Now, the second tool I want to


583
00:18:54,316 --> 00:18:55,986
talk about is the HomeKit


584
00:18:55,986 --> 00:18:57,166
Certification Assistant.


585
00:18:59,036 --> 00:19:00,696
Now, this resource is also


586
00:19:00,696 --> 00:19:02,196
available to MFI licensees,


587
00:19:02,656 --> 00:19:04,226
which is another great benefit


588
00:19:04,226 --> 00:19:05,226
of being part of the program.


589
00:19:05,746 --> 00:19:07,576
And this is built on top of that


590
00:19:07,576 --> 00:19:08,716
HomeKit Accessory Tester.


591
00:19:09,196 --> 00:19:10,886
Now, this allows you to


592
00:19:10,886 --> 00:19:13,776
self-certify your accessory and


593
00:19:13,776 --> 00:19:16,006
even has support for automating


594
00:19:16,006 --> 00:19:17,356
some of that testing process.


595
00:19:17,816 --> 00:19:21,626
And the third tool I want to


596
00:19:21,626 --> 00:19:23,096
talk about is the HomeKit


597
00:19:23,096 --> 00:19:24,156
Accessory Simulator.


598
00:19:25,186 --> 00:19:27,026
Now, this is a tool that's


599
00:19:27,026 --> 00:19:29,186
created for app developers, and


600
00:19:29,186 --> 00:19:30,816
so it will simulate various


601
00:19:30,816 --> 00:19:31,486
accessories.


602
00:19:32,036 --> 00:19:34,646
Now, this allows you to test


603
00:19:34,646 --> 00:19:36,466
your app and make sure it plays


604
00:19:36,466 --> 00:19:37,896
with all the HomeKit accessory


605
00:19:37,896 --> 00:19:38,626
categories.


606
00:19:39,256 --> 00:19:40,436
Now, the really nice thing about


607
00:19:40,436 --> 00:19:41,636
this is it means you don't need


608
00:19:41,636 --> 00:19:42,866
to go out and buy each one of


609
00:19:42,866 --> 00:19:43,946
these accessories to do your


610
00:19:43,946 --> 00:19:44,386
testing.


611
00:19:44,916 --> 00:19:48,546
You can get this tool available


612
00:19:48,546 --> 00:19:50,256
through Xcode and also through


613
00:19:50,256 --> 00:19:51,126
the MFI program.


614
00:19:51,626 --> 00:19:54,126
And this is actually one of the


615
00:19:54,126 --> 00:19:55,786
tools that we use internally, as


616
00:19:55,786 --> 00:19:56,986
it's a great way to quickly and


617
00:19:56,986 --> 00:19:59,066
easily set up a complex home


618
00:19:59,066 --> 00:20:00,116
with lots of accessories.


619
00:20:01,386 --> 00:20:02,966
Now, of course, you'll also want


620
00:20:02,966 --> 00:20:04,276
a test with real-world


621
00:20:04,276 --> 00:20:04,996
accessories as well.


622
00:20:05,446 --> 00:20:08,746
Now, we talked quite a bit about


623
00:20:08,746 --> 00:20:10,936
making a HomeKit accessory, but


624
00:20:11,206 --> 00:20:13,606
what about making a HomeKit app?


625
00:20:14,586 --> 00:20:17,226
So let's switch gears and talk


626
00:20:17,226 --> 00:20:18,326
about what it takes to build a


627
00:20:18,326 --> 00:20:19,236
HomeKit application.


628
00:20:19,756 --> 00:20:23,646
So there are lots of apps out


629
00:20:23,646 --> 00:20:24,566
there on the App Store.


630
00:20:25,716 --> 00:20:27,106
How do you make yours stand out?


631
00:20:28,676 --> 00:20:29,956
Well, for HomeKit, it's


632
00:20:29,956 --> 00:20:31,816
important to think about your


633
00:20:31,816 --> 00:20:32,796
target audience.


634
00:20:33,366 --> 00:20:35,856
So that might mean extending


635
00:20:35,856 --> 00:20:37,296
custom functionality, like


636
00:20:37,296 --> 00:20:38,376
tuning or calibrating an


637
00:20:38,376 --> 00:20:42,086
accessory, or maybe it means you


638
00:20:42,086 --> 00:20:42,986
live in a region where there's


639
00:20:42,986 --> 00:20:44,666
some functionality that's


640
00:20:44,666 --> 00:20:46,476
specific to your locale that


641
00:20:46,476 --> 00:20:48,586
doesn't already exist in the App


642
00:20:50,776 --> 00:20:50,926
Store.


643
00:20:50,926 --> 00:20:52,666
And if you're an MFI licensee


644
00:20:53,916 --> 00:20:55,016
writing an app for your


645
00:20:55,016 --> 00:20:57,316
accessory, you may what to be


646
00:20:57,316 --> 00:20:59,916
able to support custom services


647
00:20:59,916 --> 00:21:00,986
and characteristics.


648
00:21:01,536 --> 00:21:04,416
Now, with HomeKit, there's a lot


649
00:21:04,416 --> 00:21:05,546
of APIs that I'm going to talk


650
00:21:05,546 --> 00:21:07,736
about today, but before I get


651
00:21:07,736 --> 00:21:09,416
into the details, I think it's


652
00:21:09,416 --> 00:21:10,666
important to take a look at a


653
00:21:10,666 --> 00:21:13,246
high level at the object


654
00:21:13,246 --> 00:21:13,786
hierarchy.


655
00:21:14,376 --> 00:21:16,896
So the first class that I want


656
00:21:16,896 --> 00:21:18,876
to tell you about is this core


657
00:21:18,876 --> 00:21:20,286
object, which is the HMHome.


658
00:21:20,766 --> 00:21:23,376
Now, this is corresponds to the


659
00:21:23,376 --> 00:21:27,556
overall home, and within the


660
00:21:28,296 --> 00:21:28,676
HMHome,


661
00:21:28,736 --> 00:21:30,196
you can also optionally have


662
00:21:30,196 --> 00:21:30,866
HMZones.


663
00:21:31,316 --> 00:21:32,786
Now, these are things like


664
00:21:32,786 --> 00:21:34,136
upstairs and downstairs.


665
00:21:35,146 --> 00:21:36,526
Now, you could also have


666
00:21:36,526 --> 00:21:38,566
HMRooms, and these are the rooms


667
00:21:38,816 --> 00:21:39,726
that are normally associated


668
00:21:39,726 --> 00:21:41,246
with the home -- the kitchen,


669
00:21:41,466 --> 00:21:42,706
the living room, the dining


670
00:21:42,706 --> 00:21:45,376
room, the bedroom.


671
00:21:45,626 --> 00:21:47,656
And within those rooms, you can


672
00:21:47,656 --> 00:21:48,626
have HMAccessories.


673
00:21:49,376 --> 00:21:50,506
And these are the lights, the


674
00:21:50,506 --> 00:21:52,516
fans, the cameras, the locks,


675
00:21:52,696 --> 00:21:54,206
all the normal accessories we


676
00:21:54,206 --> 00:21:54,636
support.


677
00:21:56,076 --> 00:21:57,826
So your home, the HMHome


678
00:21:57,826 --> 00:21:59,196
contains HMZones.


679
00:21:59,826 --> 00:22:02,166
The HMZone contains HMRooms.


680
00:22:02,506 --> 00:22:04,336
And the HMRoom contains


681
00:22:04,396 --> 00:22:05,206
HMAccessories.


682
00:22:09,056 --> 00:22:10,516
Now, the home has a handful of


683
00:22:10,516 --> 00:22:12,836
properties on it, but the home


684
00:22:12,836 --> 00:22:14,076
is really used as the central


685
00:22:14,126 --> 00:22:15,836
organizing object for HomeKit.


686
00:22:16,356 --> 00:22:18,866
So the home is how you add


687
00:22:18,866 --> 00:22:21,296
accessories, configure rooms,


688
00:22:21,786 --> 00:22:23,936
create scenes, and build


689
00:22:23,936 --> 00:22:24,706
automations.


690
00:22:26,076 --> 00:22:27,566
But some users may have more


691
00:22:27,566 --> 00:22:29,726
than one home, and so you'll


692
00:22:29,726 --> 00:22:32,306
need to use the HMHomeManager to


693
00:22:32,306 --> 00:22:33,646
help manage these homes.


694
00:22:34,546 --> 00:22:36,106
So if you want to add a new home


695
00:22:36,606 --> 00:22:37,936
or remove an existing home,


696
00:22:38,886 --> 00:22:39,876
that's done through the


697
00:22:39,876 --> 00:22:41,086
HMHomeManager APIs.


698
00:22:45,376 --> 00:22:46,636
Now, the great thing about


699
00:22:46,636 --> 00:22:48,616
HomeKit is you can extend home


700
00:22:48,616 --> 00:22:50,556
control to other users.


701
00:22:51,116 --> 00:22:53,866
We also have access control


702
00:22:53,866 --> 00:22:55,336
capabilities so you can give a


703
00:22:55,336 --> 00:22:57,066
spouse or a roommate full


704
00:22:57,066 --> 00:22:58,136
administrative privileges.


705
00:22:58,956 --> 00:23:01,786
Now, as an administrator, they,


706
00:23:01,786 --> 00:23:03,666
these users can add accessories,


707
00:23:03,666 --> 00:23:04,626
edit scenes.


708
00:23:04,896 --> 00:23:06,696
They basically have full control


709
00:23:06,696 --> 00:23:07,546
over the home.


710
00:23:09,316 --> 00:23:10,806
But you may only want to give


711
00:23:11,086 --> 00:23:12,806
some users normal access to the


712
00:23:12,806 --> 00:23:14,606
home and only allow them to


713
00:23:15,126 --> 00:23:16,596
control accessories and not edit


714
00:23:16,596 --> 00:23:16,906
them.


715
00:23:17,316 --> 00:23:18,446
And those are


716
00:23:18,446 --> 00:23:19,806
non-administrators.


717
00:23:21,186 --> 00:23:22,216
Now, the important take-away


718
00:23:22,216 --> 00:23:23,136
here is that if you're building


719
00:23:23,136 --> 00:23:25,236
an app, you want to make sure


720
00:23:25,236 --> 00:23:27,946
that if your HM user is not an


721
00:23:27,946 --> 00:23:29,846
administrator that you disable


722
00:23:29,846 --> 00:23:31,986
some key functionality so that


723
00:23:31,986 --> 00:23:33,216
it doesn't fail when they go try


724
00:23:33,216 --> 00:23:35,866
and use it.


725
00:23:36,636 --> 00:23:38,236
Again, all this user management


726
00:23:38,316 --> 00:23:39,586
is done through the HMHome


727
00:23:39,586 --> 00:23:42,116
object, and you'll quickly see


728
00:23:42,116 --> 00:23:43,346
that this is a common design


729
00:23:43,346 --> 00:23:45,786
pattern we use where the HMHome


730
00:23:46,146 --> 00:23:47,376
exposes a lot of the basic


731
00:23:47,376 --> 00:23:47,996
functionality.


732
00:23:48,436 --> 00:23:51,776
So let's take a look at some


733
00:23:51,776 --> 00:23:52,946
sample code and see what this


734
00:23:52,946 --> 00:23:53,316
looks like.


735
00:23:53,866 --> 00:23:58,876
So here we have a class where we


736
00:23:58,876 --> 00:24:00,116
will instantiate an


737
00:24:00,116 --> 00:24:00,766
HMHomeManager.


738
00:24:01,376 --> 00:24:04,696
Now, we want to add a home to


739
00:24:04,696 --> 00:24:06,636
that home manager, so we'll use


740
00:24:06,636 --> 00:24:08,736
the addHome APIs and specify the


741
00:24:08,736 --> 00:24:09,596
name of the home.


742
00:24:10,546 --> 00:24:12,296
Now, we want to be sure to set


743
00:24:12,296 --> 00:24:13,826
ourselves as the delegate, so


744
00:24:13,826 --> 00:24:14,616
we'll get the appropriate


745
00:24:14,616 --> 00:24:15,696
delegate callbacks.


746
00:24:16,246 --> 00:24:18,226
And finally, if we want to


747
00:24:18,226 --> 00:24:19,256
configure the users for the


748
00:24:19,256 --> 00:24:22,256
home, we'll call manageUsers on


749
00:24:22,296 --> 00:24:22,646
HMHome.


750
00:24:27,156 --> 00:24:29,166
Now, I mentioned HMZones


751
00:24:29,166 --> 00:24:30,506
earlier, so let's take a little


752
00:24:30,506 --> 00:24:31,776
peek at that.


753
00:24:31,836 --> 00:24:32,786
So this is a way of grouping


754
00:24:32,786 --> 00:24:35,206
multiple rooms together, like


755
00:24:35,996 --> 00:24:39,026
upstairs and downstairs, or you


756
00:24:39,026 --> 00:24:40,426
can group all the bedrooms


757
00:24:40,426 --> 00:24:41,736
together in a single zone.


758
00:24:42,256 --> 00:24:44,866
So it has some basic properties


759
00:24:44,866 --> 00:24:47,166
on it like name and access to


760
00:24:47,166 --> 00:24:48,936
the rooms, but it also has this


761
00:24:48,936 --> 00:24:50,316
unique identifier property.


762
00:24:50,576 --> 00:24:52,326
And this could often be


763
00:24:52,326 --> 00:24:53,686
overlooked, but this is a way


764
00:24:53,686 --> 00:24:54,776
that you keep track of which


765
00:24:54,776 --> 00:24:55,836
zone you're, you care about.


766
00:24:56,256 --> 00:24:58,026
So when the name changes or the


767
00:24:58,026 --> 00:24:59,876
rooms change, you still have an


768
00:24:59,876 --> 00:25:03,956
access to that specific zone.


769
00:25:04,156 --> 00:25:06,446
Now, on the HMRoom object, we


770
00:25:06,446 --> 00:25:08,406
also support exposing the name


771
00:25:08,406 --> 00:25:09,946
and the list of the accessories,


772
00:25:10,316 --> 00:25:12,256
and it also contains this unique


773
00:25:12,256 --> 00:25:13,756
identifier property so you can


774
00:25:13,756 --> 00:25:14,756
keep track of rooms as well.


775
00:25:17,716 --> 00:25:19,826
Again, the rooms and zones are


776
00:25:19,826 --> 00:25:21,956
managed through the HMHome APIs,


777
00:25:22,386 --> 00:25:24,186
so if you want to add or remove


778
00:25:24,186 --> 00:25:26,716
a room or if you want to add or


779
00:25:26,716 --> 00:25:28,796
remove a zone, you do through,


780
00:25:28,906 --> 00:25:30,936
do that through the HMHome APIs.


781
00:25:31,506 --> 00:25:34,606
So if we go back to some sample


782
00:25:34,606 --> 00:25:37,136
code, let's take a look at this


783
00:25:37,656 --> 00:25:40,446
[inaudible] in action.


784
00:25:40,636 --> 00:25:42,866
So here we are adding a room to


785
00:25:42,866 --> 00:25:44,356
the home with our roomName.


786
00:25:44,906 --> 00:25:47,846
And then, we're adding a zone to


787
00:25:47,846 --> 00:25:49,276
the home with a zoneName.


788
00:25:49,786 --> 00:25:52,696
And then, we associate that room


789
00:25:52,696 --> 00:25:54,000
to the zone.


790
00:25:58,226 --> 00:25:59,406
Now, the next level of object


791
00:25:59,406 --> 00:26:01,666
hierarchy that's important is


792
00:26:01,666 --> 00:26:02,536
the relationship between


793
00:26:02,536 --> 00:26:04,526
accessories, services, and


794
00:26:04,526 --> 00:26:05,336
characteristics.


795
00:26:06,106 --> 00:26:07,786
Now, this can sound confusing,


796
00:26:08,106 --> 00:26:10,236
as accessories contain services


797
00:26:10,376 --> 00:26:11,496
and services contain


798
00:26:11,496 --> 00:26:12,306
characteristics.


799
00:26:13,296 --> 00:26:14,146
So it's best to look at a


800
00:26:14,146 --> 00:26:15,976
real-world example to give you


801
00:26:15,976 --> 00:26:16,866
an idea how, really how this


802
00:26:16,866 --> 00:26:17,406
fits together.


803
00:26:17,966 --> 00:26:20,776
So let's say you have a ceiling


804
00:26:20,776 --> 00:26:21,476
fan fixture.


805
00:26:22,946 --> 00:26:26,126
Now, this is a single accessory,


806
00:26:26,436 --> 00:26:31,426
and it has a light, and it has a


807
00:26:31,426 --> 00:26:31,956
fan.


808
00:26:32,526 --> 00:26:37,156
So this maps to a light service


809
00:26:38,586 --> 00:26:40,326
and a fan service.


810
00:26:41,886 --> 00:26:43,766
Now, these services have a set


811
00:26:43,766 --> 00:26:45,456
of common characteristics that


812
00:26:45,456 --> 00:26:47,036
are shared across all services,


813
00:26:47,386 --> 00:26:48,656
but they also have


814
00:26:49,196 --> 00:26:50,396
characteristics that are unique


815
00:26:50,396 --> 00:26:51,296
to their service.


816
00:26:52,326 --> 00:26:54,196
So the light service has


817
00:26:54,196 --> 00:26:56,016
characteristics like power,


818
00:26:56,416 --> 00:26:58,016
brightness, and saturation.


819
00:26:58,526 --> 00:27:00,476
And the fan service has


820
00:27:00,476 --> 00:27:02,296
characteristics like power,


821
00:27:02,586 --> 00:27:04,176
rotation speed, and rotation


822
00:27:04,176 --> 00:27:04,676
direction.


823
00:27:05,156 --> 00:27:07,606
Now, some of these


824
00:27:07,606 --> 00:27:08,906
characteristics are optional.


825
00:27:09,736 --> 00:27:11,206
As you can imagine, not all


826
00:27:11,206 --> 00:27:12,836
lights support saturation and


827
00:27:12,836 --> 00:27:13,146
color.


828
00:27:13,726 --> 00:27:17,116
But the HomeKit APIs expose


829
00:27:17,116 --> 00:27:19,306
these as a way to elevate these


830
00:27:19,306 --> 00:27:20,446
services to your user.


831
00:27:21,756 --> 00:27:22,746
So we look back.


832
00:27:22,746 --> 00:27:25,936
We have the ceiling fan fixture,


833
00:27:25,936 --> 00:27:27,206
which is the HMAccessory.


834
00:27:27,776 --> 00:27:31,166
We have the light service and


835
00:27:31,166 --> 00:27:32,576
the fan service, which are the


836
00:27:32,576 --> 00:27:33,366
HMServices.


837
00:27:34,476 --> 00:27:35,896
And we have the corresponding


838
00:27:35,896 --> 00:27:37,316
characteristics, which are the


839
00:27:37,316 --> 00:27:38,336
HMCharacteristics.


840
00:27:38,916 --> 00:27:43,086
So we look, if you look at the


841
00:27:43,086 --> 00:27:45,866
API for some of this, you could


842
00:27:45,866 --> 00:27:48,326
see we have HMAccessory, and


843
00:27:48,326 --> 00:27:49,506
this allows you to learn about


844
00:27:49,506 --> 00:27:50,206
the accessory that you're


845
00:27:50,206 --> 00:27:50,726
controlling.


846
00:27:51,666 --> 00:27:53,966
So this exposes properties like


847
00:27:53,966 --> 00:27:57,116
the name, the list of services


848
00:27:57,116 --> 00:28:00,386
it supports, and the firmware


849
00:28:00,386 --> 00:28:01,096
version it's running.


850
00:28:01,636 --> 00:28:04,766
Now, this is just a subsample of


851
00:28:04,766 --> 00:28:05,916
all the properties on the


852
00:28:05,916 --> 00:28:06,486
accessory.


853
00:28:06,626 --> 00:28:07,586
I just wanted to give you an


854
00:28:07,586 --> 00:28:09,056
idea of the sense of what types


855
00:28:09,056 --> 00:28:10,486
of properties are on it.


856
00:28:12,376 --> 00:28:13,946
So if we take a look at


857
00:28:13,946 --> 00:28:16,526
HMService, we'll see that it


858
00:28:16,746 --> 00:28:17,786
exposes the list of


859
00:28:17,836 --> 00:28:20,966
characteristics, and there's a


860
00:28:20,966 --> 00:28:23,546
setter method for updating the


861
00:28:24,246 --> 00:28:24,330
name.


862
00:28:24,836 --> 00:28:25,856
Now, updating the name is


863
00:28:25,856 --> 00:28:27,016
actually pretty important.


864
00:28:29,116 --> 00:28:30,716
So why is it important?


865
00:28:31,196 --> 00:28:32,346
Well, it's important because


866
00:28:32,346 --> 00:28:33,996
this is how Siri and the Home


867
00:28:33,996 --> 00:28:35,116
app will interface with your


868
00:28:35,116 --> 00:28:35,556
accessory.


869
00:28:37,216 --> 00:28:38,786
So you'll want to choose a good


870
00:28:38,786 --> 00:28:39,476
default name.


871
00:28:40,066 --> 00:28:42,846
So we, you don't want to use


872
00:28:42,846 --> 00:28:44,696
serial numbers, or MAC


873
00:28:44,696 --> 00:28:47,246
addresses, or model numbers in


874
00:28:47,246 --> 00:28:48,236
your service name because


875
00:28:48,236 --> 00:28:49,696
that'll make it challenging for


876
00:28:49,696 --> 00:28:51,146
the user to talk to your


877
00:28:51,146 --> 00:28:52,076
accessory through Siri.


878
00:28:52,676 --> 00:28:56,206
You also don't-- want to avoid


879
00:28:56,206 --> 00:28:57,736
special characters and numbers,


880
00:28:58,086 --> 00:28:59,826
emojis, punctuation, things like


881
00:28:59,826 --> 00:29:02,186
that also because it gets


882
00:29:02,186 --> 00:29:03,426
confusing to the user on how


883
00:29:03,426 --> 00:29:05,176
they want, when they want to


884
00:29:09,036 --> 00:29:09,546
address their accessory.


885
00:29:09,736 --> 00:29:12,216
Now, we support over 40


886
00:29:12,216 --> 00:29:13,586
predefined service types.


887
00:29:14,386 --> 00:29:16,106
So things like light bulbs,


888
00:29:16,246 --> 00:29:17,776
thermostats, garage door


889
00:29:17,776 --> 00:29:19,816
openers, outlets, and all kinds


890
00:29:19,816 --> 00:29:20,906
of sensors, to name a few.


891
00:29:21,836 --> 00:29:23,376
We also allow the ability to


892
00:29:23,376 --> 00:29:25,126
specify custom service types as


893
00:29:25,126 --> 00:29:25,356
well.


894
00:29:25,846 --> 00:29:29,866
Now, when it comes to adding the


895
00:29:29,866 --> 00:29:31,916
accessory to the home, you'll


896
00:29:31,916 --> 00:29:33,206
want to go back to the HMHome


897
00:29:33,476 --> 00:29:34,296
helper methods.


898
00:29:35,186 --> 00:29:36,616
These APIs are pretty simple to


899
00:29:36,616 --> 00:29:38,366
use, but we'll walk through an


900
00:29:38,366 --> 00:29:39,666
example shortly here anyway.


901
00:29:40,276 --> 00:29:44,916
So the addAccessory API, this


902
00:29:44,916 --> 00:29:46,646
API is what invokes the Home UI


903
00:29:46,646 --> 00:29:48,766
view service, which is that


904
00:29:48,766 --> 00:29:50,836
familiar addAccessory flow that


905
00:29:50,836 --> 00:29:52,796
I mentioned earlier, which is


906
00:29:52,796 --> 00:29:54,816
how you can do quick QR code


907
00:29:54,816 --> 00:29:56,676
scanning or use NFC to add an


908
00:29:56,676 --> 00:29:58,156
accessory to the home.


909
00:30:00,216 --> 00:30:01,646
Now, I want to call special


910
00:30:01,646 --> 00:30:03,556
attention to the last method


911
00:30:03,556 --> 00:30:05,366
here, which is addAnd


912
00:30:05,366 --> 00:30:06,606
SetupAccessories with payload.


913
00:30:06,606 --> 00:30:10,546
Now, you can use that payload to


914
00:30:10,546 --> 00:30:12,346
pass in a HomeKit accessory code


915
00:30:13,026 --> 00:30:14,736
for in-field activation cases.


916
00:30:15,476 --> 00:30:17,656
So this API is especially


917
00:30:17,656 --> 00:30:18,656
valuable for software


918
00:30:18,656 --> 00:30:19,196
authentication.


919
00:30:19,336 --> 00:30:22,236
So this is the case where your


920
00:30:22,236 --> 00:30:24,566
accessory has left the factory


921
00:30:24,566 --> 00:30:26,526
without a HomeKit code on it.


922
00:30:27,136 --> 00:30:29,196
So you've updated the accessory


923
00:30:30,106 --> 00:30:31,906
via firmware update to provide


924
00:30:31,906 --> 00:30:33,936
HomeKit support, and you don't


925
00:30:33,936 --> 00:30:35,136
want the user to have to


926
00:30:35,136 --> 00:30:37,636
memorize the HomeKit code or to


927
00:30:37,636 --> 00:30:38,496
write it down.


928
00:30:38,856 --> 00:30:40,716
And so this API allows you to


929
00:30:40,716 --> 00:30:42,286
pass in that HomeKit code so


930
00:30:42,326 --> 00:30:44,496
that this accessory can be


931
00:30:44,496 --> 00:30:45,856
seamlessly added to the home.


932
00:30:46,436 --> 00:30:50,226
Now, this API is available to


933
00:30:50,226 --> 00:30:51,316
MFI licensees.


934
00:30:52,226 --> 00:30:53,846
For more information, contact


935
00:30:53,846 --> 00:30:54,906
your MFI representative.


936
00:30:58,756 --> 00:31:00,126
So if we look at some sample


937
00:31:00,126 --> 00:31:01,616
code on how we would add an


938
00:31:01,616 --> 00:31:03,226
accessory to the home, you just


939
00:31:03,726 --> 00:31:05,336
need to call addAnd


940
00:31:05,336 --> 00:31:07,006
SetupAccessories on the home


941
00:31:07,006 --> 00:31:08,936
object, and HomeKit takes care


942
00:31:08,936 --> 00:31:11,326
of the rest.


943
00:31:11,876 --> 00:31:13,866
Now, I mentioned scenes earlier,


944
00:31:14,416 --> 00:31:15,536
but it's a pretty powerful


945
00:31:15,536 --> 00:31:17,126
concept, so I want to go a bit


946
00:31:17,126 --> 00:31:17,466
deeper.


947
00:31:18,746 --> 00:31:19,806
Now, this is how you can


948
00:31:19,806 --> 00:31:21,136
integrate different types of


949
00:31:21,136 --> 00:31:22,886
accessories together to help


950
00:31:22,886 --> 00:31:24,336
provide a cohesive experience.


951
00:31:24,866 --> 00:31:28,746
We have some suggested scenes,


952
00:31:29,616 --> 00:31:30,906
but we also allow full


953
00:31:30,906 --> 00:31:32,656
customization by the user.


954
00:31:37,156 --> 00:31:37,886
Now, one of the great things


955
00:31:37,886 --> 00:31:39,556
about scenes is that Siri


956
00:31:39,556 --> 00:31:41,156
understands what scenes are.


957
00:31:41,296 --> 00:31:44,026
And so speaking the name to Siri


958
00:31:44,026 --> 00:31:46,076
execute, speaking the name of a


959
00:31:46,076 --> 00:31:47,646
scene to Siri will execute the


960
00:31:47,646 --> 00:31:48,356
scene directly.


961
00:31:48,616 --> 00:31:53,266
Now, we don't call them scenes


962
00:31:53,266 --> 00:31:53,776
in HomeKit.


963
00:31:54,486 --> 00:31:56,276
We call them HMActionSets.


964
00:31:57,286 --> 00:31:58,316
So if you want to create an


965
00:31:58,316 --> 00:31:59,826
HMActionSet -- for example,


966
00:31:59,956 --> 00:32:02,366
arriving home -- you'll need to


967
00:32:02,366 --> 00:32:04,906
create a list of HMActions, and


968
00:32:07,196 --> 00:32:09,216
then you'll associate those with


969
00:32:09,216 --> 00:32:09,906
the action set.


970
00:32:10,446 --> 00:32:13,926
So the action set, the


971
00:32:13,976 --> 00:32:16,206
HMActionSet contains all of the


972
00:32:16,206 --> 00:32:17,446
individual HMActions.


973
00:32:20,996 --> 00:32:23,026
Now, we support some predefined


974
00:32:23,026 --> 00:32:26,956
scenes, like wake up, go to


975
00:32:26,956 --> 00:32:33,126
sleep, leave the house, and


976
00:32:33,396 --> 00:32:34,136
return home.


977
00:32:34,736 --> 00:32:36,776
Now, this not only gives the


978
00:32:36,776 --> 00:32:38,166
user some context about what


979
00:32:38,166 --> 00:32:39,066
types of action sets are


980
00:32:39,066 --> 00:32:41,746
possible, but this is also what


981
00:32:41,746 --> 00:32:42,706
we've found to be some of the


982
00:32:42,706 --> 00:32:43,376
most useful.


983
00:32:43,906 --> 00:32:47,016
Now, of course, we also support


984
00:32:47,016 --> 00:32:49,116
user-defined action sets, and


985
00:32:49,116 --> 00:32:50,216
these are great for things like


986
00:32:50,216 --> 00:32:51,216
creating your perfect movie


987
00:32:51,216 --> 00:32:51,756
scene lighting.


988
00:32:55,956 --> 00:32:58,496
So again, to add them to the


989
00:32:58,496 --> 00:32:59,896
home, we go back to the HMHome


990
00:32:59,896 --> 00:33:01,676
APIs because this allows you to


991
00:33:01,676 --> 00:33:04,376
add these action sets, execute


992
00:33:04,376 --> 00:33:08,076
the action sets, and the HMHome


993
00:33:08,266 --> 00:33:10,136
APIs also expose the way of


994
00:33:11,576 --> 00:33:13,536
accessing the built-in action


995
00:33:18,346 --> 00:33:18,476
sets.


996
00:33:18,776 --> 00:33:19,666
So if we look at some quick


997
00:33:19,666 --> 00:33:21,506
sample code, we'll see that if


998
00:33:21,506 --> 00:33:23,816
we want to create an action set,


999
00:33:24,566 --> 00:33:26,316
we call addActionSet withName on


1000
00:33:26,316 --> 00:33:27,916
the home, we pass in the name of


1001
00:33:27,916 --> 00:33:30,306
the action set, then we'll want


1002
00:33:30,366 --> 00:33:32,106
to iterate through our list of


1003
00:33:32,106 --> 00:33:35,076
actions and add each one to the


1004
00:33:35,076 --> 00:33:35,706
action set.


1005
00:33:37,656 --> 00:33:39,626
Then, later, if we want to run


1006
00:33:39,626 --> 00:33:42,216
the scene, all you do is call


1007
00:33:42,426 --> 00:33:44,396
executeActionSet on the home.


1008
00:33:48,636 --> 00:33:50,266
Now, running scenes via the UI


1009
00:33:50,266 --> 00:33:52,786
or via Siri is great, but


1010
00:33:52,786 --> 00:33:53,626
sometimes you want things to


1011
00:33:53,626 --> 00:33:54,606
happen automatically.


1012
00:33:55,296 --> 00:33:57,326
Now, we have several options for


1013
00:33:57,326 --> 00:33:58,936
automatically triggering scenes


1014
00:33:59,116 --> 00:34:00,256
and automatically controlling


1015
00:34:00,256 --> 00:34:00,926
accessories.


1016
00:34:01,376 --> 00:34:04,496
These can be geofence based, so


1017
00:34:04,496 --> 00:34:06,266
you can turn on the lights as


1018
00:34:06,266 --> 00:34:07,306
you pull up to your house.


1019
00:34:08,176 --> 00:34:09,966
Or they can be time based, so


1020
00:34:09,966 --> 00:34:11,386
you can turn up the heat before


1021
00:34:11,386 --> 00:34:13,616
you get out of bed.


1022
00:34:13,815 --> 00:34:15,376
They can be accessory based, so


1023
00:34:15,376 --> 00:34:16,795
you can leverage a motion sensor


1024
00:34:17,036 --> 00:34:17,795
to turn on a light.


1025
00:34:18,666 --> 00:34:20,666
And they can be presence based,


1026
00:34:21,476 --> 00:34:22,226
so you could turn off your


1027
00:34:22,226 --> 00:34:24,476
lights when you leave for the


1028
00:34:24,946 --> 00:34:25,000
day.


1029
00:34:30,356 --> 00:34:31,806
Now, event triggers themselves


1030
00:34:31,806 --> 00:34:33,286
are comprised of action sets,


1031
00:34:33,795 --> 00:34:35,906
and the APIs on HMEvent or


1032
00:34:35,906 --> 00:34:37,795
HMTrigger are mostly around


1033
00:34:37,966 --> 00:34:43,016
naming, adding, and enabling.


1034
00:34:43,616 --> 00:34:48,616
Now, with automations, you can


1035
00:34:48,616 --> 00:34:51,206
set them up to run once ever, or


1036
00:34:51,206 --> 00:34:52,275
you can have them be recurring.


1037
00:34:53,716 --> 00:34:55,716
So you can them just be, happen


1038
00:34:55,716 --> 00:34:57,626
that one time, or you can have


1039
00:34:57,626 --> 00:35:00,256
them happen every day, or maybe


1040
00:35:00,256 --> 00:35:01,086
you want them just to happen


1041
00:35:01,086 --> 00:35:03,246
every weekday, or even just


1042
00:35:03,246 --> 00:35:04,036
every Friday.


1043
00:35:05,076 --> 00:35:06,416
So with automations, you have a


1044
00:35:06,416 --> 00:35:07,766
lot of control with the


1045
00:35:07,766 --> 00:35:09,146
frequency and how often you want


1046
00:35:09,146 --> 00:35:10,066
automations to run.


1047
00:35:12,636 --> 00:35:14,096
Now, let's take a look at the


1048
00:35:14,096 --> 00:35:16,096
creation of an HMTrigger and how


1049
00:35:16,096 --> 00:35:16,816
we add it to the home.


1050
00:35:18,006 --> 00:35:19,266
So let's say we want to create


1051
00:35:19,266 --> 00:35:20,316
an automation that will run


1052
00:35:20,366 --> 00:35:23,026
every night at 7 p.m.


1053
00:35:23,296 --> 00:35:25,616
So first, we create our date


1054
00:35:25,616 --> 00:35:26,956
components and we set the time


1055
00:35:26,956 --> 00:35:27,896
to be 7 p.m.


1056
00:35:29,186 --> 00:35:30,706
Then, we'll create a calendar


1057
00:35:30,706 --> 00:35:32,376
event using that component.


1058
00:35:34,556 --> 00:35:36,096
Then, we'll generate a trigger


1059
00:35:36,246 --> 00:35:37,166
using that time event.


1060
00:35:37,676 --> 00:35:40,776
Now, we need to add that trigger


1061
00:35:40,776 --> 00:35:41,286
to the home.


1062
00:35:41,856 --> 00:35:44,476
And we need to add the action


1063
00:35:44,476 --> 00:35:45,226
set to the trigger.


1064
00:35:45,796 --> 00:35:48,436
So this allows you to run an


1065
00:35:48,436 --> 00:35:50,356
automation every night at 7 p.m.


1066
00:35:50,946 --> 00:35:52,176
So let's say it's turning on a


1067
00:35:52,176 --> 00:35:55,396
light every night at 7 p.m.


1068
00:35:55,616 --> 00:35:56,856
Now, that's great, except for


1069
00:35:56,856 --> 00:35:59,576
sometimes, some parts of the


1070
00:35:59,576 --> 00:36:01,206
year, it's not dark at 7 p.m.,


1071
00:36:01,636 --> 00:36:02,786
or sometimes, parts of the year,


1072
00:36:02,786 --> 00:36:04,336
it gets dark before 7 p.m.


1073
00:36:04,586 --> 00:36:06,106
Sometimes it gets dark after 7


1074
00:36:06,106 --> 00:36:06,456
p.m.


1075
00:36:07,126 --> 00:36:08,306
So turning on the light at 7


1076
00:36:08,306 --> 00:36:09,696
p.m. every night isn't really


1077
00:36:09,696 --> 00:36:12,126
what you want.


1078
00:36:12,276 --> 00:36:14,306
So we also support what we call


1079
00:36:14,306 --> 00:36:15,636
significant time events.


1080
00:36:16,216 --> 00:36:18,546
And this is sunrise and sunset.


1081
00:36:19,076 --> 00:36:21,536
So if we look at that previous


1082
00:36:21,536 --> 00:36:23,556
example, we could change that to


1083
00:36:23,666 --> 00:36:26,076
say, turn on the light every


1084
00:36:26,076 --> 00:36:28,576
night at 7 p.m.


1085
00:36:28,736 --> 00:36:30,536
We also support relative time


1086
00:36:30,536 --> 00:36:32,386
offsets, so you can have the


1087
00:36:32,386 --> 00:36:34,386
light turn on, say, 30 minutes


1088
00:36:34,386 --> 00:36:35,206
prior to sunset.


1089
00:36:35,716 --> 00:36:38,846
So let's go back to the code we


1090
00:36:38,846 --> 00:36:41,256
had before and make some changes


1091
00:36:42,236 --> 00:36:44,676
so that we can have it run every


1092
00:36:44,676 --> 00:36:45,796
night at 30 minutes before


1093
00:36:45,796 --> 00:36:46,226
sunset.


1094
00:36:46,736 --> 00:36:48,946
So the first thing we need to do


1095
00:36:49,436 --> 00:36:51,406
is change our date components to


1096
00:36:51,406 --> 00:36:52,506
be 30 minutes.


1097
00:36:53,016 --> 00:36:54,056
Now, you'll see that it's


1098
00:36:54,056 --> 00:36:55,896
negative 30 here because we want


1099
00:36:55,896 --> 00:36:57,296
it to run 30 minutes prior to


1100
00:36:57,296 --> 00:36:57,746
sunset.


1101
00:36:59,056 --> 00:37:00,766
Then, we'll create a significant


1102
00:37:00,766 --> 00:37:03,266
time event for sunset and pass


1103
00:37:03,266 --> 00:37:03,926
in that offset.


1104
00:37:04,396 --> 00:37:06,836
Then, when we generate our


1105
00:37:06,836 --> 00:37:08,766
trigger, we pass in the sunset


1106
00:37:08,766 --> 00:37:09,036
event.


1107
00:37:11,696 --> 00:37:13,156
Then, we execute the code we had


1108
00:37:13,156 --> 00:37:14,666
before, which is adding the


1109
00:37:14,666 --> 00:37:16,796
trigger to the home and adding


1110
00:37:16,796 --> 00:37:17,966
the action set to the trigger.


1111
00:37:22,456 --> 00:37:23,906
But sometimes you don't want


1112
00:37:23,906 --> 00:37:25,016
these automations to run.


1113
00:37:26,226 --> 00:37:27,456
You probably don't want the heat


1114
00:37:27,456 --> 00:37:28,596
to turn on in the morning if no


1115
00:37:28,596 --> 00:37:29,156
one's home.


1116
00:37:29,706 --> 00:37:31,706
You probably don't want the


1117
00:37:31,706 --> 00:37:32,896
light to turn on when the door


1118
00:37:32,896 --> 00:37:37,256
opens if it's during the day.


1119
00:37:37,496 --> 00:37:39,316
So we also support what we call


1120
00:37:39,316 --> 00:37:40,056
conditions.


1121
00:37:41,346 --> 00:37:43,646
And these can be time based,


1122
00:37:44,466 --> 00:37:46,616
they can be presence based, they


1123
00:37:47,236 --> 00:37:50,546
can be accessory state based,


1124
00:37:51,116 --> 00:37:54,346
and they can be based on


1125
00:37:54,346 --> 00:37:55,366
significant events.


1126
00:37:55,736 --> 00:38:00,476
Now, I have an automation in my


1127
00:38:00,476 --> 00:38:03,506
house which turns off the lights


1128
00:38:03,676 --> 00:38:04,636
whenever someone leaves.


1129
00:38:05,296 --> 00:38:08,996
Now, that's great, except that I


1130
00:38:09,206 --> 00:38:10,656
live with my wife, and so


1131
00:38:10,656 --> 00:38:12,006
whenever she leaves the house,


1132
00:38:12,256 --> 00:38:13,956
all the lights turn off and I'm


1133
00:38:13,956 --> 00:38:16,256
left in the dark.


1134
00:38:16,256 --> 00:38:18,156
So with presence-based


1135
00:38:18,156 --> 00:38:20,136
conditions, you can update this


1136
00:38:20,306 --> 00:38:21,836
so that the lights only turn off


1137
00:38:22,336 --> 00:38:23,516
when the last person leaves.


1138
00:38:24,056 --> 00:38:27,776
Now, to set these conditions, we


1139
00:38:27,776 --> 00:38:28,506
use predicates.


1140
00:38:28,506 --> 00:38:31,556
So let's take a look at some


1141
00:38:31,556 --> 00:38:32,846
sample code.


1142
00:38:34,356 --> 00:38:37,306
So here we can see that we're


1143
00:38:37,306 --> 00:38:41,026
using our same sunset time


1144
00:38:41,026 --> 00:38:41,876
offset from before.


1145
00:38:41,876 --> 00:38:44,256
Now, we're going to create a


1146
00:38:44,256 --> 00:38:48,586
presence event that's when users


1147
00:38:48,586 --> 00:38:50,816
are at home.


1148
00:38:50,816 --> 00:38:52,336
We're going to use that presence


1149
00:38:52,336 --> 00:38:54,226
event to generate a predicate.


1150
00:38:56,116 --> 00:38:57,656
And we'll pass that predicate


1151
00:38:57,656 --> 00:38:58,796
into our trigger generation.


1152
00:38:59,296 --> 00:39:02,256
Then, we'll go back to the same


1153
00:39:02,256 --> 00:39:04,286
code we had before where we add


1154
00:39:04,286 --> 00:39:06,646
the trigger to the home and we


1155
00:39:07,226 --> 00:39:09,326
add the action set to the


1156
00:39:12,876 --> 00:39:13,046
trigger.


1157
00:39:13,206 --> 00:39:14,656
So now, we've gone from having


1158
00:39:14,656 --> 00:39:16,086
an automation that runs every


1159
00:39:16,086 --> 00:39:18,916
night at 7 p.m. to an automation


1160
00:39:18,916 --> 00:39:22,116
that runs every night 30 minutes


1161
00:39:22,116 --> 00:39:25,216
before sunset, only if someone's


1162
00:39:25,916 --> 00:39:26,000
home.


1163
00:39:31,456 --> 00:39:33,426
Now, we also have support for


1164
00:39:33,426 --> 00:39:34,406
HomeKit cameras.


1165
00:39:34,856 --> 00:39:37,416
And there are some HomeKit APIs


1166
00:39:38,796 --> 00:39:40,256
that allow you to show live


1167
00:39:40,256 --> 00:39:44,446
streams, show still images, and


1168
00:39:44,446 --> 00:39:45,866
to configure camera settings.


1169
00:39:47,156 --> 00:39:48,896
You-- this support also includes


1170
00:39:49,086 --> 00:39:51,006
the ability to control the


1171
00:39:51,006 --> 00:39:52,286
speaker volume and microphone.


1172
00:39:52,286 --> 00:39:56,066
So let's take a quick look at


1173
00:39:56,126 --> 00:39:57,516
some sample code for that as


1174
00:39:57,916 --> 00:39:58,000
well.


1175
00:40:02,646 --> 00:40:03,876
So here you could see we have a


1176
00:40:03,876 --> 00:40:05,796
function where we want to start


1177
00:40:05,996 --> 00:40:06,936
the camera stream for our


1178
00:40:06,936 --> 00:40:07,326
accessory.


1179
00:40:07,326 --> 00:40:11,256
Now, we want to be sure to set


1180
00:40:11,256 --> 00:40:13,076
ourselves as the delegate so we


1181
00:40:13,076 --> 00:40:14,106
can get the proper delegate


1182
00:40:14,106 --> 00:40:14,716
callbacks.


1183
00:40:16,896 --> 00:40:18,496
Now, we'll use this start stream


1184
00:40:18,496 --> 00:40:21,796
API to start the stream, and we


1185
00:40:21,796 --> 00:40:23,376
also want to be sure to create a


1186
00:40:23,376 --> 00:40:26,576
camera view and to add that view


1187
00:40:26,916 --> 00:40:27,826
to our view hierarchy.


1188
00:40:28,466 --> 00:40:29,866
This is so we can display that


1189
00:40:29,866 --> 00:40:31,466
camera stream in our app.


1190
00:40:33,976 --> 00:40:36,016
Then, later, we'll get the


1191
00:40:36,016 --> 00:40:36,926
delegate callback.


1192
00:40:37,276 --> 00:40:38,286
Again, this is the


1193
00:40:38,536 --> 00:40:40,036
HMCameraStream ControlDelegate.


1194
00:40:41,716 --> 00:40:42,836
And we'll receive this


1195
00:40:42,946 --> 00:40:45,046
cameraStreamControl


1196
00:40:45,046 --> 00:40:46,326
DidStartStream delegate


1197
00:40:46,326 --> 00:40:46,756
callback.


1198
00:40:48,296 --> 00:40:49,576
And all we need to do there is


1199
00:40:49,576 --> 00:40:51,496
set the camera source to be the


1200
00:40:51,496 --> 00:40:52,116
camera stream.


1201
00:40:52,626 --> 00:40:55,286
Now, this is the end of the


1202
00:40:55,286 --> 00:40:57,686
sample code for today, but


1203
00:40:57,686 --> 00:40:59,096
there's plenty of documentation


1204
00:40:59,266 --> 00:41:01,016
available for these APIs online.


1205
00:41:01,366 --> 00:41:06,236
So we hope that this gives you a


1206
00:41:06,236 --> 00:41:08,426
fresh look at learning what, how


1207
00:41:08,426 --> 00:41:09,356
HomeKit works.


1208
00:41:09,796 --> 00:41:11,486
We encourage you to join the MFI


1209
00:41:11,486 --> 00:41:13,626
program to take advantage of all


1210
00:41:13,626 --> 00:41:14,686
these great resources and


1211
00:41:14,686 --> 00:41:15,606
powerful tools.


1212
00:41:16,646 --> 00:41:18,226
It's amazingly easy to become an


1213
00:41:18,286 --> 00:41:19,276
MFI licensee.


1214
00:41:20,206 --> 00:41:21,286
Come visit us in the lab to


1215
00:41:21,286 --> 00:41:23,186
learn more about it.


1216
00:41:23,506 --> 00:41:24,636
If you're already an MFI


1217
00:41:24,686 --> 00:41:26,796
licensee, contact your MFI


1218
00:41:26,866 --> 00:41:29,176
representative to get access to


1219
00:41:29,176 --> 00:41:30,036
the latest tools.


1220
00:41:33,756 --> 00:41:35,726
With the new ADK, we've made it


1221
00:41:35,726 --> 00:41:37,486
easier than ever to bring a


1222
00:41:37,486 --> 00:41:38,746
HomeKit accessory to market.


1223
00:41:39,916 --> 00:41:41,396
Whether you're building HomeKit


1224
00:41:42,106 --> 00:41:43,416
through, [inaudible] your


1225
00:41:43,416 --> 00:41:44,386
accessory through a firmware


1226
00:41:44,386 --> 00:41:46,916
update or creating a new HomeKit


1227
00:41:46,916 --> 00:41:48,056
accessory for the first time,


1228
00:41:48,556 --> 00:41:50,576
use these tools to start


1229
00:41:50,576 --> 00:41:52,046
integrating with HomeKit so you


1230
00:41:52,046 --> 00:41:53,476
can get native series support


1231
00:41:54,306 --> 00:41:55,306
and to integrate with other


1232
00:41:55,306 --> 00:41:56,256
HomeKit accessories.


1233
00:41:56,796 --> 00:41:59,886
We can't wait to see the great


1234
00:41:59,886 --> 00:42:01,206
accessories we know that you'll


1235
00:42:01,206 --> 00:42:03,136
come up with.


1236
00:42:03,306 --> 00:42:04,706
We also encourage you to use


1237
00:42:04,706 --> 00:42:06,956
these APIs to provide a unique


1238
00:42:06,956 --> 00:42:09,216
experience for your customers


1239
00:42:09,526 --> 00:42:11,556
and to take full advantage of


1240
00:42:11,556 --> 00:42:17,366
all that HomeKit has to offer.


1241
00:42:17,366 --> 00:42:19,816
For more information or to learn


1242
00:42:19,816 --> 00:42:21,056
about anything we've discussed


1243
00:42:21,056 --> 00:42:24,336
today, check out this link or


1244
00:42:24,336 --> 00:42:25,396
come visit us in the lab.


1245
00:42:25,906 --> 00:42:27,226
We're going to be down in the


1246
00:42:27,286 --> 00:42:30,676
Technology Lab 12, which starts


1247
00:42:30,796 --> 00:42:31,206
shortly.


1248
00:42:31,936 --> 00:42:33,006
Thank you all for coming.


1249
00:42:33,316 --> 00:42:36,976
Hope you all had a great WWDC.


1250
00:42:37,508 --> 00:42:39,508
[ Applause ]

