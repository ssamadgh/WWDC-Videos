1
00:00:06,516 --> 00:00:17,500
[ Music ]


2
00:00:22,516 --> 00:00:27,716
[ Applause ]


3
00:00:28,216 --> 00:00:29,676
>> Good morning, everyone.


4
00:00:29,676 --> 00:00:31,016
Thank you for coming.


5
00:00:31,186 --> 00:00:33,096
My name is Megan Gardner.


6
00:00:33,096 --> 00:00:35,496
I am a Software Engineer
on the Game Center Team


7
00:00:35,696 --> 00:00:37,056
and today we're going
to be talking


8
00:00:37,056 --> 00:00:39,406
about what's new in Game Center.


9
00:00:40,446 --> 00:00:42,826
So if you don't know what
Game Center is already,


10
00:00:43,216 --> 00:00:45,556
Game Center is Apple's
social gaming network.


11
00:00:45,766 --> 00:00:48,466
It allows you, as developers,
to define leaderboards


12
00:00:48,466 --> 00:00:50,866
which your users can
then submit scores to,


13
00:00:51,316 --> 00:00:53,876
also define achievements
that your players can earn.


14
00:00:54,156 --> 00:00:57,636
We also have challenges which
leverage both leaderboards


15
00:00:57,636 --> 00:00:59,966
and achievements to add
a multiplayer element


16
00:00:59,966 --> 00:01:01,046
to your single player games.


17
00:01:01,586 --> 00:01:04,086
We also have two
multiplayer API's,


18
00:01:04,086 --> 00:01:05,726
both real-time and turn-based.


19
00:01:06,306 --> 00:01:10,196
And we ship all of these
things on iOS, macOS, tvOS,


20
00:01:10,196 --> 00:01:12,296
and this year we are
announcing watchOS.


21
00:01:12,826 --> 00:01:13,756
So what's new?


22
00:01:14,506 --> 00:01:15,916
We've got a few new
things this year.


23
00:01:16,406 --> 00:01:20,956
First is we have a great new way
of sending multiplayer invites.


24
00:01:20,956 --> 00:01:23,206
Next we have big news
for the Game Center app


25
00:01:23,206 --> 00:01:24,496
if you haven't figured
it out already.


26
00:01:25,206 --> 00:01:29,566
We have a brand new API for
persistent game sessions


27
00:01:29,566 --> 00:01:31,026
that we're really excited about.


28
00:01:31,406 --> 00:01:33,596
And we're also announcing
Apple Watch support.


29
00:01:34,066 --> 00:01:35,906
Now we don't have time
to talk about Apple Watch


30
00:01:35,906 --> 00:01:38,036
in this session, but if that's
what you're interested in,


31
00:01:38,266 --> 00:01:41,306
I really suggest that you
go to the "Game Technologies


32
00:01:41,306 --> 00:01:44,306
for Apple Watch" later this
afternoon in this room.


33
00:01:45,266 --> 00:01:46,496
So let's talk


34
00:01:46,496 --> 00:01:49,456
about message-based
multiplayer invites.


35
00:01:50,016 --> 00:01:52,986
Now you can play with
anyone that you can message.


36
00:01:53,926 --> 00:01:55,576
Currently our multiplayer


37
00:01:55,576 --> 00:01:58,716
for Game Center pretty
much looks like this.


38
00:01:58,716 --> 00:02:00,546
This is our
GKMatchmakerViewController


39
00:02:00,546 --> 00:02:03,056
and this is what most of you are
using to set up your matches.


40
00:02:03,616 --> 00:02:05,406
This is a built-in
UI that we have done.


41
00:02:05,716 --> 00:02:07,176
It allows your users to be able


42
00:02:07,176 --> 00:02:09,006
to invite their Game
Center friends as well


43
00:02:09,006 --> 00:02:10,976
as do play now which
is automatch.


44
00:02:11,246 --> 00:02:14,366
Some of you have
implemented GKMatchmaker


45
00:02:14,366 --> 00:02:16,666
which is our programmatic
API which allows you


46
00:02:16,666 --> 00:02:19,276
to do your own UI and
set up your own invites.


47
00:02:19,666 --> 00:02:22,056
But if you've been using
GKMatchmakerViewController,


48
00:02:22,846 --> 00:02:25,116
it now looks like this.


49
00:02:25,186 --> 00:02:28,006
This is our new integrated
Messages View Controller.


50
00:02:28,446 --> 00:02:30,296
You'll notice some differences.


51
00:02:30,296 --> 00:02:33,416
There's no bubbles but that's
not the most important part.


52
00:02:34,436 --> 00:02:37,496
It now integrates
directly in with Messages


53
00:02:37,776 --> 00:02:40,866
which will allow your users
to be able to send a message


54
00:02:40,866 --> 00:02:43,346
to anyone in their
Contacts and then be able


55
00:02:43,346 --> 00:02:44,146
to play a game with them.


56
00:02:44,706 --> 00:02:47,146
So let's see what
this looks like.


57
00:02:47,146 --> 00:02:49,736
This is the Multiplayer View
Controller in Doodle Jump.


58
00:02:49,736 --> 00:02:50,636
You can click Play Now


59
00:02:50,636 --> 00:02:53,506
and automatch will work
just as it has before.


60
00:02:53,506 --> 00:02:56,226
However, we're more interested
in seeing what happens


61
00:02:56,226 --> 00:02:57,356
when we click Invite Friends.


62
00:02:57,356 --> 00:03:01,596
So that will bring in this
new Messages View Controller.


63
00:03:01,596 --> 00:03:03,936
You can see we have this
beautiful rich link here


64
00:03:03,936 --> 00:03:04,426
that we've got.


65
00:03:04,426 --> 00:03:06,646
We've got the little Doodle
Jump icon in the corner.


66
00:03:06,986 --> 00:03:09,846
I added a little bit of text
that can tell your users


67
00:03:10,136 --> 00:03:13,956
about what this link is
going to let them do.


68
00:03:14,146 --> 00:03:16,636
And this is all based on
iCloud technology so all


69
00:03:16,636 --> 00:03:18,256
of your users will
need to be signed


70
00:03:18,256 --> 00:03:21,016
into iCloud for this to work.


71
00:03:21,316 --> 00:03:23,536
You can then start
typing in the To field.


72
00:03:24,116 --> 00:03:27,326
This will autocomplete to
Contacts or you can just type


73
00:03:27,326 --> 00:03:31,366
in a email address or phone
number of anyone that you know


74
00:03:31,366 --> 00:03:33,916
or anyone that you just met.


75
00:03:34,246 --> 00:03:36,416
Or you can click on that
Plus button which is going


76
00:03:36,516 --> 00:03:37,896
to bring in the Contacts.


77
00:03:38,056 --> 00:03:39,436
So these are all my Contacts


78
00:03:39,676 --> 00:03:42,756
that I have Messages
information for.


79
00:03:43,346 --> 00:03:45,506
You'll also see that there's
a Recents tab in the middle.


80
00:03:45,506 --> 00:03:48,476
That is where your Game Center
friends are going to be located


81
00:03:48,476 --> 00:03:51,946
as well as anyone that your
users have recently played


82
00:03:52,166 --> 00:03:53,466
on Game Center.


83
00:03:53,686 --> 00:03:56,496
And Nearby also functions the
same way that Nearby has worked


84
00:03:56,496 --> 00:04:00,056
in that it will be looking
for players on local network


85
00:04:00,256 --> 00:04:02,166
that are also playing this game.


86
00:04:02,446 --> 00:04:04,326
So I'm going to click on Alisha,


87
00:04:04,326 --> 00:04:05,826
invite my friend,
Alisha, to play.


88
00:04:06,346 --> 00:04:08,976
And then we'll click Add
and it's going to fill her


89
00:04:08,976 --> 00:04:10,446
in into that To field.


90
00:04:12,116 --> 00:04:14,926
You can then, this functions
just exactly as Messages.


91
00:04:14,926 --> 00:04:16,156
This is basically Messages UI


92
00:04:16,156 --> 00:04:18,546
so you're users can
add additional text


93
00:04:18,546 --> 00:04:20,435
and then it's going to
send to all the players.


94
00:04:20,435 --> 00:04:23,136
If I clicked on a Game Center
player, their name is going


95
00:04:23,136 --> 00:04:25,866
to show up in gray and
they will getting a Game


96
00:04:25,866 --> 00:04:26,756
Center notification.


97
00:04:26,756 --> 00:04:27,636
They're not going
to get some sort


98
00:04:27,636 --> 00:04:30,126
of weird Game Center iMessage.


99
00:04:30,536 --> 00:04:33,046
It will come in as
a notification.


100
00:04:33,256 --> 00:04:37,966
So if we click on that Send
button, then that will send it


101
00:04:38,026 --> 00:04:39,596
to Alisha and this is
what it's going to look


102
00:04:39,596 --> 00:04:40,716
like on Alisha's screen.


103
00:04:41,066 --> 00:04:44,196
She can then tap the link
to accept the invite,


104
00:04:44,196 --> 00:04:46,826
and that will take her
directly into the game,


105
00:04:46,886 --> 00:04:50,036
and start connecting
just like it would have


106
00:04:50,036 --> 00:04:51,546
if she had tapped
on the notification.


107
00:04:52,076 --> 00:04:53,906
And the same functionality
we'll have


108
00:04:53,906 --> 00:04:56,766
if she did not have Doodle
Jump, then it will take her


109
00:04:56,766 --> 00:05:00,016
to the store where she can
then download and play just


110
00:05:00,016 --> 00:05:01,966
like she would be able
to from a notification.


111
00:05:02,286 --> 00:05:05,466
Now I said that there's
nothing that you need to do


112
00:05:05,706 --> 00:05:07,096
in order to implement this.


113
00:05:07,096 --> 00:05:09,666
We have just replaced
the View Controller


114
00:05:09,666 --> 00:05:11,696
so if you have been using
this View Controller,


115
00:05:12,026 --> 00:05:14,616
then you've got this just
straight out of the box.


116
00:05:14,616 --> 00:05:17,896
As soon as iOS 10 is shipped
all of your users will be able


117
00:05:17,896 --> 00:05:20,636
to do this and invite
anyone that they know.


118
00:05:20,636 --> 00:05:23,176
They will no longer be limited
to their Game Center friends.


119
00:05:23,456 --> 00:05:25,926
However, we have one thing
that you can customize


120
00:05:25,926 --> 00:05:28,236
if you would like, which
is this rich link image.


121
00:05:28,236 --> 00:05:30,516
So you'll notice right here it's
the Game Center icon currently.


122
00:05:30,836 --> 00:05:33,256
If you would like to change
that to be something else


123
00:05:33,386 --> 00:05:36,396
that you feel more appropriately
represents your game,


124
00:05:36,756 --> 00:05:41,196
or more appropriately indicates
that this is a gaming invite,


125
00:05:41,196 --> 00:05:44,896
or a fun thing that people will
want to click on, then you can,


126
00:05:45,036 --> 00:05:47,836
all you need to do
is add this file:


127
00:05:48,006 --> 00:05:49,746
GKMessageInvite to your bundle.


128
00:05:49,746 --> 00:05:52,646
And the same way that we will
just pull that out if you wanted


129
00:05:52,646 --> 00:05:55,776
to customize your notification
sound, we'll just pull that out


130
00:05:55,776 --> 00:05:58,226
and customize your rich link.


131
00:05:58,596 --> 00:06:00,616
Notice this is the same
rich link technology


132
00:06:00,616 --> 00:06:02,836
that is being used for
Safari and so it's used


133
00:06:02,836 --> 00:06:05,556
to taking a wide
variety of images.


134
00:06:05,686 --> 00:06:08,036
So what does this mean
for Game Center Friends?


135
00:06:08,606 --> 00:06:10,396
Well, we don't need
friends anymore


136
00:06:10,396 --> 00:06:11,636
because we can play with anyone.


137
00:06:11,996 --> 00:06:14,256
So we're freezing
the friends list.


138
00:06:15,646 --> 00:06:17,606
But you will still
be able to see any


139
00:06:17,606 --> 00:06:19,366
of the Game Center
friends that you have


140
00:06:19,366 --> 00:06:21,176
in that Recents Player tab.


141
00:06:21,176 --> 00:06:23,356
And you can still
pull the friends.


142
00:06:23,356 --> 00:06:24,266
Friends still exists.


143
00:06:24,266 --> 00:06:25,186
We're not deleting them.


144
00:06:25,186 --> 00:06:25,826
They're still there.


145
00:06:26,206 --> 00:06:29,336
But you won't be able
to send, receive,


146
00:06:29,336 --> 00:06:31,536
or respond to any
more friend Requests.


147
00:06:31,536 --> 00:06:32,416
And because of that,


148
00:06:32,416 --> 00:06:35,376
GKFriendRequestCompose
ViewController is


149
00:06:35,376 --> 00:06:36,706
now deprecated.


150
00:06:37,676 --> 00:06:40,686
It wasn't really used
that much anyway.


151
00:06:40,686 --> 00:06:44,516
So what does that mean
for the Game Center app?


152
00:06:44,836 --> 00:06:47,046
Well, if you've downloaded
The Siege,


153
00:06:47,046 --> 00:06:49,406
you might notice some changes.


154
00:06:49,406 --> 00:06:52,416
Well, what is the Game
Center app used for?


155
00:06:52,416 --> 00:06:54,596
In iOS 9 it was basically used


156
00:06:54,596 --> 00:06:56,536
to manage your account,
manage your friends.


157
00:06:57,216 --> 00:06:58,596
You could browse
your games list.


158
00:06:58,736 --> 00:07:00,156
You could look at
your leaderboards,


159
00:07:00,376 --> 00:07:04,056
check out your achievements,
view your challenges,


160
00:07:04,056 --> 00:07:06,436
send challenges, and
also view your turns.


161
00:07:07,316 --> 00:07:10,036
Well, it turns out all of these
things you can basically do


162
00:07:10,036 --> 00:07:11,266
in other places in the system


163
00:07:11,266 --> 00:07:13,136
and more importantly,
in your app.


164
00:07:13,686 --> 00:07:19,216
And so we have removed
the Game Center app.


165
00:07:19,956 --> 00:07:22,926
So where did we do
all these things?


166
00:07:23,016 --> 00:07:25,016
[ Laughter ]


167
00:07:25,246 --> 00:07:27,246
[ Applause ]


168
00:07:27,476 --> 00:07:29,776
If you want to manage
your account,


169
00:07:29,776 --> 00:07:31,296
you can do that in settings.


170
00:07:31,416 --> 00:07:32,836
If you want to manage
your friends,


171
00:07:33,256 --> 00:07:34,656
you can still do
that in settings.


172
00:07:34,786 --> 00:07:37,476
If you want to browse your
games, we've got the App Store,


173
00:07:37,476 --> 00:07:39,136
you can look at your
Home screen.


174
00:07:39,906 --> 00:07:42,606
You view your leaderboards,
achievements, and challenges


175
00:07:42,606 --> 00:07:44,346
from GKGameCenterViewController.


176
00:07:44,346 --> 00:07:46,536
If you're not using
the View Controller,


177
00:07:46,536 --> 00:07:47,656
you can also do your own UI.


178
00:07:48,196 --> 00:07:51,746
If you're not presenting
challenges or leaderboards


179
00:07:51,746 --> 00:07:53,846
and achievements in your
game, we strongly suggest


180
00:07:53,846 --> 00:07:54,986
that you start doing that now.


181
00:07:55,426 --> 00:07:59,916
And you can also view and take
your turns from GKMatchmaker,


182
00:08:00,446 --> 00:08:02,426
GKTurnBasedMatchmaker
ViewController.


183
00:08:03,206 --> 00:08:07,186
So we've removed the app.


184
00:08:07,186 --> 00:08:09,166
Everything is really
available in other places and,


185
00:08:09,166 --> 00:08:11,176
more importantly, in your app.


186
00:08:11,176 --> 00:08:13,766
We would love our users to
spend, your users to spend,


187
00:08:13,766 --> 00:08:14,676
more time in your app.


188
00:08:14,676 --> 00:08:16,336
We've got the rest of the phone.


189
00:08:16,336 --> 00:08:17,646
We don't need any
more of their time.


190
00:08:18,106 --> 00:08:21,956
And so we've removed the app.


191
00:08:22,226 --> 00:08:24,436
Now let's talk about Sessions.


192
00:08:24,436 --> 00:08:27,586
This is our brand new
API and we're really,


193
00:08:27,586 --> 00:08:29,276
really excited about this.


194
00:08:29,476 --> 00:08:32,106
This is a brand new
way to multiplay.


195
00:08:33,556 --> 00:08:36,466
So Game Center Multiplayer,
what does it look right now?


196
00:08:36,785 --> 00:08:39,166
We basically have
our two main API's


197
00:08:39,166 --> 00:08:40,876
with real-time and turn-based.


198
00:08:40,876 --> 00:08:45,576
Real-time will connect
just two to four players.


199
00:08:45,576 --> 00:08:49,346
Those connections will require
like an immediate handshake.


200
00:08:49,346 --> 00:08:51,156
If anyone drops from
that connection,


201
00:08:51,156 --> 00:08:53,506
then that whole connection
will be lost.


202
00:08:53,876 --> 00:08:55,606
You're just passing
data back and forth.


203
00:08:55,916 --> 00:08:58,566
And as soon as that match is
over all of that data is gone.


204
00:08:59,256 --> 00:09:02,506
Turn-based can connect
to 16 players.


205
00:09:02,916 --> 00:09:07,206
We have a very formal
API for passing of turns


206
00:09:07,206 --> 00:09:10,816
and also exchanges but
you kind of really have


207
00:09:10,816 --> 00:09:13,736
to follow those rules and you
have to make sure your game


208
00:09:13,736 --> 00:09:14,996
like fits within that structure.


209
00:09:15,276 --> 00:09:17,356
And all games are stored
on the Game Center server


210
00:09:17,766 --> 00:09:19,386
until they are aged out.


211
00:09:19,866 --> 00:09:21,476
So what is Sessions?


212
00:09:22,156 --> 00:09:24,876
Sessions is our new
iCloud-based multiplayer.


213
00:09:25,176 --> 00:09:28,426
So we have this great
generalized interface for saving


214
00:09:28,426 --> 00:09:29,416
and sharing game data.


215
00:09:29,786 --> 00:09:32,796
These are easily shareable
little instances of data


216
00:09:32,796 --> 00:09:34,636
that people can share
with people


217
00:09:34,636 --> 00:09:36,376
that they would like
to play with.


218
00:09:36,376 --> 00:09:38,186
It's a completely
flexible game structure.


219
00:09:38,186 --> 00:09:39,666
We don't impose anything on you.


220
00:09:39,666 --> 00:09:42,116
You can do whatever you want.


221
00:09:42,116 --> 00:09:45,336
And we have really stable,
solid real-time streams


222
00:09:45,336 --> 00:09:46,796
that you can set up
within these sessions.


223
00:09:47,256 --> 00:09:50,416
And this is going to allow
you to play with anyone.


224
00:09:50,416 --> 00:09:52,716
So what does a Session
look like?


225
00:09:53,376 --> 00:09:56,046
So we have two main
items that we have.


226
00:09:56,286 --> 00:09:57,266
We've got our game data.


227
00:09:57,266 --> 00:09:58,836
It's probably one of the
more important parts.


228
00:09:59,386 --> 00:10:00,966
But also equally
important is their players.


229
00:10:01,046 --> 00:10:05,106
And really this is all that
you need and all the basics


230
00:10:05,106 --> 00:10:07,286
that you have to have
to have a session,


231
00:10:07,486 --> 00:10:08,746
is a player and some game data.


232
00:10:08,886 --> 00:10:13,136
You can have multiple players
which is useful if you would


233
00:10:13,246 --> 00:10:14,856
like to play with other people.


234
00:10:14,856 --> 00:10:17,866
We also have the ability to send
messages between those players.


235
00:10:17,866 --> 00:10:20,286
These messages will come in
as Game Center notifications.


236
00:10:20,636 --> 00:10:23,236
So you can have those messages
being passed back and forth


237
00:10:23,236 --> 00:10:25,786
between players or multiple
players can send multiple


238
00:10:25,786 --> 00:10:28,046
messages all at the same time.


239
00:10:28,746 --> 00:10:31,916
Along with these messages we
have the ability to badge.


240
00:10:32,426 --> 00:10:34,956
So you can send those messages
and also badge those players


241
00:10:35,046 --> 00:10:37,066
to let them know that there's
something within your game,


242
00:10:37,066 --> 00:10:38,186
something within that session,


243
00:10:38,186 --> 00:10:39,516
that they might want
to take care of.


244
00:10:40,286 --> 00:10:44,196
Now I only show four players
here but we can actually have


245
00:10:44,256 --> 00:10:48,516
up to 100 players in a single
session which is a lot more


246
00:10:48,516 --> 00:10:49,876
than we've been able
to have before.


247
00:10:50,466 --> 00:10:54,226
And we can have multiple
different kinds of sessions.


248
00:10:54,226 --> 00:10:56,596
So you can have small sessions
that have one or two players.


249
00:10:56,596 --> 00:10:59,556
You can have four players,
100 players, seven players.


250
00:10:59,716 --> 00:11:02,426
Those players can be
functionally grouped


251
00:11:02,426 --> 00:11:03,446
onto different teams.


252
00:11:03,496 --> 00:11:05,996
And you can have all
of these sessions up


253
00:11:06,166 --> 00:11:08,576
and your player can be in
all of these different kinds


254
00:11:08,576 --> 00:11:11,286
of sessions all at
the same time.


255
00:11:11,616 --> 00:11:14,456
We also have real-time streams
so if you're in this session


256
00:11:14,456 --> 00:11:17,166
and you would like to be able to
pass data quickly back and forth


257
00:11:17,166 --> 00:11:20,346
between your different players,
then your players merely need


258
00:11:20,346 --> 00:11:21,616
to set their connection states


259
00:11:21,976 --> 00:11:24,656
and we will be setting these
pipes up in the background


260
00:11:25,026 --> 00:11:26,856
that will allow the
players to be able


261
00:11:26,946 --> 00:11:30,636
to start communicating
with each other.


262
00:11:30,636 --> 00:11:34,906
So, let's get into the
actual code, the actual API


263
00:11:35,316 --> 00:11:36,576
of what makes up a session.


264
00:11:37,066 --> 00:11:38,216
So we've got a couple
of classes.


265
00:11:38,316 --> 00:11:41,696
We've got GKGameSession which
is going to allow your players


266
00:11:41,806 --> 00:11:43,676
to basically interact
with that session data


267
00:11:43,676 --> 00:11:45,336
as well as the other players.


268
00:11:45,646 --> 00:11:48,356
We have GKCloudPlayer which
is a player in a session.


269
00:11:48,646 --> 00:11:50,966
We have GKEventListener
which will help you know


270
00:11:50,966 --> 00:11:53,826
when important things happen
on any of your sessions


271
00:11:53,826 --> 00:11:54,646
that your players are in.


272
00:11:55,016 --> 00:11:57,386
And we also have
GKGameSessionError


273
00:11:57,386 --> 00:12:00,056
which will give you a little
bit more specific errors


274
00:12:00,456 --> 00:12:04,556
that you might encounter
when working with Sessions.


275
00:12:05,106 --> 00:12:07,666
So let's talk about
GKGameSession.


276
00:12:08,546 --> 00:12:10,476
So this is your main workhorse.


277
00:12:10,476 --> 00:12:12,056
This is where almost
all of the work is going


278
00:12:12,056 --> 00:12:13,036
to be done per session.


279
00:12:13,036 --> 00:12:15,106
It allows you to do
basically everything.


280
00:12:15,106 --> 00:12:17,446
You can create a
session, leave sessions,


281
00:12:17,446 --> 00:12:20,886
load and store your game
data, share your sessions,


282
00:12:20,886 --> 00:12:23,666
add your players, remove your
players, see who's playing,


283
00:12:23,696 --> 00:12:26,566
send your notifications,
set and clear your badges,


284
00:12:26,876 --> 00:12:29,286
join your streams, send
data on those streams.


285
00:12:29,286 --> 00:12:31,176
Basically everything you're
going to be doing is going


286
00:12:31,176 --> 00:12:33,046
to be interacting
with GKGameSession.


287
00:12:33,486 --> 00:12:37,006
Some more details about that.


288
00:12:37,006 --> 00:12:39,506
With your game data
you can store


289
00:12:39,506 --> 00:12:41,666
up to 512 kilobytes of data.


290
00:12:42,176 --> 00:12:44,946
This data is going to be
stored in the user's iCloud


291
00:12:44,946 --> 00:12:47,166
so it's not something
associated with your game.


292
00:12:47,166 --> 00:12:49,276
And the user is going to
have it in their iCloud.


293
00:12:49,276 --> 00:12:51,936
It will count against
their iCloud limits.


294
00:12:52,336 --> 00:12:54,546
And it's going to follow
CloudKit conventions in terms


295
00:12:54,546 --> 00:12:57,506
of who owns that data, how
the data is shared, privacy,


296
00:12:57,676 --> 00:13:00,506
and what happens when
that data is deleted.


297
00:13:00,506 --> 00:13:02,046
Messages and Badges,
as I've said,


298
00:13:02,046 --> 00:13:03,646
come in as Game Center
notifications


299
00:13:03,646 --> 00:13:04,806
and they're badged as such.


300
00:13:05,186 --> 00:13:08,116
And badging is now going to
be more directly controlled


301
00:13:08,116 --> 00:13:09,296
by you, as the developer.


302
00:13:10,336 --> 00:13:12,026
We'll get into that a little
bit more but it's going


303
00:13:12,026 --> 00:13:13,866
to be very clear where that
badge number is coming from


304
00:13:13,866 --> 00:13:17,036
and you should be able to
understand why it is what it is


305
00:13:17,036 --> 00:13:21,776
and change it to pretty
much whatever you want.


306
00:13:21,776 --> 00:13:24,456
And we also have these
real-time streams


307
00:13:24,456 --> 00:13:26,906
which basically leverage
existing Apple infrastructure.


308
00:13:26,906 --> 00:13:29,566
This is running on the same
technology that runs FaceTime


309
00:13:29,566 --> 00:13:31,596
as well as iMessage
so it's really strong,


310
00:13:31,596 --> 00:13:34,396
it's really stable, and it's
built to carry a lot of data.


311
00:13:34,866 --> 00:13:37,886
So if we want to make a
session, what do we need to do?


312
00:13:38,326 --> 00:13:40,826
Well, first we need a title,


313
00:13:40,996 --> 00:13:43,046
something to describe
the session.


314
00:13:43,046 --> 00:13:45,416
Either you can define that or
you can get that from your user.


315
00:13:45,856 --> 00:13:49,476
You need your container ID
which your iCloud container


316
00:13:49,476 --> 00:13:50,876
that you set up with your app.


317
00:13:51,026 --> 00:13:54,916
And also set up a container that
can be used across multiple apps


318
00:13:55,136 --> 00:13:57,446
so if you want multiple
games to be able to access


319
00:13:57,446 --> 00:13:59,926
that same data, say if
you had your free version,


320
00:13:59,926 --> 00:14:02,496
your pay version, or, you
know, other different kinds


321
00:14:02,496 --> 00:14:04,706
of versions of your
game, they will still,


322
00:14:04,706 --> 00:14:06,816
if you set that up correctly,
they will still all be able


323
00:14:06,916 --> 00:14:09,456
to access that same data.


324
00:14:09,996 --> 00:14:13,206
And you can also set the max
number of streaming players.


325
00:14:13,376 --> 00:14:16,396
There's a hard limit of
16 players that can be


326
00:14:16,396 --> 00:14:19,116
in that real-time stream but
if you would like to make


327
00:14:19,116 --> 00:14:21,906
that lower, or something
different, then you can lower


328
00:14:21,906 --> 00:14:24,426
that when you create
the session but you need


329
00:14:24,426 --> 00:14:25,646
to decide that when you create.


330
00:14:26,696 --> 00:14:31,126
So once you've, so you just will
call createSessionInContainer


331
00:14:31,126 --> 00:14:32,536
with all of that
relevant information


332
00:14:32,536 --> 00:14:34,606
and that will give you a session


333
00:14:34,606 --> 00:14:37,386
that you can start
manipulating and using.


334
00:14:38,376 --> 00:14:40,996
One of the first things you're
probably going to want to do


335
00:14:40,996 --> 00:14:42,496
with the session is
be able to figure how


336
00:14:42,496 --> 00:14:44,496
to load and save your data.


337
00:14:44,496 --> 00:14:46,886
Any player that's in a
session can access that data.


338
00:14:46,986 --> 00:14:49,086
It's just one big blob
that everybody plays with.


339
00:14:49,526 --> 00:14:51,906
And there's a little
bit of metadata provided


340
00:14:51,906 --> 00:14:55,416
with that session that will help
you avoid and resolve conflicts


341
00:14:55,666 --> 00:14:58,096
which is last modified date
and last modified player.


342
00:14:58,096 --> 00:15:01,326
So you'll know who was
touching it last and whether


343
00:15:01,326 --> 00:15:05,086
or not it's important for you
to save or if your data is more


344
00:15:05,086 --> 00:15:05,856
than likely up to date.


345
00:15:06,266 --> 00:15:08,416
So you can just call
loadDataWithCompletionHandler,


346
00:15:08,416 --> 00:15:09,606
that will pass you your data.


347
00:15:10,426 --> 00:15:13,506
You'd also probably
like to save your data.


348
00:15:13,586 --> 00:15:15,526
As I said before, 512 kilobytes


349
00:15:15,746 --> 00:15:18,936
but you can do whatever
you want with that data.


350
00:15:18,936 --> 00:15:23,396
It can be whatever
will fit in that size.


351
00:15:23,716 --> 00:15:26,786
So you'll call saveData
with completionHandler.


352
00:15:26,816 --> 00:15:30,246
If there is a conflict, if
someone else has tried to save


353
00:15:30,246 --> 00:15:33,846
in the interim, you will get
an error and you will get


354
00:15:33,846 --> 00:15:34,896
that conflicting data back.


355
00:15:34,896 --> 00:15:38,686
And we'll talk a little bit
more about that in a second.


356
00:15:38,686 --> 00:15:41,606
Anytime someone does save
data there's an Event Listener


357
00:15:41,606 --> 00:15:43,186
that goes along with that.


358
00:15:43,186 --> 00:15:45,516
So if you set up your
Event Listener to listen


359
00:15:45,516 --> 00:15:47,666
for a session player to save
data, then you will know


360
00:15:47,666 --> 00:15:50,276
when someone else has saved
data and you will know


361
00:15:50,276 --> 00:15:52,926
that you will more than
likely will need to update


362
00:15:52,926 --> 00:15:55,746
and resolve any conflicts
local you have with that data.


363
00:15:56,286 --> 00:16:00,316
So as I said, Save
conflicts can occur.


364
00:16:00,726 --> 00:16:03,276
And this will happen where two
players who were basically going


365
00:16:03,276 --> 00:16:06,046
to try to save data in
about the same time.


366
00:16:06,046 --> 00:16:09,916
Since there's no real formal
turn passing it's very possible


367
00:16:09,916 --> 00:16:12,486
that two players can be
taking a turn at the same time


368
00:16:12,486 --> 00:16:16,776
if that's how you design
and implement your game.


369
00:16:16,776 --> 00:16:19,136
So say we've got Players Two
and Three and they both try


370
00:16:19,136 --> 00:16:20,016
to save at the same time.


371
00:16:20,016 --> 00:16:22,136
Well, one of them is
going to win so I'm going


372
00:16:22,136 --> 00:16:22,956
to say it's Player Two.


373
00:16:23,316 --> 00:16:27,106
That means when Player Three
tries to save they're going


374
00:16:27,106 --> 00:16:29,576
to get an error and that
conflicted data will


375
00:16:29,576 --> 00:16:30,236
be returned.


376
00:16:30,606 --> 00:16:33,746
Now you are going to
need to figure out how


377
00:16:33,746 --> 00:16:35,106
to resolve this conflict.


378
00:16:35,256 --> 00:16:38,106
Since we have no
specific formalities


379
00:16:38,106 --> 00:16:41,416
for what this data is we also
don't know what the data means.


380
00:16:41,536 --> 00:16:43,856
And so it's going to be up
to you to architect your data


381
00:16:43,856 --> 00:16:46,646
in such a way that it's going
to be easy for you to figure


382
00:16:46,646 --> 00:16:49,206
out what those conflicts
are, resolve those conflicts,


383
00:16:49,206 --> 00:16:52,706
and recall saved data in order


384
00:16:52,706 --> 00:16:54,356
for that data to
actually be saved.


385
00:16:54,666 --> 00:16:58,336
If you do not recall saved data,
your data will not be saved


386
00:16:58,336 --> 00:17:00,396
and you need to continue
to call saved data


387
00:17:00,666 --> 00:17:02,796
until you return
without a conflict.


388
00:17:03,156 --> 00:17:06,906
And then everything
will be up to date.


389
00:17:06,906 --> 00:17:10,146
Everything will be the
same for all your users


390
00:17:10,146 --> 00:17:11,856
and you can continue forward.


391
00:17:12,705 --> 00:17:18,356
And then everything
will be grand.


392
00:17:18,836 --> 00:17:21,945
We've talked about
having multiplayers, well,


393
00:17:21,945 --> 00:17:25,326
how do you get additional
players into your session?


394
00:17:25,786 --> 00:17:28,936
Any player that's in a session
can invite other players


395
00:17:28,936 --> 00:17:29,336
to join.


396
00:17:29,796 --> 00:17:32,616
Basically you're going
to be provided with a URL


397
00:17:32,616 --> 00:17:34,646
that you need to
get to someone else.


398
00:17:34,646 --> 00:17:38,686
You can send this via iMessage,
email, Twitter, Facebook,


399
00:17:38,756 --> 00:17:39,946
print it out, paste
it on a tree --


400
00:17:39,946 --> 00:17:42,786
that's probably not
the best way.


401
00:17:42,836 --> 00:17:45,226
But as long as you can get
this URL to other people


402
00:17:45,546 --> 00:17:47,666
and they can click on
it, then it will be able


403
00:17:47,666 --> 00:17:49,336
to be added to that session.


404
00:17:49,686 --> 00:17:53,486
The easiest way to do this
is through the share sheet


405
00:17:53,706 --> 00:17:55,596
because it just pops
up right there


406
00:17:55,596 --> 00:17:57,216
and you can send off a message.


407
00:17:57,456 --> 00:18:00,066
And that's probably the
easiest way to do that.


408
00:18:00,066 --> 00:18:06,166
So if like the Player One, if
they pull the URL from their,


409
00:18:06,166 --> 00:18:11,086
from the session, they set up an
iMessage with that share sheet


410
00:18:11,456 --> 00:18:13,066
to send to Player Two.


411
00:18:13,066 --> 00:18:14,736
They've added a little
bit of text, "Hey,


412
00:18:14,736 --> 00:18:16,196
want you want to play with me?"


413
00:18:16,196 --> 00:18:18,636
It'll come out as
this iCloud URL.


414
00:18:18,996 --> 00:18:22,216
It will be sent to Player
Two, they will click on it,


415
00:18:22,216 --> 00:18:25,456
and as soon as they click
on it Player Two is added.


416
00:18:25,456 --> 00:18:28,896
So in order to get the URL
you just call getShareURLWith


417
00:18:28,896 --> 00:18:29,546
CompletionHandler.


418
00:18:29,546 --> 00:18:30,736
It will give you the URL


419
00:18:30,736 --> 00:18:32,246
that you can then do
whatever you want with.


420
00:18:32,726 --> 00:18:36,476
And then anytime
a player is added


421
00:18:36,556 --> 00:18:40,946
to a session the Event Listener
didAddPlayer will be called.


422
00:18:41,276 --> 00:18:42,696
And that will let you know


423
00:18:42,696 --> 00:18:45,466
that someone else has joined
your session and be able


424
00:18:45,546 --> 00:18:48,396
to proceed with your
game accordingly.


425
00:18:48,826 --> 00:18:50,446
So we've been talking
about players


426
00:18:50,506 --> 00:18:53,256
so what exactly are they?


427
00:18:53,566 --> 00:18:55,076
Well, we've got GKCloudPlayer.


428
00:18:55,466 --> 00:18:58,206
This is different
than the GK Players


429
00:18:58,206 --> 00:18:59,696
that you've been
dealing with before.


430
00:18:59,846 --> 00:19:03,746
GKCloudPlayer is only for,
to be used for Sessions.


431
00:19:04,326 --> 00:19:08,426
It basically has two pieces of
data, a player ID that is unique


432
00:19:08,466 --> 00:19:11,396
to your app as well
as the display name,


433
00:19:11,666 --> 00:19:16,266
that is what the user will have


434
00:19:16,266 --> 00:19:18,176
as what they want they
name to be displayed.


435
00:19:18,636 --> 00:19:21,496
This is not a GKPlayer
object at all.


436
00:19:21,716 --> 00:19:24,206
If you try to use this for a
leaderboard, for achievements,


437
00:19:24,206 --> 00:19:27,686
for other multiplayer, for
anything else, it will not work.


438
00:19:27,756 --> 00:19:28,846
So please don't do that.


439
00:19:29,146 --> 00:19:31,456
Everyone will be
very disappointed.


440
00:19:31,926 --> 00:19:35,706
So how do we get
our Cloud Players?


441
00:19:36,996 --> 00:19:39,356
Basically you can get your
current signed in player.


442
00:19:39,516 --> 00:19:42,766
Most of the things in Sessions
basically are going to be called


443
00:19:42,846 --> 00:19:45,976
from your current player though
there's not a whole lot of need


444
00:19:45,976 --> 00:19:47,246
to make sure that
you have the player,


445
00:19:47,246 --> 00:19:48,216
that you are then saying, "Oh,


446
00:19:48,316 --> 00:19:49,876
this player is saving
this data."


447
00:19:50,326 --> 00:19:52,426
All that's handled for
you in the background.


448
00:19:52,636 --> 00:19:55,446
But you might be
interested to know basically


449
00:19:55,446 --> 00:19:56,566
like who owns this session?


450
00:19:56,606 --> 00:19:59,606
So you might want to know if
the session is being deleted,


451
00:19:59,846 --> 00:20:00,786
if other player owns it,


452
00:20:00,786 --> 00:20:01,976
then that will delete the
data for everyone else.


453
00:20:02,046 --> 00:20:06,326
And you also might want to
be able to clear your badges,


454
00:20:06,356 --> 00:20:10,186
send messages, be a
little more aware of that.


455
00:20:10,186 --> 00:20:11,916
You can also get any of
the other players that are


456
00:20:11,916 --> 00:20:14,876
in the session, it's just
a property on that session.


457
00:20:15,096 --> 00:20:18,306
And that's the best way that
you're going to need to be able


458
00:20:18,306 --> 00:20:19,946
to send those messages
to those other players,


459
00:20:20,226 --> 00:20:22,126
especially setting
and clearing badges.


460
00:20:22,516 --> 00:20:27,886
So speaking of messages and
badges, let's talk about that.


461
00:20:29,166 --> 00:20:31,526
These messages, we say
messages but they're coming


462
00:20:31,526 --> 00:20:32,826
in as Game Center notifications.


463
00:20:33,386 --> 00:20:35,596
As I said before, all
players can send messages


464
00:20:35,596 --> 00:20:37,146
at any time to any other player.


465
00:20:37,206 --> 00:20:39,146
Those messages are
easily localizable.


466
00:20:39,476 --> 00:20:43,136
You can also send a little bit
of data along with that message


467
00:20:43,136 --> 00:20:47,676
if there's any sort of relevant
information that you might want


468
00:20:47,676 --> 00:20:50,296
to pass to the other players
about what this message is about


469
00:20:50,296 --> 00:20:53,286
or what they might want to
be looking at specifically.


470
00:20:53,766 --> 00:20:58,136
And you can also optionally
badge the message recipient


471
00:20:58,206 --> 00:21:01,176
so anyone that gets this
message can also receive a badge


472
00:21:01,506 --> 00:21:03,176
as well as that message.


473
00:21:03,366 --> 00:21:05,746
So what does the code look like?


474
00:21:06,176 --> 00:21:08,366
sendMessageWithLocalizedKey.


475
00:21:08,366 --> 00:21:10,826
You've got all these arguments,
who to send it to, whether


476
00:21:10,826 --> 00:21:12,366
or not you would like
to badge those players.


477
00:21:12,606 --> 00:21:15,556
And the Event Listener
that is called is session


478
00:21:15,556 --> 00:21:17,646
didReceiveMessage fromPlayer.


479
00:21:17,886 --> 00:21:21,416
And that will be called any
time a notification comes


480
00:21:21,416 --> 00:21:25,626
in to let the player know
that something has come


481
00:21:25,626 --> 00:21:27,866
in that they might
want to be aware of


482
00:21:27,866 --> 00:21:30,376
or might want to deal with.


483
00:21:31,556 --> 00:21:32,236
And badges.


484
00:21:32,696 --> 00:21:35,656
So I've said badges can be
included with these messages.


485
00:21:36,026 --> 00:21:41,316
So basically anytime you send a
message you can basically turn


486
00:21:41,556 --> 00:21:43,966
that badge state
on for that player.


487
00:21:44,226 --> 00:21:48,586
You've got one badge per
session so basically it means


488
00:21:48,586 --> 00:21:51,346
like there's something you need
to deal with or there's not.


489
00:21:51,346 --> 00:21:56,456
And these badges can be set
and cleared at any time.


490
00:21:56,456 --> 00:21:59,936
So if you send a message
and then you're like, "Hey,


491
00:21:59,936 --> 00:22:02,726
I need some help with this thing
that we're doing in the game,"


492
00:22:02,726 --> 00:22:05,246
and then no one shows
up you can, you know,


493
00:22:05,246 --> 00:22:07,146
clear those badges and
be like, "Never mind.


494
00:22:07,146 --> 00:22:10,146
I didn't want to
talk to you anyway."


495
00:22:10,146 --> 00:22:11,596
And so that you can keep all


496
00:22:11,596 --> 00:22:13,916
of that badge data
relevant and up to date.


497
00:22:14,296 --> 00:22:17,306
The app icon will
show the overall tally


498
00:22:17,306 --> 00:22:20,326
so if you've got three sessions
and all of them are badges,


499
00:22:20,326 --> 00:22:22,226
that app icon will say three.


500
00:22:22,636 --> 00:22:24,546
If you have one, you know,


501
00:22:24,546 --> 00:22:26,816
only one of them is
badge, it will say one.


502
00:22:26,816 --> 00:22:30,496
We could aggregate that for
you but based off of the,


503
00:22:30,496 --> 00:22:32,886
what is set in that session
it should be very clear


504
00:22:33,106 --> 00:22:34,556
where that badge
number is coming from.


505
00:22:35,096 --> 00:22:39,976
So let's talk about
managing these sessions.


506
00:22:40,546 --> 00:22:42,596
So we've made a session.


507
00:22:42,596 --> 00:22:43,396
We've saved it.


508
00:22:43,396 --> 00:22:44,456
We've loaded it.


509
00:22:44,456 --> 00:22:46,296
We've loaded the data.


510
00:22:46,296 --> 00:22:49,036
We've sent it to some players.


511
00:22:49,036 --> 00:22:52,556
Your user has turned
off your app.


512
00:22:53,226 --> 00:22:54,726
They've done some other things.


513
00:22:54,726 --> 00:22:55,996
You've come back.


514
00:22:55,996 --> 00:22:58,466
You want to load those
sessions and make sure


515
00:22:58,466 --> 00:23:00,306
that you've got all
the relevant data


516
00:23:00,306 --> 00:23:01,946
so that they can
start playing again.


517
00:23:02,826 --> 00:23:06,466
So the first thing you'll
want to call is Load Sessions.


518
00:23:06,956 --> 00:23:08,796
loadSessionsInContainer,
that container,


519
00:23:08,796 --> 00:23:10,646
that same app container
from the beginning


520
00:23:10,646 --> 00:23:11,816
that you made the session in.


521
00:23:11,866 --> 00:23:15,826
This will load the bare bones
information for all the sessions


522
00:23:15,826 --> 00:23:18,676
that your local player
is a part of.


523
00:23:18,996 --> 00:23:23,476
Then based off of that data
you're going to want to look


524
00:23:23,476 --> 00:23:25,706
and figure out which session
you're going to want to load.


525
00:23:25,976 --> 00:23:29,336
That session has two main
pieces to identify it.


526
00:23:29,336 --> 00:23:32,436
One is that title that you gave
us but the title is not unique.


527
00:23:32,486 --> 00:23:34,366
You can make it anything
that you want.


528
00:23:34,886 --> 00:23:39,066
And so that's not enough to be
able to just load a session.


529
00:23:39,346 --> 00:23:42,896
Upon creation of a session we
will give you an identifier


530
00:23:43,116 --> 00:23:45,946
and that is what you will
need to use in order to load


531
00:23:45,946 --> 00:23:46,976
that specific session.


532
00:23:47,316 --> 00:23:49,516
Call loadSessionWithIdentifier


533
00:23:49,836 --> 00:23:51,536
and that will give you
all the information


534
00:23:51,536 --> 00:23:53,836
for the session including
everything that you will need


535
00:23:53,836 --> 00:23:57,826
to do in order to start loading
that data, sending messages


536
00:23:57,826 --> 00:24:01,636
to other players, and
continuing on with your game.


537
00:24:01,746 --> 00:24:03,916
You also might want
to delete a session.


538
00:24:04,696 --> 00:24:07,176
If you call
removeSessionWithIdentifier,


539
00:24:07,176 --> 00:24:10,256
that's the same identifier
that we just talked about,


540
00:24:10,256 --> 00:24:13,446
if the player does
not own the session,


541
00:24:13,446 --> 00:24:15,836
it will merely remove
them from the session.


542
00:24:16,046 --> 00:24:18,266
It will not actually
delete any of that data.


543
00:24:18,696 --> 00:24:21,406
However, if you're
deleting a session


544
00:24:22,316 --> 00:24:27,436
that that player created,
then it will delete that data,


545
00:24:27,486 --> 00:24:28,586
not only for that player,


546
00:24:28,586 --> 00:24:30,646
but for everyone
else in that session.


547
00:24:30,646 --> 00:24:32,246
And that may be one
of those times


548
00:24:32,246 --> 00:24:36,356
that who your local player is,
figure out if they are going


549
00:24:36,356 --> 00:24:41,186
to be doing that to
everyone, and maybe send,


550
00:24:41,186 --> 00:24:43,356
alert the user that,
"Hey, you're deleting this


551
00:24:43,356 --> 00:24:46,916
for everyone," so that they
know what they're doing.


552
00:24:47,706 --> 00:24:52,356
At any time a player is removed
the Event Listener will be


553
00:24:52,356 --> 00:24:54,806
called didRemovePlayer
so that you'll know


554
00:24:54,806 --> 00:24:57,716
that someone has left
and that you can continue


555
00:24:57,716 --> 00:24:59,356
to update your game accordingly.


556
00:24:59,756 --> 00:25:04,116
So let's talk about
Game Session Streams.


557
00:25:04,116 --> 00:25:06,196
So this is the real-time
element of Sessions.


558
00:25:06,196 --> 00:25:07,786
Everything else up until
this point has kind


559
00:25:07,786 --> 00:25:09,096
of sound pretty turn-based.


560
00:25:09,216 --> 00:25:10,196
You're saving.


561
00:25:10,196 --> 00:25:12,046
You're passing messages.


562
00:25:12,196 --> 00:25:16,326
We also have the ability to have
real-time elements to your game.


563
00:25:16,646 --> 00:25:20,216
So Game Session Streams, you are
going to be able to connect any


564
00:25:20,216 --> 00:25:21,946
of the players that are
currently in that session.


565
00:25:21,946 --> 00:25:23,656
So everyone who is in that
session, if they would


566
00:25:23,656 --> 00:25:25,566
like to start sending
data to each other,


567
00:25:25,806 --> 00:25:27,046
that is how you're
going to do it.


568
00:25:27,546 --> 00:25:30,676
You can basically see the
status of any other players


569
00:25:30,676 --> 00:25:32,646
that are in the session.


570
00:25:33,236 --> 00:25:35,446
You can send data to
all the players that are


571
00:25:35,446 --> 00:25:37,996
in the connection
that you've set up.


572
00:25:37,996 --> 00:25:40,916
And you will be able to add
and drop players at any time


573
00:25:40,916 --> 00:25:42,506
without having to
restart that connection.


574
00:25:42,566 --> 00:25:46,186
So you can someone join in and
like two people can be playing,


575
00:25:46,466 --> 00:25:48,166
third person wants to come
in and join, you don't have


576
00:25:48,206 --> 00:25:49,766
to reset everything up.


577
00:25:49,986 --> 00:25:52,306
As soon as they start
they'll start receiving data.


578
00:25:52,306 --> 00:25:53,356
They can start sending data.


579
00:25:53,356 --> 00:25:55,716
You don't have to do any
handshakes for handling all


580
00:25:55,716 --> 00:25:56,936
of that in the background
for you.


581
00:25:56,936 --> 00:26:01,136
So how do we set
these connections up?


582
00:26:01,236 --> 00:26:02,756
Basically you just need


583
00:26:02,756 --> 00:26:04,566
to set the connection
state for that player.


584
00:26:05,006 --> 00:26:07,096
So you would just call
setConnectionState


585
00:26:07,096 --> 00:26:08,756
with completionHandler.


586
00:26:08,756 --> 00:26:11,846
This can fail for a
number of reasons but one


587
00:26:11,846 --> 00:26:14,846
of the reasons could
be if the max players


588
00:26:15,236 --> 00:26:16,696
for that session has
already been reached.


589
00:26:16,696 --> 00:26:19,136
So if this is the 17th
player who is trying to join


590
00:26:19,136 --> 00:26:21,966
that stream and you've
got that max 17 set,


591
00:26:22,446 --> 00:26:27,276
then this will actually fail
and they won't actually be able


592
00:26:27,276 --> 00:26:28,036
to join into the stream.


593
00:26:28,036 --> 00:26:30,996
You can see whether the players
are set with a specific state,


594
00:26:30,996 --> 00:26:33,436
basically the states are
connected and disconnected


595
00:26:33,436 --> 00:26:35,796
so you can see how many other
players are currently connected


596
00:26:35,796 --> 00:26:36,536
and who they are.


597
00:26:36,946 --> 00:26:41,796
And anytime a player either
changes that connection state,


598
00:26:41,796 --> 00:26:43,186
either connects or disconnects,


599
00:26:43,186 --> 00:26:47,016
the Event Listener session
player didChangeConnectionState


600
00:26:47,296 --> 00:26:48,266
will be called.


601
00:26:48,696 --> 00:26:53,886
And so you can know whether
or not that is changed


602
00:26:53,886 --> 00:26:56,376
and how many people you
are currently playing with.


603
00:26:56,796 --> 00:26:58,856
Once you set up the connection
then you're going to want


604
00:26:58,856 --> 00:27:00,156
to probably start sending data.


605
00:27:01,096 --> 00:27:03,836
So all of the data is
going to be sent to all


606
00:27:03,836 --> 00:27:04,906
of the connected players.


607
00:27:05,046 --> 00:27:07,286
You can send this either
reliably or unreliably,


608
00:27:07,536 --> 00:27:10,946
just the same as our
real-time API now.


609
00:27:11,266 --> 00:27:13,996
Whether or not it's more
important to make sure


610
00:27:13,996 --> 00:27:16,646
that those players get that data
or more important to make sure


611
00:27:16,946 --> 00:27:19,446
that they're getting the
data as fast as possible.


612
00:27:19,756 --> 00:27:24,296
And any time data is
sent the Event Listener


613
00:27:24,296 --> 00:27:28,346
didReceiveDataFromPlayer will be
called and you'll be able to get


614
00:27:28,346 --> 00:27:33,946
that data and update your
game locally, and continue


615
00:27:33,946 --> 00:27:37,206
on with playing your game.


616
00:27:38,056 --> 00:27:42,936
So that's all like the basic
bones of what makes up sessions.


617
00:27:43,486 --> 00:27:45,056
So let's talk about
some examples


618
00:27:45,056 --> 00:27:46,696
of what this actually
really looks


619
00:27:46,736 --> 00:27:50,326
like when you're
actually making a game.


620
00:27:50,526 --> 00:27:52,716
So first basically
you've got, you know,


621
00:27:52,716 --> 00:27:54,876
your basic turn-based game.


622
00:27:55,136 --> 00:27:56,656
So you've set up your session.


623
00:27:56,656 --> 00:27:57,646
You've got your game data.


624
00:27:57,646 --> 00:27:59,026
You've added a few players.


625
00:27:59,916 --> 00:28:01,346
Maybe it's Player One's turn.


626
00:28:01,346 --> 00:28:03,776
They're going to start by
figuring out what their turn is


627
00:28:03,776 --> 00:28:04,876
and they're going
to save that data.


628
00:28:05,036 --> 00:28:08,566
That data can then be loaded by
Players Two, Three, and Four.


629
00:28:08,566 --> 00:28:12,136
Message Player One can then
send a message to Player Two,


630
00:28:12,426 --> 00:28:13,686
sending it that badge
and saying,


631
00:28:13,686 --> 00:28:14,816
"Hey, it's your turn now."


632
00:28:15,056 --> 00:28:16,876
Maybe you would like to do that.


633
00:28:16,946 --> 00:28:19,496
Player Two can load up
their game, start playing,


634
00:28:19,496 --> 00:28:22,626
figure out what they would
want to do with that new data,


635
00:28:23,106 --> 00:28:25,876
take their turn, save that data,


636
00:28:25,876 --> 00:28:29,146
and then pass the turn
on to Player Four.


637
00:28:29,846 --> 00:28:31,996
Since there is no specified way


638
00:28:31,996 --> 00:28:33,926
in which these turns can
be passed that's up to you.


639
00:28:33,926 --> 00:28:36,726
You can pass it from One
to Two, Two to Three,


640
00:28:37,066 --> 00:28:39,066
Four to One, whatever you want.


641
00:28:39,066 --> 00:28:41,336
There is no specified way


642
00:28:41,336 --> 00:28:44,516
in which these turns can
be passed and, frankly,


643
00:28:44,516 --> 00:28:45,826
we don't know what you're doing.


644
00:28:47,676 --> 00:28:49,946
So you pass the game
on to Player Four.


645
00:28:49,946 --> 00:28:52,116
They get to take their
turn and continue on.


646
00:28:52,116 --> 00:28:54,776
So you've got all the
elements that you need


647
00:28:54,776 --> 00:28:56,436
for a really basic
turn-based game.


648
00:28:56,556 --> 00:28:59,686
You can also do a
real-time game.


649
00:29:00,156 --> 00:29:02,936
So you've got all of
your players set up.


650
00:29:04,326 --> 00:29:06,496
You can then basically
have everyone turn


651
00:29:06,496 --> 00:29:07,606
on their connection states.


652
00:29:07,606 --> 00:29:10,376
As soon as these connection
states are turned on we will set


653
00:29:10,376 --> 00:29:12,516
up the pipes in the
background to allow them


654
00:29:12,516 --> 00:29:13,816
to communicate with each other.


655
00:29:14,276 --> 00:29:15,916
And as soon as all
of those are set


656
00:29:15,916 --> 00:29:18,766
up then your players can start
sending data to everyone else.


657
00:29:19,176 --> 00:29:23,426
And then this data will
be just sent as long


658
00:29:23,426 --> 00:29:24,996
as these connections
are available.


659
00:29:25,536 --> 00:29:28,236
And then with sessions,
if there's any sort


660
00:29:28,236 --> 00:29:30,286
of information you would like
to be able to store at the end,


661
00:29:30,506 --> 00:29:33,566
such as, you know,
who won, or rankings,


662
00:29:33,566 --> 00:29:36,316
or anything for this
particular real-time game,


663
00:29:36,316 --> 00:29:38,536
you do have that ability
to have a little bit more


664
00:29:38,536 --> 00:29:40,756
of a persistent data
that you might want


665
00:29:40,756 --> 00:29:41,766
to save with that session.


666
00:29:42,946 --> 00:29:46,146
So those are your
real basic examples.


667
00:29:46,626 --> 00:29:49,866
But the real power session
comes in in being able


668
00:29:49,916 --> 00:29:51,906
to do much more complicated
games.


669
00:29:52,826 --> 00:29:55,466
So say you've got
a game session.


670
00:29:55,616 --> 00:29:58,356
It's a turn-based game but you
want to do a little bit more


671
00:29:58,356 --> 00:29:59,446
of a complicated turn.


672
00:29:59,446 --> 00:29:59,966
They've got a game.


673
00:30:01,046 --> 00:30:04,306
It's got some trading
card elements


674
00:30:04,626 --> 00:30:06,656
so when it's the player's
turn you might be able


675
00:30:06,756 --> 00:30:09,946
to trade cards, maybe brick
for sheep or something.


676
00:30:10,416 --> 00:30:15,746
And so the things that you
might be able to accomplish


677
00:30:15,746 --> 00:30:21,386
with table talk on an actual
board game you can now more


678
00:30:21,386 --> 00:30:22,776
easily accomplish with sessions.


679
00:30:23,296 --> 00:30:26,786
So say it's Player One's
turn and they want to trade


680
00:30:26,966 --> 00:30:29,856
with the other players and so
they send out a message and say,


681
00:30:29,856 --> 00:30:32,516
"Hey, I'd like trade
brick for sheep.


682
00:30:32,926 --> 00:30:33,756
Anyone interested?"


683
00:30:33,966 --> 00:30:35,516
So you can send that message.


684
00:30:35,516 --> 00:30:37,466
You can send a little bit
of data with that message


685
00:30:37,466 --> 00:30:40,126
to let the users know,
"Hey, this is what I want,"


686
00:30:40,126 --> 00:30:41,136
and send it out to everyone.


687
00:30:41,206 --> 00:30:42,526
Say Player Four is
like, "Oh, yeah.


688
00:30:42,526 --> 00:30:43,406
That sounds really good.


689
00:30:43,606 --> 00:30:46,566
You know, I'll take that trade,"
or, "Yeah, well, you know,


690
00:30:46,666 --> 00:30:47,636
that doesn't work for me.


691
00:30:47,636 --> 00:30:48,856
How about wheat for sheep?"


692
00:30:48,856 --> 00:30:49,486
or something else.


693
00:30:50,076 --> 00:30:53,056
So they can send a message back
to Player One, badging them


694
00:30:53,056 --> 00:30:56,726
and saying, "Hey, this is, I
either, I'll accept your trade


695
00:30:56,726 --> 00:30:57,536
or I have a different trade."


696
00:30:57,536 --> 00:30:59,426
You can send that
message back and forth,


697
00:30:59,646 --> 00:31:00,856
figure out what you want to do.


698
00:31:00,856 --> 00:31:02,456
As soon as Player
One decides, "Okay.


699
00:31:02,456 --> 00:31:04,256
Well, I'll take that trade,"
or, "I won't take that trade,"


700
00:31:04,446 --> 00:31:07,486
they can their turn,
unbadge everyone else,


701
00:31:08,236 --> 00:31:10,866
and save their data,
unbadge themselves,


702
00:31:11,196 --> 00:31:15,966
and then pass the
turn on to Player Two.


703
00:31:16,216 --> 00:31:21,956
We also have the ability
to more easily join


704
00:31:21,956 --> 00:31:24,456
into multiplayer games


705
00:31:24,456 --> 00:31:26,166
that might be a little
bit more complicated.


706
00:31:26,366 --> 00:31:29,976
So say you've got a multiplayer
game that's a little bit more


707
00:31:29,976 --> 00:31:31,116
like a King of the
Hill type stuff.


708
00:31:31,116 --> 00:31:33,256
You've got all these people in
session but you only want two


709
00:31:33,256 --> 00:31:35,496
of them to be able
to play at a time.


710
00:31:35,496 --> 00:31:36,786
So you're going to
start up your session.


711
00:31:36,786 --> 00:31:37,836
You've got Players One and Two.


712
00:31:37,836 --> 00:31:39,086
They're going to turn on
their connection state.


713
00:31:39,376 --> 00:31:41,106
They're going to join into
a game and they're going


714
00:31:41,106 --> 00:31:42,256
to pass their data
back and forth.


715
00:31:42,256 --> 00:31:44,166
They're going to have
a little head-to-head,


716
00:31:44,166 --> 00:31:46,956
a little one-on-one, and fight.


717
00:31:46,956 --> 00:31:50,346
And one of those players
will be eliminated.


718
00:31:50,576 --> 00:31:53,976
In this case let's
say Player One.


719
00:31:54,726 --> 00:31:58,286
And then Player Two
will go on and then play


720
00:31:58,286 --> 00:32:00,276
with the next person in line.


721
00:32:00,276 --> 00:32:02,436
You don't have to stop
your game in any way.


722
00:32:02,436 --> 00:32:04,586
You don't have to set up any
sort of connection screen.


723
00:32:04,966 --> 00:32:08,566
As soon as Player Three sets
their connection state then you


724
00:32:08,566 --> 00:32:11,046
can start sending that data
back and forth to Players Two


725
00:32:11,046 --> 00:32:14,366
and Three immediately
and they will be able


726
00:32:14,466 --> 00:32:16,886
to have their little
bout, see who wins.


727
00:32:17,316 --> 00:32:22,306
This time [inaudible] and
then Player Four can then come


728
00:32:22,306 --> 00:32:23,386
in and join in the fray.


729
00:32:23,666 --> 00:32:26,466
They can make that
connection and continue on.


730
00:32:26,466 --> 00:32:28,066
And you can continue
on with this,


731
00:32:28,416 --> 00:32:31,396
continuing to do any
sort of round-robin.


732
00:32:31,396 --> 00:32:32,546
If you've got like 100 players,


733
00:32:32,546 --> 00:32:34,016
you can go through
all 100 players.


734
00:32:34,366 --> 00:32:36,496
And just continue to
have a little King


735
00:32:36,496 --> 00:32:38,166
of the Hill style fight.


736
00:32:38,286 --> 00:32:40,566
And then you can store
that data to your game data


737
00:32:40,956 --> 00:32:45,366
that will allow to have a little
bit more persistent rankings


738
00:32:45,366 --> 00:32:48,346
and a little bit more persistent
[inaudible] among the people


739
00:32:48,346 --> 00:32:49,326
that are in this session.


740
00:32:50,886 --> 00:32:53,036
Another situation
that we might run


741
00:32:53,036 --> 00:32:55,586
into is assisted single player.


742
00:32:55,806 --> 00:32:58,686
So say you've got a
single player game.


743
00:32:58,686 --> 00:33:00,706
You're using Sessions to
basically store your data


744
00:33:01,096 --> 00:33:02,246
which is totally fine.


745
00:33:02,246 --> 00:33:04,676
You can absolutely do a single
player game with Sessions


746
00:33:04,956 --> 00:33:08,406
and basically use this as
a way to store your data


747
00:33:08,626 --> 00:33:12,476
and send your data so that all
of your data can be updated


748
00:33:12,476 --> 00:33:14,776
across all of your
devices very easily.


749
00:33:16,356 --> 00:33:18,416
But say your player is having
a little bit of a hard time.


750
00:33:18,416 --> 00:33:20,566
They've been playing this
game for a little while.


751
00:33:20,566 --> 00:33:22,286
Then they can't get
passed this level.


752
00:33:22,286 --> 00:33:23,556
They're having a
really hard time.


753
00:33:24,136 --> 00:33:26,146
Well, if you implement
your game as such,


754
00:33:26,276 --> 00:33:30,316
then Player One can then share
their game with another player.


755
00:33:30,736 --> 00:33:32,446
And so they can bring
in Player Two.


756
00:33:32,716 --> 00:33:34,286
And then you can
either add some elements


757
00:33:34,286 --> 00:33:36,966
that will allow Player
Two to help Player One


758
00:33:36,966 --> 00:33:39,266
through that level,
through some co-op methods,


759
00:33:39,266 --> 00:33:41,626
or you could even just allow
Player Two to just play


760
00:33:41,626 --> 00:33:44,696
that level for Player One
so that they can get past


761
00:33:44,696 --> 00:33:47,606
that really sticky point in
your game, allowing Player One


762
00:33:47,606 --> 00:33:48,906
to have a little
bit more enjoyment.


763
00:33:49,116 --> 00:33:51,066
So Player Two can come in, say,


764
00:33:51,636 --> 00:33:53,606
do whatever you would
like to let them do.


765
00:33:53,606 --> 00:33:54,896
Save that data, so
the game data.


766
00:33:54,896 --> 00:33:58,236
And then they can lead
themselves, removing themselves


767
00:33:58,236 --> 00:34:00,656
from that game and Player
One can continue on playing


768
00:34:00,656 --> 00:34:04,036
that game just as if Player
Two had never actually even


769
00:34:04,036 --> 00:34:05,086
been there.


770
00:34:05,086 --> 00:34:08,556
So that is Game Sessions.


771
00:34:09,056 --> 00:34:11,466
This is going to allow you
to be able to basically play


772
00:34:11,466 --> 00:34:13,656
with anyone, anyone that has
an iCloud account you can


773
00:34:13,656 --> 00:34:14,045
play with.


774
00:34:14,096 --> 00:34:16,775
You don't need to be their
friend in any sense of the word.


775
00:34:17,096 --> 00:34:21,176
So much more flexible game
structure that is going


776
00:34:21,176 --> 00:34:24,446
to allow you, as developers,
to be able to set up your games


777
00:34:24,446 --> 00:34:25,795
in whatever manner
you would like.


778
00:34:25,795 --> 00:34:29,846
We have really, really simple
multiplayer connections.


779
00:34:29,846 --> 00:34:32,416
They are really easy to
set up, really stable.


780
00:34:32,416 --> 00:34:34,926
They allow for lots of data
to be passed back and forth.


781
00:34:35,446 --> 00:34:36,966
And we're really excited


782
00:34:36,966 --> 00:34:39,436
to see what new possible game
styles you're going to come


783
00:34:39,436 --> 00:34:42,116
up with because of
the power of Sessions.


784
00:34:42,116 --> 00:34:44,536
Because of this mixing
of turn-based


785
00:34:44,806 --> 00:34:49,096
and real-time elements for
these games we're really excited


786
00:34:49,136 --> 00:34:51,716
to see what you're
going to come up with.


787
00:34:52,396 --> 00:34:55,446
So that's what's new in
Game Center this year.


788
00:34:55,735 --> 00:34:58,396
We had our new message-based
multiplayer invite


789
00:34:58,456 --> 00:34:59,816
which are now going
to allow you to play


790
00:34:59,816 --> 00:35:01,306
with anyone that
you can message.


791
00:35:01,886 --> 00:35:04,616
We have removed the
Game Center app.


792
00:35:04,806 --> 00:35:06,766
We have those persistent
game sessions


793
00:35:07,216 --> 00:35:08,466
that we just talked about.


794
00:35:08,756 --> 00:35:11,366
And we have also announced
Apple Watch support.


795
00:35:11,716 --> 00:35:14,166
If you would like any more
information on this session,


796
00:35:14,166 --> 00:35:15,186
you can go to this link.


797
00:35:15,556 --> 00:35:17,706
We are session number 611.


798
00:35:18,006 --> 00:35:20,316
And we have a few
related sessions


799
00:35:20,316 --> 00:35:21,886
that you might be interested in.


800
00:35:22,176 --> 00:35:23,316
We have the "Game Technologies


801
00:35:23,316 --> 00:35:25,406
for Apple Watch" later
on in this afternoon.


802
00:35:25,716 --> 00:35:29,296
We've also had several
sessions earlier this week


803
00:35:29,296 --> 00:35:33,356
that you can go and watch the
videos for, and several others,


804
00:35:33,356 --> 00:35:35,406
even more than what's
listed here.


805
00:35:35,546 --> 00:35:38,796
Thank you for coming
and have a great WWDC.


806
00:35:39,516 --> 00:35:43,500
[ Applause ]

