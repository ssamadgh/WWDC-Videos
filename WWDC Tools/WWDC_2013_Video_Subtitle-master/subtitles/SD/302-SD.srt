1
00:00:09,956 --> 00:00:10,726
>> Good afternoon.


2
00:00:11,276 --> 00:00:12,326
I'm Noah [phonetic].


3
00:00:12,536 --> 00:00:14,696
I'm here with my
colleague Nick [phonetic].


4
00:00:14,916 --> 00:00:16,015
And we're here to talk to you


5
00:00:16,015 --> 00:00:18,926
about what's new in
Passbook in iOS 7.


6
00:00:20,496 --> 00:00:23,466
Now, some of you have been
building really awesome things


7
00:00:23,466 --> 00:00:26,286
on top of Passbook already, and
we've had a bunch of requests


8
00:00:26,286 --> 00:00:29,156
from you for enhancements,
for new features,


9
00:00:29,696 --> 00:00:31,136
and we've addressed
a ton of those,


10
00:00:31,136 --> 00:00:32,796
and we've added some
new stuff as well.


11
00:00:32,796 --> 00:00:35,596
And I'll be going into all
of that in a lot of detail.


12
00:00:37,186 --> 00:00:39,246
Some of you have looked
at Passbook before


13
00:00:39,246 --> 00:00:40,196
and considered using it


14
00:00:40,196 --> 00:00:42,626
but found it didn't quite fit
your use case at the time.


15
00:00:43,126 --> 00:00:45,066
And we've made a couple of
changes that may affect that,


16
00:00:45,066 --> 00:00:47,196
so I'll be calling
those out as well later.


17
00:00:47,916 --> 00:00:50,806
And, finally, some of you
are entirely new to Passbook


18
00:00:50,806 --> 00:00:52,606
and just kind of curious
about what's going on.


19
00:00:53,106 --> 00:00:56,696
So I'll be -- while our
talks last year went


20
00:00:56,696 --> 00:00:58,526
into a bunch more detail
about how to get started,


21
00:00:58,526 --> 00:01:01,036
how to build your first
pass, and that kind of thing,


22
00:01:01,036 --> 00:01:03,056
I'll still be covering some
high level concepts just


23
00:01:03,386 --> 00:01:05,736
so you have some
idea what's going on.


24
00:01:05,906 --> 00:01:09,746
So without further
ado: let's get started.


25
00:01:10,416 --> 00:01:12,336
There's three main topics
I'll be covering today.


26
00:01:12,976 --> 00:01:16,816
First the Passbook
ecosystem: the different parts,


27
00:01:16,816 --> 00:01:20,576
how they fit together, how
they all talk to each other.


28
00:01:20,856 --> 00:01:22,806
Second: what's new,
what we've added


29
00:01:22,856 --> 00:01:24,926
to passes, to our APIs, the app.


30
00:01:25,076 --> 00:01:29,236
And finally a couple
of tips, tricks,


31
00:01:29,586 --> 00:01:32,236
ideas that might help
you with your debugging


32
00:01:32,236 --> 00:01:34,146
and your development of
Passbook integration.


33
00:01:34,576 --> 00:01:37,506
So let's go to the first
of these, the ecosystem.


34
00:01:38,086 --> 00:01:41,256
To start with: what is a pass?


35
00:01:41,496 --> 00:01:43,756
Well, it's just information
like any other,


36
00:01:43,856 --> 00:01:46,716
but what makes a pass more
useful than just a photo


37
00:01:46,716 --> 00:01:48,306
of a ticket, for instance, is --


38
00:01:48,346 --> 00:01:51,726
first, that it can be
relevant to a time and place.


39
00:01:52,966 --> 00:01:57,016
And second, that it can be used
for something in the real world:


40
00:01:57,076 --> 00:02:00,546
to get into something, to buy
something, to do something.


41
00:02:01,406 --> 00:02:05,396
So how does a pass get
from you to your users?


42
00:02:05,986 --> 00:02:07,996
Well, it starts with
your server,


43
00:02:08,545 --> 00:02:09,686
which generates the pass.


44
00:02:10,196 --> 00:02:12,696
Then it goes through your
website, or an email,


45
00:02:13,426 --> 00:02:15,836
or an app of your own if
you have some existing flow


46
00:02:15,836 --> 00:02:17,626
like buying a boarding pass.


47
00:02:18,166 --> 00:02:21,536
From any of those three,
it goes into Passbook,


48
00:02:22,606 --> 00:02:23,986
into the user's pass library,


49
00:02:24,686 --> 00:02:26,626
and from there they
can interact with it.


50
00:02:26,626 --> 00:02:28,176
There's a couple other
places that it can show


51
00:02:28,176 --> 00:02:30,406
up on the system, and I'll
talk about those more in a bit.


52
00:02:30,406 --> 00:02:32,576
But the core of it is that
it comes from these apps,


53
00:02:32,616 --> 00:02:36,986
goes into your library,
and that's kind of that.


54
00:02:37,196 --> 00:02:38,636
Now, a thing about passes:


55
00:02:38,666 --> 00:02:40,786
since they represent
real-world information,


56
00:02:41,636 --> 00:02:43,386
you expect them to
be up- to-date.


57
00:02:43,386 --> 00:02:45,436
They should always
reflect the current state


58
00:02:45,856 --> 00:02:47,416
of whatever they're
supposed to be used for.


59
00:02:47,526 --> 00:02:50,706
And we could make you go through
that whole flow all over again,


60
00:02:50,706 --> 00:02:54,236
direct your users back to
your app, send them an email,


61
00:02:54,296 --> 00:02:57,156
back through your app, but
that would be a huge pain


62
00:02:57,156 --> 00:02:58,406
and no one would do that.


63
00:02:58,696 --> 00:03:01,436
So we have a better system,
and it's built on top


64
00:03:01,436 --> 00:03:03,136
of the Apple Push
Notification Service.


65
00:03:03,716 --> 00:03:06,576
Your server sends us a
push, we make a request


66
00:03:06,576 --> 00:03:08,536
to your web service,
and you send us


67
00:03:08,536 --> 00:03:11,216
down a new version
of the pass file.


68
00:03:11,636 --> 00:03:13,666
And that seamlessly
replaces the existing pass


69
00:03:13,666 --> 00:03:14,616
in the user's pass library,


70
00:03:15,066 --> 00:03:19,106
and to them the pass is
magically now up-to-date.


71
00:03:20,806 --> 00:03:23,736
So the user has your
pass, it's up-to-date,


72
00:03:24,216 --> 00:03:25,076
how do they then use it?


73
00:03:25,706 --> 00:03:28,756
Well, they bring their
device to your location.


74
00:03:28,756 --> 00:03:32,396
You scan it, the barcode
on it, with some kind


75
00:03:32,396 --> 00:03:33,396
of point of sale system.


76
00:03:33,976 --> 00:03:35,166
That then talks to your server,


77
00:03:35,166 --> 00:03:38,196
which checks whether the pass
is valid, whether it can be used


78
00:03:38,196 --> 00:03:40,206
for whatever transaction
they're trying to complete,


79
00:03:40,926 --> 00:03:44,016
and finds out, okay, the
pass is available to use.


80
00:03:44,856 --> 00:03:46,246
It sends that information
back down,


81
00:03:46,246 --> 00:03:48,866
you complete the
transaction and that's that.


82
00:03:49,716 --> 00:03:53,506
Now, if something changes
about the pass as a result


83
00:03:54,796 --> 00:03:57,406
of this transaction, like
if you've used a coupon


84
00:03:57,406 --> 00:03:58,346
that can no longer be used,


85
00:03:58,346 --> 00:04:01,266
or if you have a store card
whose balance you're updating,


86
00:04:02,286 --> 00:04:03,666
your server might
take that opportunity


87
00:04:03,936 --> 00:04:06,306
to then send an update
notification to the pass


88
00:04:06,446 --> 00:04:09,286
and get it up-to-date.


89
00:04:09,426 --> 00:04:13,176
So that's just a vague
high level overview.


90
00:04:13,676 --> 00:04:15,406
Passes are information
that can be used


91
00:04:15,406 --> 00:04:16,216
for something in the real world.


92
00:04:16,856 --> 00:04:17,726
They come from your server.


93
00:04:18,555 --> 00:04:21,745
They get into the user's
pass library via your apps


94
00:04:21,745 --> 00:04:22,746
or via Mail or Safari.


95
00:04:23,376 --> 00:04:29,136
And they are then used by
scanning the barcode on the pass


96
00:04:29,696 --> 00:04:32,526
and checking its
validity with your server.


97
00:04:32,526 --> 00:04:37,246
And finally they can be
updated via the push system


98
00:04:37,326 --> 00:04:40,936
to make sure the pass has the
most up-to-date information.


99
00:04:41,716 --> 00:04:43,946
So that's the ecosystem.


100
00:04:44,056 --> 00:04:47,216
Let's talk about what's
new in Passbook in iOS 7.


101
00:04:48,236 --> 00:04:51,716
First, we've added ways for
you to enrich the content


102
00:04:51,716 --> 00:04:53,366
of your passes, to
make them more useful,


103
00:04:53,626 --> 00:04:55,516
work better, look better.


104
00:04:56,446 --> 00:04:58,586
We've added easier ways to
get passes into Passbook,


105
00:04:58,786 --> 00:05:01,626
both via APIs and via
some really cool new


106
00:05:01,746 --> 00:05:02,866
user-facing features.


107
00:05:03,766 --> 00:05:06,306
We've given you more
control over the relevance


108
00:05:06,306 --> 00:05:09,006
of your passes, over when they
show up on the lock screen


109
00:05:09,006 --> 00:05:10,126
of your user's device.


110
00:05:10,956 --> 00:05:13,236
And, finally, we've
added better support


111
00:05:13,236 --> 00:05:16,286
around the whole
using-passes thing.


112
00:05:16,716 --> 00:05:19,566
I'll be more clear
about that later on.


113
00:05:19,696 --> 00:05:21,706
So let's talk about the first
of these, the pass content.


114
00:05:22,266 --> 00:05:26,446
A pass is kind of
structured like an app bundle:


115
00:05:26,446 --> 00:05:30,056
it's a folder that's zipped up,
and the contents look like this.


116
00:05:30,416 --> 00:05:34,666
You have your pass.json which
defines what the pass is,


117
00:05:34,736 --> 00:05:36,066
how it behaves, how it looks.


118
00:05:36,776 --> 00:05:38,696
You have a couple of
localized string files,


119
00:05:38,836 --> 00:05:40,796
the lproge [phonetic]
folders that you see here


120
00:05:41,126 --> 00:05:45,476
which contain strings that get
substituted into your pass.json


121
00:05:45,816 --> 00:05:48,556
for user-facing strings.


122
00:05:49,016 --> 00:05:52,566
You have a couple of icons
and images that we use


123
00:05:52,566 --> 00:05:56,556
to display the pass in Passbook
and elsewhere in the OS.


124
00:05:56,686 --> 00:06:01,316
All of that is signed and
zipped, and there's your pass.


125
00:06:01,836 --> 00:06:05,246
So you may have noticed that
things look at little different


126
00:06:05,246 --> 00:06:07,656
in iOS 7, and Passbook's
no exception to that.


127
00:06:08,106 --> 00:06:10,806
Things have less gradients,
they have less shine,


128
00:06:11,146 --> 00:06:14,296
subtler shadows,
that kind of thing.


129
00:06:14,516 --> 00:06:16,516
And for the most part
that won't affect you.


130
00:06:16,516 --> 00:06:18,666
We already will apply the
new look to your passes.


131
00:06:19,276 --> 00:06:21,376
But if you've been
making a particular effort


132
00:06:21,996 --> 00:06:24,046
to match the iOS6 style,


133
00:06:24,046 --> 00:06:25,376
if you've been creating
your own gloss


134
00:06:25,686 --> 00:06:27,876
or if you've been sizing
images to fit precisely


135
00:06:27,876 --> 00:06:29,916
within the boundary of
the strip or anything,


136
00:06:30,356 --> 00:06:32,126
then that's going
to look wrong now.


137
00:06:32,126 --> 00:06:33,666
Your passes will look
slightly out of place.


138
00:06:33,666 --> 00:06:35,106
It won't be the end
of the world,


139
00:06:35,106 --> 00:06:36,876
but it will look slightly off.


140
00:06:37,886 --> 00:06:40,826
So the rule of thumb for
that is, well, don't do that.


141
00:06:40,986 --> 00:06:44,646
Follow our guidelines, supply
us the images in the style


142
00:06:44,646 --> 00:06:45,616
and format that we expect,


143
00:06:45,996 --> 00:06:49,076
and trust that we'll
do the right thing when


144
00:06:49,076 --> 00:06:53,136
and if the appearance changes of
what we're applying to passes.


145
00:06:54,206 --> 00:06:56,556
So there is one change to
the appearance that's going


146
00:06:56,556 --> 00:06:58,946
to affect your images that you
will probably need to adapt for,


147
00:06:59,216 --> 00:07:01,456
and that's that passes are now
the full width of the screen.


148
00:07:01,456 --> 00:07:04,806
They're 320 points, up from 312,


149
00:07:05,416 --> 00:07:07,216
which means that your
strip images need


150
00:07:07,216 --> 00:07:08,246
to change as well for that.


151
00:07:08,896 --> 00:07:11,086
We'll currently take
your strip image


152
00:07:11,086 --> 00:07:12,246
and scale it up a little bit.


153
00:07:13,086 --> 00:07:16,216
But if you want it to be pixel
perfect, which of course you do,


154
00:07:16,536 --> 00:07:21,926
then you want to change
those images for iOS 7.


155
00:07:22,736 --> 00:07:26,686
And we also no longer expect
you to etch your logos.


156
00:07:26,686 --> 00:07:27,956
You don't need to apply shadow.


157
00:07:27,956 --> 00:07:29,216
Just give those a solid color,


158
00:07:29,386 --> 00:07:32,666
and it will fit right
in, it will look great.


159
00:07:33,406 --> 00:07:38,036
Finally, while iOS 7 Passbook
will only run on Retina devices


160
00:07:38,036 --> 00:07:41,386
because those are the only
ones that support iOS 7 --


161
00:07:41,746 --> 00:07:45,136
we aren't in iPad,
for instance --


162
00:07:45,136 --> 00:07:47,596
you do still need to expect
that your passes are going


163
00:07:47,596 --> 00:07:48,876
to show up on iOS 6 devices.


164
00:07:48,876 --> 00:07:52,216
So you might have them
on the non-Retina screen


165
00:07:52,336 --> 00:07:53,896
on the iPhone 3GS for instance.


166
00:07:53,986 --> 00:07:56,456
So still provide
non-Retina images.


167
00:07:56,516 --> 00:07:58,916
Even though a lot of your
users are going to be


168
00:07:58,916 --> 00:08:03,146
on iOS 7 this fall, be
ready for your passes to end


169
00:08:03,146 --> 00:08:03,916
up pretty much anywhere.


170
00:08:04,986 --> 00:08:06,856
So let's talk about grouping,


171
00:08:07,476 --> 00:08:09,476
which is a behavior we
haven't gone into a lot


172
00:08:09,476 --> 00:08:11,596
of detail before, but
you've certainly noticed it


173
00:08:11,596 --> 00:08:13,226
if you've been producing
multiple passes.


174
00:08:13,976 --> 00:08:16,426
Passes group automatically.


175
00:08:17,146 --> 00:08:20,576
Based on a couple of rules,
details not very important,


176
00:08:21,086 --> 00:08:24,706
but sometimes the grouping
behavior is not exactly what


177
00:08:24,706 --> 00:08:25,256
you expect.


178
00:08:25,446 --> 00:08:27,566
If you have an itinerary,
for instance,


179
00:08:27,566 --> 00:08:28,736
for a couple different people,


180
00:08:29,036 --> 00:08:32,385
we might be grouping all those
passes together into one morass


181
00:08:33,086 --> 00:08:35,926
which you might want to
have better control over.


182
00:08:36,706 --> 00:08:39,155
So we now have this
grouping identifier key.


183
00:08:39,635 --> 00:08:40,426
It's just a string.


184
00:08:40,926 --> 00:08:43,256
You specify it and
any passes of yours


185
00:08:43,256 --> 00:08:45,266
that have the same grouping
identifier will group together.


186
00:08:45,266 --> 00:08:47,516
Any that have different
ones will group separately.


187
00:08:48,116 --> 00:08:51,456
So you can use this on event
tickets and boarding passes,


188
00:08:52,176 --> 00:08:55,416
which are the passes that are
most likely to be grouping


189
00:08:55,416 --> 00:08:57,466
in these kind of
cases, and that's useful


190
00:08:57,466 --> 00:08:58,156
if you're doing something


191
00:08:58,156 --> 00:09:00,676
that involves an itinerary
or a multi-day event.


192
00:09:01,936 --> 00:09:03,756
So, if you need that, use it.


193
00:09:04,566 --> 00:09:06,326
That's what it's there for.


194
00:09:06,826 --> 00:09:11,736
[ Applause ]


195
00:09:12,236 --> 00:09:15,386
So let's talk about something
different entirely: date fields.


196
00:09:16,236 --> 00:09:19,026
This is a feature that
we added in iOS 6,


197
00:09:19,476 --> 00:09:23,186
basically to make
users' experience


198
00:09:23,186 --> 00:09:24,856
around localization better.


199
00:09:25,556 --> 00:09:28,206
What we do is you give
us an absolute timestamp


200
00:09:28,496 --> 00:09:30,776
and a date style -- short,
medium, long, et cetera --


201
00:09:31,576 --> 00:09:34,186
and we format the
time in a format


202
00:09:34,186 --> 00:09:35,566
that the user will
expect to see.


203
00:09:35,816 --> 00:09:42,366
So if they have their locale set
to show three o'clock or 15.00


204
00:09:42,366 --> 00:09:44,466
or anything like that,
we'll show your time


205
00:09:44,466 --> 00:09:45,916
in the format they
expect it to be,


206
00:09:45,986 --> 00:09:48,256
and it will look
right, it will fit in.


207
00:09:49,106 --> 00:09:50,636
So something that comes


208
00:09:50,636 --> 00:09:53,576
out of our using this
timestamp format is


209
00:09:53,576 --> 00:09:55,806
that we get automatic
time zone adjustment.


210
00:09:55,806 --> 00:09:58,456
So if you have something
like a pass that specifies


211
00:09:58,456 --> 00:10:02,226
that it occurs in in
12 p.m. Pacific time,


212
00:10:02,626 --> 00:10:04,326
then the user will
see that as --


213
00:10:04,576 --> 00:10:07,976
I always get this stuff
wrong -- 3 p.m. Eastern.


214
00:10:09,156 --> 00:10:11,216
So that's great.


215
00:10:11,216 --> 00:10:13,266
It usually works in the way
that the users expect it to,


216
00:10:13,266 --> 00:10:15,206
but sometimes you don't
want that behavior.


217
00:10:15,206 --> 00:10:17,716
Sometimes you want to show a
time in the local time zone


218
00:10:17,716 --> 00:10:18,536
that it's going to happen.


219
00:10:19,046 --> 00:10:21,276
If you have a boarding
pass, for instance,


220
00:10:21,276 --> 00:10:22,456
you want to show
the departure time


221
00:10:22,836 --> 00:10:24,916
as when they get to the gate.


222
00:10:25,306 --> 00:10:27,436
Or, if you have a hotel
check-in, for instance,


223
00:10:28,256 --> 00:10:31,526
then again you want to show that
as the time that it is there.


224
00:10:31,526 --> 00:10:34,656
Because people have trouble
converting between time zones,


225
00:10:34,656 --> 00:10:39,326
like I just did, and you want
to help them out with that.


226
00:10:39,326 --> 00:10:42,876
So what we now allow you to do
is to control how that works.


227
00:10:43,246 --> 00:10:46,026
And the workaround that
some people have been using


228
00:10:46,026 --> 00:10:48,486
for this is to just
use text fields


229
00:10:48,486 --> 00:10:50,146
and say "3 PM" for instance.


230
00:10:50,356 --> 00:10:52,706
And that works, your users
will probably get it,


231
00:10:52,706 --> 00:10:54,136
but it's not the
best experience.


232
00:10:54,136 --> 00:10:56,586
It could be better, and we
like making things better.


233
00:10:57,236 --> 00:11:02,226
So we now allow you to disable
that time zone adjustment.


234
00:11:02,726 --> 00:11:05,486
It's just a key on date fields.


235
00:11:05,656 --> 00:11:07,896
You say "ignore time
zone" and we drop that.


236
00:11:07,896 --> 00:11:10,426
We show it always in the local
time zone that you specify.


237
00:11:11,006 --> 00:11:13,066
The format hasn't changed:
you can't just leave it


238
00:11:13,066 --> 00:11:15,106
out because we're still
validating against it.


239
00:11:15,786 --> 00:11:18,936
But what you should probably do
here is specify the local time


240
00:11:18,936 --> 00:11:22,766
zone that whatever time you're
trying to show is happening in.


241
00:11:23,936 --> 00:11:27,696
So iOS 6 device users will
get the right experience,


242
00:11:28,066 --> 00:11:31,556
more or less, and iOS 7
ones will get this nice new


243
00:11:31,986 --> 00:11:33,516
ignoring-time-zone behavior.


244
00:11:34,616 --> 00:11:35,626
So that's date fields.


245
00:11:36,626 --> 00:11:39,546
Let's talk about the back of
your passes, about app links.


246
00:11:40,936 --> 00:11:43,656
This is a feature that we
added for a couple of reasons.


247
00:11:43,816 --> 00:11:47,696
It can help promote your apps,
and it provides easy access


248
00:11:47,696 --> 00:11:51,556
to the apps if they have some
way of interacting with a pass


249
00:11:51,556 --> 00:11:52,586
in the user's pass library.


250
00:11:53,646 --> 00:11:55,236
So it looks like this.


251
00:11:55,576 --> 00:11:58,236
You have this banner at the
top of the back of your pass,


252
00:11:58,536 --> 00:11:59,606
kind of like the one in Safari.


253
00:11:59,606 --> 00:12:00,686
It shows your app icon.


254
00:12:00,686 --> 00:12:03,206
It shows a button that
will either take them


255
00:12:03,206 --> 00:12:05,546
to an App Store page which
will let them install it


256
00:12:05,546 --> 00:12:06,276
if they don't have it already.


257
00:12:06,846 --> 00:12:10,066
And if they do have it then it
will let them open the app right


258
00:12:10,066 --> 00:12:10,896
from the back of your pass.


259
00:12:11,636 --> 00:12:13,286
So if you have a store
card, for instance,


260
00:12:13,596 --> 00:12:16,236
this can let them
easily get into the app


261
00:12:16,426 --> 00:12:19,336
and check their rewards
or anything like that.


262
00:12:20,306 --> 00:12:25,706
So the question that arises with
these app links, particularly


263
00:12:25,706 --> 00:12:28,186
when you have an app that
can provide multiple passes


264
00:12:28,586 --> 00:12:31,606
like an event app, for
instance, is, well,


265
00:12:31,606 --> 00:12:33,276
which pass did the
user just come from?


266
00:12:33,336 --> 00:12:34,796
You know that they
got into your app,


267
00:12:35,316 --> 00:12:38,896
but you have no idea what pass
they want to interact with.


268
00:12:39,626 --> 00:12:43,066
You might have them go through
your list of passes you have


269
00:12:43,066 --> 00:12:46,446
in your library and
say, you know,


270
00:12:46,716 --> 00:12:48,076
which pass are you
talking about?


271
00:12:48,596 --> 00:12:49,976
But that's not ideal.


272
00:12:49,976 --> 00:12:53,146
It's an additional step, and
they already chose this pass


273
00:12:53,146 --> 00:12:54,676
when they flipped it
over to get to your app.


274
00:12:55,406 --> 00:12:58,436
So what we now allow you to
do is provide a context URL


275
00:13:00,026 --> 00:13:01,916
which we launch your
app with as soon


276
00:13:01,916 --> 00:13:05,926
as the user taps the open
button on the app link.


277
00:13:06,386 --> 00:13:08,276
And so that's really useful


278
00:13:08,646 --> 00:13:12,046
to immediately get
you the information


279
00:13:12,046 --> 00:13:15,186
as to what pass they
just came from.


280
00:13:15,406 --> 00:13:17,766
You might even embed additional
information in the URL itself.


281
00:13:18,426 --> 00:13:21,686
But thanks to this next feature
you don't actually even have


282
00:13:21,716 --> 00:13:22,996
to do that.


283
00:13:23,136 --> 00:13:26,316
Because what we now
have is pass metadata.


284
00:13:27,316 --> 00:13:30,236
You can embed a dictionary
of arbitrary information


285
00:13:30,416 --> 00:13:33,216
in your pass, and your
app can read it off


286
00:13:34,316 --> 00:13:37,436
with a user info property
on a PKPass object.


287
00:13:38,136 --> 00:13:42,526
So what this means is that you
can get semantic information


288
00:13:42,526 --> 00:13:44,596
about the pass without having


289
00:13:44,596 --> 00:13:46,426
to make a round trip
to your web server.


290
00:13:46,426 --> 00:13:49,836
You don't have to check the
serial number with your server


291
00:13:49,836 --> 00:13:51,036
and pull down additional
information,


292
00:13:51,036 --> 00:13:52,726
wait for the network
latency and all that.


293
00:13:52,786 --> 00:13:54,226
It's just right there.


294
00:13:54,496 --> 00:13:57,896
So your app can quickly
and easily show information


295
00:13:57,896 --> 00:13:58,886
about the pass to the user.


296
00:13:58,886 --> 00:14:00,976
It can even do it in conditions


297
00:14:00,976 --> 00:14:03,066
where there's no network access
-- on an iPod, for instance.


298
00:14:03,636 --> 00:14:06,966
So that should be really
useful if you've got an app


299
00:14:06,966 --> 00:14:08,726
that integrates with
your passes.


300
00:14:10,086 --> 00:14:13,396
And one thing about this is that
while you can probably trust


301
00:14:13,396 --> 00:14:14,766
that this information
did come from you,


302
00:14:14,766 --> 00:14:16,036
because you signed the pass,


303
00:14:16,336 --> 00:14:18,166
it might not necessarily
be up-to-date.


304
00:14:18,166 --> 00:14:20,296
So if you have anything
valuable or sensitive,


305
00:14:20,696 --> 00:14:22,306
like a store card
balance, for instance,


306
00:14:22,306 --> 00:14:24,156
you should still check
it with your server


307
00:14:24,396 --> 00:14:25,246
if you have the opportunity.


308
00:14:26,516 --> 00:14:27,766
So that's app links.


309
00:14:28,686 --> 00:14:31,476
Let's talk about text
links, and the text


310
00:14:31,826 --> 00:14:32,766
on the back of your passes.


311
00:14:33,336 --> 00:14:37,016
The idea for these is that
you can provide additional


312
00:14:37,016 --> 00:14:38,666
information related
to your passes.


313
00:14:38,816 --> 00:14:41,586
So you can provide
contact information


314
00:14:41,586 --> 00:14:43,526
or the location of an event.


315
00:14:43,526 --> 00:14:45,426
And to make that more
useful for your users,


316
00:14:46,076 --> 00:14:49,766
we run data detectors on
them: we turn things that look


317
00:14:49,766 --> 00:14:51,286
like useful information
into links.


318
00:14:51,286 --> 00:14:54,206
So an address opens maps,
a phone number allows them


319
00:14:54,206 --> 00:14:56,316
to call it, that kind of thing.


320
00:14:56,866 --> 00:14:58,226
But sometimes that
doesn't behave right.


321
00:14:58,226 --> 00:15:01,396
You can see here I have a
confirmation number that's being


322
00:15:01,396 --> 00:15:03,876
confused as a phone number,
and an address that --


323
00:15:04,256 --> 00:15:05,976
I don't know whether
this exists --


324
00:15:05,976 --> 00:15:08,906
but it's not a real place


325
00:15:09,236 --> 00:15:11,216
which we shouldn't be
giving directions to.


326
00:15:12,156 --> 00:15:14,716
So what we now allow you
to do is control this


327
00:15:14,806 --> 00:15:17,036
and set what kind
of data we detect.


328
00:15:17,586 --> 00:15:20,146
So your confirmation
number stays clean of links.


329
00:15:20,176 --> 00:15:22,536
Your things that you don't
want to be directions


330
00:15:22,536 --> 00:15:25,116
to they don't turn
into directions links.


331
00:15:25,446 --> 00:15:27,376
And that's going to
be really helpful.


332
00:15:27,376 --> 00:15:29,906
And your users probably
weren't bothered by this,


333
00:15:29,906 --> 00:15:31,676
but it was a little confusing.


334
00:15:32,036 --> 00:15:35,366
And this makes your
passes look better.


335
00:15:36,146 --> 00:15:40,026
So the way this works
is an array


336
00:15:40,026 --> 00:15:44,456
of strings containing the
list of data detector types


337
00:15:44,456 --> 00:15:45,286
that you want us to run.


338
00:15:45,286 --> 00:15:48,656
So that can be phone
numbers, addresses,


339
00:15:48,656 --> 00:15:49,916
emails, anything like that.


340
00:15:50,256 --> 00:15:52,266
You just provide the list of
what you want us to detect,


341
00:15:52,266 --> 00:15:55,356
and anything you leave
out we won't look for.


342
00:15:55,596 --> 00:15:57,866
So the default, of
course, is "all".


343
00:15:57,866 --> 00:16:00,806
If you don't provide this key,


344
00:16:00,806 --> 00:16:02,596
then we just do our
existing behavior.


345
00:16:03,066 --> 00:16:06,696
But if you're seeing any issues
with data detectors turning


346
00:16:06,696 --> 00:16:08,666
up when you don't want
them to, use this.


347
00:16:09,096 --> 00:16:09,746
It will help.


348
00:16:09,746 --> 00:16:13,166
I mentioned URLs,
and this is something


349
00:16:13,166 --> 00:16:15,046
that we've heard a lot
about from you guys.


350
00:16:15,746 --> 00:16:18,136
Specifically, that
when you embed URLs


351
00:16:18,136 --> 00:16:20,106
on your passes, they look bad.


352
00:16:20,556 --> 00:16:22,316
They're long, they're
ugly, they're opaque.


353
00:16:22,616 --> 00:16:25,906
You can have a long URL
with your company's website,


354
00:16:26,136 --> 00:16:27,816
or you can have a
URL-shortened one


355
00:16:28,126 --> 00:16:30,326
which is not your company's
website but is even more opaque.


356
00:16:30,526 --> 00:16:33,436
So that's not the ideal user
experience, and you have


357
00:16:33,476 --> 00:16:35,776
to include lots of explanatory
text saying "if you want to talk


358
00:16:35,776 --> 00:16:38,916
to our nice support people, tap
this link below," et cetera.


359
00:16:39,516 --> 00:16:44,706
So what we've added to
fix this is embedded URLs.


360
00:16:45,206 --> 00:16:47,996
[ Applause ]


361
00:16:48,496 --> 00:16:49,496
So it works like this.


362
00:16:50,166 --> 00:16:53,196
There's a new key on your field
that's called attributed value


363
00:16:54,096 --> 00:16:55,946
which is in addition to
the existing value key.


364
00:16:56,196 --> 00:16:58,936
So you can see here
I've included this


365
00:16:58,936 --> 00:17:01,146
with more information,
explanatory text,


366
00:17:01,276 --> 00:17:04,576
and I've also included
a much shorter --


367
00:17:04,576 --> 00:17:05,836
at least to the user's eye --


368
00:17:06,266 --> 00:17:08,705
version of this which does the
same thing and looks way better.


369
00:17:10,165 --> 00:17:13,986
So it's a standard
HTML-style link tag.


370
00:17:14,205 --> 00:17:17,586
You've probably seen it
before, but it's not full HTML.


371
00:17:17,586 --> 00:17:19,346
If you want to make your
text bounce around the screen


372
00:17:19,346 --> 00:17:23,766
or do marquees or sparkle, no,
no, we don't let you do that.


373
00:17:23,766 --> 00:17:25,556
And it's only on back
fields, of course,


374
00:17:25,556 --> 00:17:27,986
because as before we
only allow links there.


375
00:17:29,156 --> 00:17:32,116
But that should be a great way


376
00:17:32,116 --> 00:17:34,796
to make your passes look way
better and to simplify things.


377
00:17:34,796 --> 00:17:36,946
And basically it means your
users have a way better


378
00:17:36,946 --> 00:17:39,536
experience with your passes.


379
00:17:39,536 --> 00:17:40,306
One note about this.


380
00:17:40,786 --> 00:17:43,586
iOS 6 devices have no idea what
an attributed value key is.


381
00:17:44,226 --> 00:17:45,996
You still need to
include the value


382
00:17:46,206 --> 00:17:49,836
for backwards compatibility,
so: do that.


383
00:17:49,836 --> 00:17:52,456
Let's review all this.


384
00:17:53,506 --> 00:17:56,546
First, we have the new look.


385
00:17:56,976 --> 00:18:00,836
If you've been matching the old
style by making your own gloss


386
00:18:00,836 --> 00:18:03,676
or shadows or fitting
things to the dimensions


387
00:18:03,676 --> 00:18:05,286
that you thought were
going to be forever...


388
00:18:05,906 --> 00:18:06,406
don't do that.


389
00:18:06,616 --> 00:18:07,806
Just follow our guidelines,


390
00:18:08,456 --> 00:18:10,626
and we'll do the right
thing with your graphics.


391
00:18:12,176 --> 00:18:14,056
We now allow you
to do date fields


392
00:18:14,056 --> 00:18:15,236
without time zone adjustment.


393
00:18:16,986 --> 00:18:23,626
We've added app links for
context URLs along with metadata


394
00:18:24,526 --> 00:18:26,346
which allows you to pull
information off your pass


395
00:18:26,576 --> 00:18:28,266
without having to make a
round trip to your server,


396
00:18:28,266 --> 00:18:29,866
consume resources, et cetera.


397
00:18:30,656 --> 00:18:33,026
And, finally, we've given
you better links on the back


398
00:18:33,026 --> 00:18:35,316
of your passes via more
control over data detectors


399
00:18:35,746 --> 00:18:38,366
and via the new embedded URLs.


400
00:18:40,016 --> 00:18:42,076
So that's what's
new in pass content.


401
00:18:42,076 --> 00:18:45,716
Let's talk about how you
get passes into Passbook.


402
00:18:45,716 --> 00:18:46,996
We've made a lot
of changes here.


403
00:18:47,956 --> 00:18:50,926
The first one -- well,
first, an overview.


404
00:18:52,346 --> 00:18:54,096
Passes, as I said,
come from your server.


405
00:18:54,226 --> 00:18:56,946
They go through Mail or
Safari, which can handle things


406
00:18:56,946 --> 00:18:59,996
on their own, or in your apps
you have a couple of APIs,


407
00:19:00,156 --> 00:19:03,176
the PKAddPassesViewController
which allows you


408
00:19:03,176 --> 00:19:07,026
to present a pass to be added
to a user's pass library,


409
00:19:07,526 --> 00:19:10,466
and a couple of PKPassLibrary
methods that allow you to update


410
00:19:10,466 --> 00:19:12,136
and remove passes
from the library.


411
00:19:12,136 --> 00:19:15,706
And the thing about this is:
if you have a bunch of passes


412
00:19:15,706 --> 00:19:18,546
to get to the user you have
to add them one at a time,


413
00:19:18,716 --> 00:19:20,666
one after another, present
an add-pass view controller,


414
00:19:20,666 --> 00:19:23,146
present another one, et cetera,
and your users are either going


415
00:19:23,146 --> 00:19:25,676
to get fed up going through
those or they're not going


416
00:19:25,676 --> 00:19:28,596
to get fed up but they're
going to send you nasty emails.


417
00:19:29,096 --> 00:19:30,576
And we want to save
you from that.


418
00:19:30,576 --> 00:19:34,886
So what we've added is a new way


419
00:19:34,946 --> 00:19:37,136
to get multiple passes
into Passbook.


420
00:19:37,546 --> 00:19:39,126
And to demo that
I'd like to bring


421
00:19:39,126 --> 00:19:40,246
up Nick Circosta [phonetic].


422
00:19:40,246 --> 00:19:41,096
[ Applause ]


423
00:19:41,096 --> 00:19:48,536
>> Thanks, Noah.


424
00:19:49,026 --> 00:19:51,636
So as Noah said we've got some
great new features to PassKit


425
00:19:51,776 --> 00:19:55,816
in iOS 7 to allow you to
get passes easier than ever.


426
00:19:56,006 --> 00:19:58,286
So what we have here is a
relatively simple application,


427
00:19:58,286 --> 00:19:59,526
a collection-view-based
application


428
00:19:59,526 --> 00:20:06,456
and let's just go ahead and
run it and see how it looks.


429
00:20:06,456 --> 00:20:06,646
[ Pause ]


430
00:20:06,646 --> 00:20:09,046
Yay, we're all going
to a film festival.


431
00:20:09,046 --> 00:20:11,716
So if we were, say, running
this application on iOS 6,


432
00:20:12,256 --> 00:20:14,506
and a user wanted to add a
movie ticket for each one


433
00:20:14,506 --> 00:20:17,126
of these films, they would most
likely tap each on in turn,


434
00:20:17,126 --> 00:20:20,166
and then you'd present an
add-passes view controller


435
00:20:20,166 --> 00:20:22,376
for each one and
ingest it into Passbook.


436
00:20:22,376 --> 00:20:24,786
But we're going to do something
a little bit cooler now


437
00:20:24,876 --> 00:20:25,576
in iOS 7.


438
00:20:26,576 --> 00:20:28,346
So what we have here is
a method that's called


439
00:20:28,346 --> 00:20:29,316
when we tap the add button.


440
00:20:30,216 --> 00:20:32,566
And as with anything, when we're
working with the pass library,


441
00:20:32,566 --> 00:20:33,686
the first thing we want
to do is, of course,


442
00:20:33,686 --> 00:20:35,326
get a reference to
the pass library.


443
00:20:35,476 --> 00:20:37,436
Same as always, we
do a PKPassLibrary


444
00:20:37,516 --> 00:20:38,006
alloc-init [phonetic].


445
00:20:39,256 --> 00:20:41,766
Now, next we're going to call
this new method we've added,


446
00:20:41,766 --> 00:20:43,646
called -addPasses:with
CompletionHandler:.


447
00:20:44,386 --> 00:20:46,866
Now, in this particular
instance, we're passing


448
00:20:46,866 --> 00:20:48,286
in this array of selected films


449
00:20:48,556 --> 00:20:50,886
which contains all the films
the user has selected in the UI.


450
00:20:51,956 --> 00:20:54,646
And it's going to return it
to the completion handler one


451
00:20:54,646 --> 00:20:56,916
of two PKPassLibrary
add statuses.


452
00:20:57,776 --> 00:20:59,386
So let's take a look
at the first one.


453
00:21:00,376 --> 00:21:02,356
As with all these notifications,
you should always make sure


454
00:21:02,356 --> 00:21:04,916
that you're performing any
operations on the main thread.


455
00:21:06,146 --> 00:21:08,536
So the first status
you might receive is a


456
00:21:08,536 --> 00:21:10,166
PKPassLibraryShouldReviewPasses.


457
00:21:10,636 --> 00:21:12,846
Now this means that the
user has tapped "review".


458
00:21:13,246 --> 00:21:16,676
Now, you're going to initialize
a PK add passes view controller


459
00:21:16,736 --> 00:21:19,706
when this occurs, and what you
might notice is that instead


460
00:21:19,706 --> 00:21:21,806
of just passing in one
pass like in iOS 6,


461
00:21:21,916 --> 00:21:23,926
we can now pass it
an array of passes,


462
00:21:24,306 --> 00:21:25,996
which in this case is
our selected films array.


463
00:21:25,996 --> 00:21:29,146
You're going to obviously
want to set the delegates


464
00:21:29,146 --> 00:21:31,756
so you can get the notification
callback when the user is going


465
00:21:31,756 --> 00:21:34,086
to just dismiss it, and
then we're just going


466
00:21:34,086 --> 00:21:35,626
to present it to our user.


467
00:21:36,636 --> 00:21:40,726
Now, the second status is the
PKPassLibraryDidAddPasses.


468
00:21:41,416 --> 00:21:43,306
Now this means that the
user tapped "add all"


469
00:21:43,726 --> 00:21:45,436
and chose not to
review the passes.


470
00:21:46,346 --> 00:21:50,596
Now, we're also going to
update our movie posters UI,


471
00:21:50,596 --> 00:21:52,616
and I'll touch on that
method in a moment.


472
00:21:52,936 --> 00:21:55,846
I do want to add, just as a
piece of information to you,


473
00:21:55,846 --> 00:21:57,936
that in a future seed --
this is not in seed 1 --


474
00:21:57,936 --> 00:22:00,436
we will be adding a
third status to determine


475
00:22:00,436 --> 00:22:02,866
if the user cancelled
adding those passes.


476
00:22:02,896 --> 00:22:07,666
So as we continue down
the code we also have the


477
00:22:07,666 --> 00:22:10,176
"add-passes view controller
did finish" delegate method.


478
00:22:10,656 --> 00:22:12,516
And in this particular
instance we're also going


479
00:22:12,516 --> 00:22:14,976
to update our movie
posters when that occurs.


480
00:22:15,436 --> 00:22:18,806
Now, I've got a movie posters,
relatively simple method here,


481
00:22:19,146 --> 00:22:21,836
we're going to use the
pass library -containsPass:


482
00:22:21,836 --> 00:22:24,436
method to check to see if those
passes were actually added


483
00:22:24,756 --> 00:22:25,426
to Passbook.


484
00:22:26,106 --> 00:22:28,226
And when that occurs we're just
going to set a simple property


485
00:22:28,226 --> 00:22:30,336
in our model and then
read our collection view


486
00:22:30,596 --> 00:22:33,386
and fit a nice fade
on the passes we have.


487
00:22:34,266 --> 00:22:36,086
Let's go ahead and run that.


488
00:22:36,586 --> 00:22:39,016
[ Pause ]


489
00:22:39,516 --> 00:22:42,566
Cool. Now I really want
to see Epic, Iron Man,


490
00:22:42,566 --> 00:22:44,086
and the new Star Trek movie.


491
00:22:44,296 --> 00:22:44,896
Let's tap add.


492
00:22:44,896 --> 00:22:47,116
Now, as we said, the user
is going to be presented


493
00:22:47,116 --> 00:22:48,246
with this alert,
and they can choose


494
00:22:48,246 --> 00:22:49,396
to either review or add all.


495
00:22:49,786 --> 00:22:51,656
Add all just means
add it to Passbook.


496
00:22:52,166 --> 00:22:54,656
Review will mean "let
me see those passes",


497
00:22:54,726 --> 00:22:56,936
so we're going to tap "review".


498
00:22:57,026 --> 00:22:59,366
And there we have our
three movie passes.


499
00:22:59,626 --> 00:23:02,056
And when we do that we're
just going to tap "add all",


500
00:23:02,056 --> 00:23:06,636
they look pretty good to me,
and nicely animate those out.


501
00:23:06,636 --> 00:23:06,936
Wonderful.


502
00:23:06,936 --> 00:23:13,986
[Applause] And with
that back to Noah.


503
00:23:13,986 --> 00:23:14,053
[ Pause ]


504
00:23:14,053 --> 00:23:14,356
>> Thanks, Nick.


505
00:23:15,056 --> 00:23:16,146
So that's pretty cool.


506
00:23:16,196 --> 00:23:20,306
Let's talk about a bit
of the details behind it.


507
00:23:20,646 --> 00:23:23,716
It's a method on
PKPassLibrary as Nick said:


508
00:23:24,186 --> 00:23:25,786
-addPasses:with
CompletionHandler:.


509
00:23:26,496 --> 00:23:29,606
And you can call this and it
will just present that alert


510
00:23:29,606 --> 00:23:32,406
where the user can
then easily just tap


511
00:23:32,406 --> 00:23:34,106
"add all" or, as
you saw, "review".


512
00:23:34,686 --> 00:23:37,366
If it's "add all" then
your passes just go


513
00:23:37,366 --> 00:23:38,076
into their pass library.


514
00:23:38,076 --> 00:23:40,576
There's nothing more
that you have to do.


515
00:23:40,576 --> 00:23:42,876
If they tap "review",
though, you're responsible


516
00:23:42,876 --> 00:23:45,456
for then presenting a
PKAddPassesViewController,


517
00:23:45,936 --> 00:23:47,986
which has this new
initializer, -initWithPasses:.


518
00:23:48,646 --> 00:23:53,116
So that will allow
them to then choose


519
00:23:53,116 --> 00:23:54,696
to add all the passes
or cancel out.


520
00:23:55,456 --> 00:23:57,486
And as you might
gather from that,


521
00:23:58,006 --> 00:23:59,506
both these APIs are
all or nothing.


522
00:23:59,506 --> 00:24:02,676
If the user doesn't want to have
one of the passes then they have


523
00:24:02,676 --> 00:24:05,156
to cancel the whole thing or
go back and delete it later,


524
00:24:05,156 --> 00:24:07,686
which would be kind of a pain.


525
00:24:07,686 --> 00:24:09,826
So what you should do, as
you just saw in this demo,


526
00:24:10,196 --> 00:24:13,966
is provide your own UI for
choosing which passes they want.


527
00:24:13,966 --> 00:24:16,186
If you have any situation where
the user is going to choose


528
00:24:16,186 --> 00:24:19,326
from multiple passes, do that
first, then present this,


529
00:24:19,326 --> 00:24:21,116
and you'll be good to go.


530
00:24:22,116 --> 00:24:25,076
So that's the new API we
have around adding passes.


531
00:24:25,886 --> 00:24:27,466
Let's talk about sharing.


532
00:24:29,206 --> 00:24:31,766
You may have noticed, if
you've used Passbook in iOS 7,


533
00:24:32,416 --> 00:24:36,126
that each pass now has a
share button in the corner.


534
00:24:36,766 --> 00:24:38,416
And when you tap that
it brings up this sheet


535
00:24:39,536 --> 00:24:42,976
which allows your users
to send passes via mail


536
00:24:43,326 --> 00:24:44,896
or AirDrop or iMessage.


537
00:24:45,696 --> 00:24:48,436
And this is really good
for some use cases,


538
00:24:48,436 --> 00:24:51,096
and you may be possibly
worried about it for others,


539
00:24:51,096 --> 00:24:52,916
but I'll talk about
that in a second.


540
00:24:53,816 --> 00:24:55,996
What this means is that if you
have a pass that you want to be


541
00:24:55,996 --> 00:24:58,566
in a bunch of peoples' hands,
that is now super easy.


542
00:24:59,166 --> 00:25:02,076
They just say, you know, "hey,
friends, I went to Store,


543
00:25:02,076 --> 00:25:04,146
I got Thing, Thing is cool,
you should go to Store


544
00:25:04,146 --> 00:25:05,606
and get Thing: take this pass".


545
00:25:06,516 --> 00:25:07,226
It's great.


546
00:25:08,186 --> 00:25:09,396
If you have a situation


547
00:25:09,396 --> 00:25:13,156
where you've given one user
multiple passes that belong


548
00:25:13,156 --> 00:25:15,846
to multiple people,
then they can then hand


549
00:25:15,846 --> 00:25:18,926
out this movie ticket to
their friends they just bought


550
00:25:19,136 --> 00:25:21,286
for this
everyone-going-to-see-a-movie


551
00:25:21,286 --> 00:25:24,476
kind of scenario.


552
00:25:25,256 --> 00:25:28,156
And, as I said, you might
now be worried about this


553
00:25:28,156 --> 00:25:31,186
because your passes might now be
in multiple places and, "oh no,


554
00:25:31,186 --> 00:25:32,136
where's my security model?"


555
00:25:32,776 --> 00:25:34,436
That was already
very much possible.


556
00:25:34,576 --> 00:25:37,326
Your users could
forward emails around,


557
00:25:37,326 --> 00:25:38,576
they could share screen shots.


558
00:25:38,856 --> 00:25:40,746
You might even have more
legitimate use cases


559
00:25:40,746 --> 00:25:43,636
like restoring from an
iCloud backup or syncing


560
00:25:43,636 --> 00:25:45,076
from one device to another.


561
00:25:45,596 --> 00:25:47,386
So it's just now way more easy,


562
00:25:47,696 --> 00:25:48,816
and we've made the
user experience


563
00:25:48,816 --> 00:25:51,926
around it better,
as we sometimes do.


564
00:25:52,216 --> 00:25:55,246
So the key thing to take away
from that is that if it matters


565
00:25:55,246 --> 00:25:58,066
to you that your pass is on
multiple devices, validate them.


566
00:25:58,096 --> 00:26:01,746
Check the barcode:
that's what it's for.


567
00:26:01,806 --> 00:26:03,106
So that's sharing.


568
00:26:03,106 --> 00:26:05,386
Let's talk about something
that you may recognize


569
00:26:05,386 --> 00:26:07,736
from last year, the
Add to Passbook badge.


570
00:26:08,496 --> 00:26:09,966
This has proved to
be really useful.


571
00:26:10,086 --> 00:26:12,026
Users look for it,
they recognize it,


572
00:26:12,026 --> 00:26:14,486
they know that it means "I can
tap this, I can get a pass,


573
00:26:14,486 --> 00:26:15,926
it will be easy, it
will be awesome".


574
00:26:17,536 --> 00:26:21,696
And it's great for
using in content,


575
00:26:21,696 --> 00:26:22,956
in websites and email...


576
00:26:22,956 --> 00:26:24,256
in body content.


577
00:26:24,256 --> 00:26:26,766
But we've seen a couple of cases
of people thinking they have


578
00:26:26,836 --> 00:26:28,576
to use it and wedging it
into their UI somewhere


579
00:26:28,576 --> 00:26:31,196
where it doesn't fit --
sticking it in a navigation bar


580
00:26:31,336 --> 00:26:32,346
or in an action sheet.


581
00:26:32,666 --> 00:26:34,306
And you don't have to do that.


582
00:26:34,306 --> 00:26:36,046
Just design for your app.


583
00:26:36,906 --> 00:26:41,156
If you have some custom look
that this badge will not fit in,


584
00:26:41,376 --> 00:26:42,566
don't use it: use
your own thing.


585
00:26:43,026 --> 00:26:44,386
It will be all right.


586
00:26:44,976 --> 00:26:47,796
So this badge ties
into a new feature


587
00:26:47,796 --> 00:26:49,396
that we're really
excited about that some


588
00:26:49,396 --> 00:26:52,296
of you may have seen
already, called code scanning.


589
00:26:53,066 --> 00:26:57,316
And the idea here is it's a
really, really low-friction way


590
00:26:57,316 --> 00:26:58,776
to get a pass into
your user's hands.


591
00:26:58,776 --> 00:27:01,246
You don't have to send them
to a website, you don't have


592
00:27:01,246 --> 00:27:02,926
to get their email address,
you don't have to get them


593
00:27:02,926 --> 00:27:05,116
to install an app:
it's just there.


594
00:27:05,116 --> 00:27:10,076
And the idea is you put a URL
to a pass into a 2D barcode,


595
00:27:10,796 --> 00:27:13,336
and from Passbook they
can scan that code


596
00:27:13,336 --> 00:27:17,306
and turn it into a pass.


597
00:27:17,996 --> 00:27:22,536
So we've had a bunch of ideas
about how you can use this.


598
00:27:22,536 --> 00:27:23,716
I'm sure you'll come
up with many more.


599
00:27:24,326 --> 00:27:25,646
But let's talk about
these a bit.


600
00:27:26,196 --> 00:27:29,076
You've probably seen codes being
used in marketing materials


601
00:27:29,076 --> 00:27:30,036
that say, hey, go
to our website,


602
00:27:30,036 --> 00:27:31,756
scan this code instead
of typing it in.


603
00:27:32,316 --> 00:27:35,376
But that's not the only option.


604
00:27:35,766 --> 00:27:37,386
Your codes can be anywhere.


605
00:27:37,896 --> 00:27:40,836
If you're printing something
individual like a receipt,


606
00:27:41,046 --> 00:27:42,696
or a paper ticket
for some reason,


607
00:27:43,166 --> 00:27:45,616
then you can put a code
that's unique to that user


608
00:27:45,796 --> 00:27:47,876
on that receipt saying,
hey, here's a coupon


609
00:27:47,876 --> 00:27:50,946
for Thing related to
Thing-You-Just-Bought.


610
00:27:50,946 --> 00:27:54,286
Or, on an event ticket, you can
give someone a Passbook version


611
00:27:54,596 --> 00:27:57,736
of their paper pass or
paper ticket rather.


612
00:27:58,396 --> 00:28:03,426
But even if you are printing a
single code that's going to end


613
00:28:03,426 --> 00:28:05,876
up in a lot of places, in a
magazine ad or on a banner


614
00:28:05,876 --> 00:28:07,696
or anything like
that, they don't have


615
00:28:07,696 --> 00:28:09,216
to point to a single pass.


616
00:28:09,806 --> 00:28:12,136
You can just point that
URL at a web service


617
00:28:12,136 --> 00:28:13,516
that can send down
a unique pass.


618
00:28:13,516 --> 00:28:16,406
So you might be able
to get some information


619
00:28:16,406 --> 00:28:17,906
on how many people
are using your passes.


620
00:28:18,136 --> 00:28:21,236
Or, you could do something
like the first N people


621
00:28:21,236 --> 00:28:23,766
who scan this code get
this really awesome pass,


622
00:28:23,766 --> 00:28:25,266
that kind of thing.


623
00:28:25,536 --> 00:28:26,756
So there's a bunch of
possibilities here.


624
00:28:26,756 --> 00:28:30,536
And to show you one of the
ones that we've thought about


625
00:28:30,536 --> 00:28:35,146
and implemented, I'm going
to bring up, again, Nick.


626
00:28:35,646 --> 00:28:40,666
[ Applause ]


627
00:28:41,166 --> 00:28:41,646
>> Thanks, Noah.


628
00:28:41,996 --> 00:28:44,746
We're really excited about pass
scanning in iOS 7 so I'm going


629
00:28:44,746 --> 00:28:45,856
to give you a quick demo here.


630
00:28:46,086 --> 00:28:48,846
What we have here
is a simple web form


631
00:28:48,896 --> 00:28:51,436
for a survey running
outside our movie theaters


632
00:28:51,556 --> 00:28:53,706
on a nice little kiosk.


633
00:28:53,826 --> 00:28:56,596
Nothing really advanced, just
some simple drop down fields,


634
00:28:57,046 --> 00:28:59,956
and we'll make sure
those values are correct.


635
00:29:00,216 --> 00:29:01,466
And we're going to
click all done.


636
00:29:01,466 --> 00:29:04,236
Now, that's going to present
the user with a nice QR code


637
00:29:04,236 --> 00:29:06,756
that they can scan with
their Passbook device.


638
00:29:07,036 --> 00:29:09,516
But you may be asking, well,
what exactly happens here?


639
00:29:10,266 --> 00:29:13,106
So let's take a look at
the URL that we're going


640
00:29:13,106 --> 00:29:14,976
to be putting inside here.


641
00:29:15,486 --> 00:29:18,886
So the URL is pointing to
a web server that's running


642
00:29:18,886 --> 00:29:19,956
on this local laptop.


643
00:29:20,666 --> 00:29:22,866
And you may be wondering,
well, why are there a bunch


644
00:29:22,866 --> 00:29:24,346
of post variables on
the end of this URL.


645
00:29:24,956 --> 00:29:27,386
Well, as Noah said, you
don't actually need to point


646
00:29:27,386 --> 00:29:29,136
to a static PK pass file.


647
00:29:29,196 --> 00:29:29,726
We can just point


648
00:29:29,726 --> 00:29:32,516
to a generation service
and that [inaudible].


649
00:29:33,846 --> 00:29:36,296
And you may be asking, well,
why don't we just, say,


650
00:29:36,296 --> 00:29:37,366
send those variables away.


651
00:29:37,366 --> 00:29:39,336
Well, the interesting
thing in this scenario is


652
00:29:39,336 --> 00:29:41,586
that this kiosk doesn't actually
have to be live connected


653
00:29:41,586 --> 00:29:42,406
to the internet in any way.


654
00:29:42,516 --> 00:29:46,126
It can just be all locally
running and still be dynamic.


655
00:29:46,216 --> 00:29:49,016
And the nice thing about
this is, of course,


656
00:29:49,056 --> 00:29:51,416
prior to iOS 7 the user
would have to enter some sort


657
00:29:51,416 --> 00:29:58,086
of email address for you to send
them a pass and now they don't.


658
00:29:58,316 --> 00:30:00,366
One thing we do want
to point out is


659
00:30:00,366 --> 00:30:02,276
that if you are running
a generation service,


660
00:30:02,276 --> 00:30:05,206
in this particular
case it's in PHP,


661
00:30:05,206 --> 00:30:08,186
do remember the PKPass
MIME type in your header


662
00:30:08,436 --> 00:30:12,056
so that Passbook knows that
you're giving us down a pass.


663
00:30:12,246 --> 00:30:14,916
So, without further ado,
let's go and scan this one.


664
00:30:15,506 --> 00:30:19,586
So we're going to
launch Passbook in iOS 7.


665
00:30:20,406 --> 00:30:21,306
And, as Noah said, some


666
00:30:21,306 --> 00:30:23,036
of you may have noticed
there's a scan code button.


667
00:30:23,496 --> 00:30:24,896
So let's tap that.


668
00:30:24,896 --> 00:30:26,296
In this particular
case we're going


669
00:30:26,296 --> 00:30:29,856
to give our users a really nice
treat for filling out our form.


670
00:30:30,416 --> 00:30:32,906
Who doesn't love free popcorn?


671
00:30:33,206 --> 00:30:34,476
And that's pass scanning.


672
00:30:34,656 --> 00:30:34,916
Thank you.


673
00:30:34,916 --> 00:30:34,983
[ Applause ]


674
00:30:34,983 --> 00:30:35,266
>> Thanks, Nick.


675
00:30:35,266 --> 00:30:42,806
So we're pretty excited
about that.


676
00:30:43,556 --> 00:30:46,886
We can't wait to see what
you people do with it.


677
00:30:46,886 --> 00:30:49,406
Let's talk about a
couple of details here.


678
00:30:50,436 --> 00:30:53,626
First the URL that you give
us has to return a pass.


679
00:30:53,816 --> 00:30:56,096
If you point us to a website
and try to get your users fill


680
00:30:56,096 --> 00:30:57,916
out an extra form or
whatever -- not going to work.


681
00:30:58,096 --> 00:30:59,786
We will drop that on
the floor and say, hey,


682
00:30:59,786 --> 00:31:02,106
sorry, this is not a pass.


683
00:31:02,106 --> 00:31:05,826
So the URL has to be HTTPS
just like your web services.


684
00:31:06,046 --> 00:31:06,996
We like things to be secure.


685
00:31:08,076 --> 00:31:09,136
And this supports any


686
00:31:09,136 --> 00:31:12,946
of the standard Passbook barcode
formats, QR, PDF-417, and Aztec.


687
00:31:13,826 --> 00:31:15,316
Let's review all this.


688
00:31:15,786 --> 00:31:18,926
First, we have the new
add-multiple-passes API


689
00:31:19,436 --> 00:31:22,456
on PKPassLibrary and
PKAddPassesViewController.


690
00:31:22,926 --> 00:31:25,616
And something I didn't mention:
the add-pass view controller,


691
00:31:25,616 --> 00:31:27,106
you can still use
that by itself.


692
00:31:27,166 --> 00:31:28,616
If you want to add
multiple passes


693
00:31:28,616 --> 00:31:30,926
and you always want the user
to see them you can do that.


694
00:31:31,266 --> 00:31:32,936
But if you're using
the PKPassLibrary API,


695
00:31:33,216 --> 00:31:34,706
if the user chooses
to review the passes,


696
00:31:34,706 --> 00:31:37,066
you have to use the add
pass view controller then


697
00:31:37,416 --> 00:31:40,216
to show them the passes
that you're trying


698
00:31:40,216 --> 00:31:41,216
to get into their library.


699
00:31:42,196 --> 00:31:45,966
We have sharing which
is great for cases


700
00:31:45,966 --> 00:31:48,296
where you want your pass to
be in multiple places at once.


701
00:31:48,736 --> 00:31:51,706
But it also means that
since it's much easier


702
00:31:51,706 --> 00:31:55,416
than it was before, you should
be validating your passes


703
00:31:55,466 --> 00:31:58,406
if you care about them
being on multiple devices.


704
00:31:58,406 --> 00:32:02,976
Just make sure that
you're doing that.


705
00:32:04,126 --> 00:32:06,676
And, let's see.


706
00:32:07,516 --> 00:32:09,636
So we have the Add
to Passbook badge


707
00:32:09,636 --> 00:32:11,046
which we still encourage
you to use.


708
00:32:11,506 --> 00:32:12,746
It works great in content.


709
00:32:12,946 --> 00:32:15,896
If you're doing it in an app,
use it where it's appropriate.


710
00:32:15,896 --> 00:32:17,996
Don't try to wedge it in places
where it doesn't look right.


711
00:32:17,996 --> 00:32:20,866
And, finally, we have
the new code-scanning API


712
00:32:21,416 --> 00:32:24,856
which is really cool and
is a super low friction way


713
00:32:25,236 --> 00:32:27,926
to get passes into
users' pass libraries.


714
00:32:29,076 --> 00:32:31,486
So that's what's new
in getting passes.


715
00:32:31,486 --> 00:32:33,906
Let's talk about relevance
which I mentioned earlier.


716
00:32:34,586 --> 00:32:38,996
The idea of your passes showing
up in your lock screen is


717
00:32:38,996 --> 00:32:40,926
that it's really, really
easy to get to them.


718
00:32:41,356 --> 00:32:42,396
It's a single swipe away.


719
00:32:42,396 --> 00:32:46,106
Users don't have to open
their phone and unlock it,


720
00:32:46,366 --> 00:32:47,666
dig through their
apps, find Passbook,


721
00:32:47,666 --> 00:32:49,196
dig through their passes,
find your pass, et cetera.


722
00:32:49,446 --> 00:32:52,206
It's just right there when
they need it, and that's great.


723
00:32:52,506 --> 00:32:54,666
Users love that they
have this quick access.


724
00:32:55,896 --> 00:32:59,576
And it's the most important
method that you can use


725
00:32:59,956 --> 00:33:01,756
to get your users
to use your passes.


726
00:33:01,886 --> 00:33:03,946
If your pass is relevant
where they're ready to use it,


727
00:33:04,556 --> 00:33:07,086
they will recognize
that and use your pass,


728
00:33:07,086 --> 00:33:10,826
and you'll get that usage.


729
00:33:12,736 --> 00:33:15,046
So there's something that we've
seen some confusion about,


730
00:33:15,046 --> 00:33:17,316
both from users and developers,
which is the difference


731
00:33:17,316 --> 00:33:18,996
between relevance
and notifications.


732
00:33:19,796 --> 00:33:23,136
If you change something
about a pass,


733
00:33:23,136 --> 00:33:26,506
that generates a notification:
you have something saying, hey,


734
00:33:26,506 --> 00:33:27,356
there's something new here.


735
00:33:27,856 --> 00:33:29,936
Relevance is passive,
so to speak.


736
00:33:30,156 --> 00:33:33,976
It's a way to make
your passes available


737
00:33:33,976 --> 00:33:35,586
when they're ready to be used.


738
00:33:36,476 --> 00:33:37,916
So we just wanted
to clarify that.


739
00:33:39,176 --> 00:33:41,796
In iOS 6, the API we
introduced was based


740
00:33:41,796 --> 00:33:44,496
on geographic coordinates,
on points on the map.


741
00:33:45,066 --> 00:33:50,216
You could specify ten locations
with geocoordinates and whatnot,


742
00:33:51,176 --> 00:33:52,996
and within a certain range


743
00:33:53,126 --> 00:33:56,596
of those places we'd make
the pass relevant based


744
00:33:56,596 --> 00:33:58,556
on the pass style
and other factors.


745
00:33:59,996 --> 00:34:02,166
And if you wanted to change
any of those locations,


746
00:34:02,166 --> 00:34:05,456
if you had a bunch of them,
more than ten, and your user was


747
00:34:05,456 --> 00:34:09,366
in a particular area, or if you
had locations that moved around,


748
00:34:09,366 --> 00:34:11,456
vehicles -- trains,
for instance --


749
00:34:12,496 --> 00:34:15,416
then you would have to
push an update to the pass


750
00:34:15,766 --> 00:34:17,226
to get those new
locations into it


751
00:34:17,226 --> 00:34:22,085
which is not the
ideal way to do that.


752
00:34:22,085 --> 00:34:23,346
So we have a new API for this.


753
00:34:23,346 --> 00:34:26,585
It was meant to address
some of the requests we got


754
00:34:26,585 --> 00:34:27,716
about this from developers.


755
00:34:28,466 --> 00:34:29,326
It's called proximity.


756
00:34:29,936 --> 00:34:33,176
It's based around iBeacons,


757
00:34:33,356 --> 00:34:34,505
which you might have
seen mentioned


758
00:34:34,606 --> 00:34:35,386
in the keynote on Monday.


759
00:34:35,565 --> 00:34:39,806
The idea is this API on Core
Location which allows you


760
00:34:39,806 --> 00:34:42,656
to have devices that
broadcast a unique identifier


761
00:34:42,946 --> 00:34:43,606
over Bluetooth.


762
00:34:44,036 --> 00:34:47,446
And the way that
we're using that --


763
00:34:48,346 --> 00:34:50,496
since Core Location provides,
of course, APIs to pick


764
00:34:50,496 --> 00:34:54,186
up that broadcast -- is that
we can now make passes relevant


765
00:34:54,186 --> 00:34:55,815
whenever they're near
one of these devices.


766
00:34:57,025 --> 00:35:00,786
And that allows you a
ton of extra flexibility.


767
00:35:01,266 --> 00:35:05,136
It means that you can have any
number of locations as long


768
00:35:05,136 --> 00:35:06,736
as they have beacons
broadcasting the same


769
00:35:06,736 --> 00:35:07,526
unique identifier.


770
00:35:07,806 --> 00:35:10,716
If you have a location that
moves around, like a taco truck,


771
00:35:10,716 --> 00:35:12,596
you can just keep a beacon
with you, and you don't have


772
00:35:12,646 --> 00:35:15,356
to update the pass to say
"here is where I'm going to be"


773
00:35:15,666 --> 00:35:16,896
because the pass
is already going


774
00:35:16,896 --> 00:35:18,556
to be relevant wherever you are.


775
00:35:19,146 --> 00:35:21,646
So that's really cool and
we're really excited about it.


776
00:35:21,646 --> 00:35:23,446
Let's talk about the API.


777
00:35:25,006 --> 00:35:27,896
It looks kind of like the
locations one, only instead


778
00:35:27,896 --> 00:35:29,486
of a pair of coordinates
you're just specifying a


779
00:35:29,486 --> 00:35:30,246
unique identifier.


780
00:35:30,876 --> 00:35:33,046
And Passbook will look
for that identifier,


781
00:35:33,146 --> 00:35:36,196
and when it is detected
your pass becomes relevant.


782
00:35:36,536 --> 00:35:38,356
It's really simple,
it's really easy,


783
00:35:38,606 --> 00:35:40,026
and it should help you a lot


784
00:35:40,426 --> 00:35:43,556
with more flexible
conditions for pass relevance.


785
00:35:44,266 --> 00:35:46,756
Of course we support up
to ten different beacons,


786
00:35:47,076 --> 00:35:49,146
which is less important than
it was with the location API


787
00:35:49,756 --> 00:35:53,686
because the beacons can all be
broadcasting the same unique ID


788
00:35:53,686 --> 00:35:54,976
-- it doesn't really
matter how many there are --


789
00:35:55,496 --> 00:35:58,556
but if you want to do
something different with those,


790
00:35:58,556 --> 00:35:59,616
if you want to use,
for instance,


791
00:35:59,616 --> 00:36:01,316
different relevant text
for different beacons


792
00:36:01,576 --> 00:36:02,856
in a department store,
for instance,


793
00:36:03,646 --> 00:36:06,936
then you can have multiple
beacons in your pass,


794
00:36:06,936 --> 00:36:08,826
we'll look for those and
display the appropriate text


795
00:36:08,856 --> 00:36:09,706
when we detect the beacon.


796
00:36:10,736 --> 00:36:13,676
And, finally, something
really cool about this is


797
00:36:13,676 --> 00:36:18,516
that iOS devices running iOS 7
can act as beacons themselves.


798
00:36:20,096 --> 00:36:21,896
So if you have a
point-of-sale app or something


799
00:36:22,576 --> 00:36:23,746
that is already integrating


800
00:36:23,746 --> 00:36:26,286
with Passbook you now
have a really easy way


801
00:36:26,636 --> 00:36:28,146
to make your passes relevant


802
00:36:28,396 --> 00:36:29,646
when they're near
that point of sale.


803
00:36:30,326 --> 00:36:33,106
You just have your app
broadcast the beacon ID


804
00:36:33,566 --> 00:36:35,146
and we'll pick it up,
and your pass will be


805
00:36:35,146 --> 00:36:36,956
on the user's lock screen and
you'll be ready to use it.


806
00:36:38,076 --> 00:36:39,656
Pretty neat.


807
00:36:40,276 --> 00:36:41,676
One final thing about relevance.


808
00:36:42,106 --> 00:36:44,666
Something that we've had
some requests for is a way


809
00:36:44,666 --> 00:36:47,346
to control how far away
a pass becomes relevant.


810
00:36:47,636 --> 00:36:49,386
Because we use different
radiuses for these,


811
00:36:49,386 --> 00:36:50,726
and if you have, for instance,


812
00:36:50,726 --> 00:36:52,996
a bus station that's using
boarding-pass-style passes,


813
00:36:53,386 --> 00:36:55,286
then you might see complaints
from a user saying, hey,


814
00:36:55,286 --> 00:36:56,966
this pass is becoming
relevant like a kilometer


815
00:36:56,966 --> 00:36:59,156
and a half away, what's
going on with that?


816
00:36:59,156 --> 00:37:00,906
And the reason would
be, of course,


817
00:37:00,906 --> 00:37:03,796
that we size boarding-pass
relevance for an airport or so.


818
00:37:04,546 --> 00:37:08,046
So what we now allow you to do
is just control that distance.


819
00:37:08,266 --> 00:37:11,136
You can specify a radius


820
00:37:11,496 --> 00:37:13,116
around which your pass
will become relevant --


821
00:37:13,496 --> 00:37:17,126
and note that that's a cap, not
a replacement for our value.


822
00:37:17,126 --> 00:37:20,246
So if you want to make your pass
relevant all over the Bay Area,


823
00:37:20,246 --> 00:37:22,376
then you're going to
have to put out a lot


824
00:37:22,376 --> 00:37:24,676
of beacons or something.


825
00:37:24,676 --> 00:37:25,746
So let's review all this.


826
00:37:26,406 --> 00:37:30,686
First, relevance is a
quick, easy way for users


827
00:37:30,686 --> 00:37:31,706
to get access to your passes.


828
00:37:32,096 --> 00:37:33,126
Shows up on their lock screen.


829
00:37:33,216 --> 00:37:36,606
They can swipe, get to the
pass, move on with their lives.


830
00:37:37,956 --> 00:37:40,646
Relevance and notifications
are two different things.


831
00:37:41,816 --> 00:37:44,956
One is active, one is passive.


832
00:37:44,956 --> 00:37:48,346
Beacons now allow you to have
way more flexible relevance


833
00:37:48,566 --> 00:37:49,836
by setting up these devices


834
00:37:49,836 --> 00:37:51,056
and broadcasting a
unique identifier.


835
00:37:52,346 --> 00:37:54,686
And, finally, we allow you
to control the distance


836
00:37:54,686 --> 00:37:55,976
at which your pass
has become relevant


837
00:37:56,746 --> 00:37:57,966
when using location API.


838
00:37:59,126 --> 00:38:00,606
So that's relevance.


839
00:38:00,916 --> 00:38:02,016
Let's talk about updates.


840
00:38:02,526 --> 00:38:05,986
Now, this hasn't changed much
since iOS 6; we're just calling


841
00:38:05,986 --> 00:38:07,876
out a couple things about it.


842
00:38:07,876 --> 00:38:11,696
And first off, if
you're not using updates


843
00:38:11,766 --> 00:38:13,686
when your pass can
change, you should be.


844
00:38:13,976 --> 00:38:14,346
They're great.


845
00:38:14,346 --> 00:38:19,526
It means that your pass can
be up-to-date, can stay alive


846
00:38:19,766 --> 00:38:22,076
with whatever information
it's supposed to represent.


847
00:38:22,506 --> 00:38:26,306
If you've got a
boarding-pass-type ticket


848
00:38:26,306 --> 00:38:29,406
or a store card that doesn't
update when something changes


849
00:38:29,406 --> 00:38:31,706
about it, then you're kind of
missing out on an opportunity


850
00:38:31,706 --> 00:38:33,906
to make your user's
experience way better.


851
00:38:35,616 --> 00:38:39,526
So a thing about updates is that
if you include a change message


852
00:38:39,606 --> 00:38:42,346
for fields that have
changed then we show it


853
00:38:42,346 --> 00:38:43,556
as a notification to the user.


854
00:38:44,666 --> 00:38:45,806
And if you're going to use


855
00:38:45,806 --> 00:38:49,376
that you should follow the same
principles that you would use


856
00:38:49,376 --> 00:38:50,876
when sending notifications
via an app.


857
00:38:50,876 --> 00:38:52,746
You don't want to
nag your users.


858
00:38:53,226 --> 00:38:56,306
If you send a push
every couple of hours


859
00:38:56,306 --> 00:38:58,226
to someone's store card
saying, "hey, there are things


860
00:38:58,226 --> 00:39:00,026
in our store, hey, check out
this other thing in our store",


861
00:39:00,556 --> 00:39:01,936
they're eventually going
to get fed up with that.


862
00:39:01,936 --> 00:39:04,166
They're going to turn automatic
updates off and you'll lose


863
00:39:04,166 --> 00:39:05,226
that channel to your users.


864
00:39:05,226 --> 00:39:07,116
So use them sparingly.


865
00:39:07,116 --> 00:39:08,636
Make sure there's
something the user cares


866
00:39:08,636 --> 00:39:12,066
about when you're
updating your pass.


867
00:39:12,066 --> 00:39:14,326
So I mentioned that
we've made some changes


868
00:39:14,326 --> 00:39:18,196
around using passes.


869
00:39:18,446 --> 00:39:21,866
As I mentioned, the idea is
that you scan the barcode


870
00:39:21,866 --> 00:39:23,526
on the user's pass, check
it with your server,


871
00:39:24,146 --> 00:39:27,536
and then complete
whatever transaction you're


872
00:39:28,006 --> 00:39:29,406
going through.


873
00:39:29,636 --> 00:39:33,766
And so the code scanning feature


874
00:39:33,766 --> 00:39:36,796
that we showed off a
minute ago is actually based


875
00:39:36,796 --> 00:39:39,726
on an API that's now
available to you in iOS 7.


876
00:39:40,416 --> 00:39:41,636
And it's on AVFoundation.


877
00:39:42,486 --> 00:39:45,236
It's part of the
camera metadata thing.


878
00:39:45,236 --> 00:39:46,906
I'll refer to the talk
that talks about it


879
00:39:46,906 --> 00:39:48,066
in way more detail later.


880
00:39:49,146 --> 00:39:52,926
And so what this means is that
if you have a point-of-sale app


881
00:39:52,926 --> 00:39:57,086
or something, like I mentioned
earlier, then you can now have


882
00:39:57,086 --> 00:39:59,096
that kind of be an
end-to-end integration.


883
00:39:59,096 --> 00:40:02,546
It can make the passes relevant,
and now it can scan the passes


884
00:40:02,546 --> 00:40:06,156
for you, and you can
then do whatever you need


885
00:40:06,156 --> 00:40:06,996
to do with them.


886
00:40:07,426 --> 00:40:09,896
But this means you can
make better point-of-sales


887
00:40:09,896 --> 00:40:12,096
and improve your user's
experience around their passes.


888
00:40:12,476 --> 00:40:14,986
There are some third party APIs
people have been using already


889
00:40:14,986 --> 00:40:16,906
for this, but we think
this one's kind of great.


890
00:40:18,156 --> 00:40:20,776
And, of course, it supports
all the pass barcode types


891
00:40:20,916 --> 00:40:22,706
like I mentioned earlier.


892
00:40:22,706 --> 00:40:23,536
[ Applause ]


893
00:40:23,536 --> 00:40:32,646
So let's talk about expiration.


894
00:40:33,956 --> 00:40:36,436
Something we had a
lot of requests for --


895
00:40:36,586 --> 00:40:38,166
again, both from users
and developers --


896
00:40:38,166 --> 00:40:41,406
is a way to know when your
users can no longer use a pass.


897
00:40:41,846 --> 00:40:45,336
So what we now allow you
to do is to mark a pass


898
00:40:45,426 --> 00:40:47,276
as expired in the Passbook UI.


899
00:40:48,046 --> 00:40:51,056
We gray out the barcode, we
show "this pass has expired"


900
00:40:51,526 --> 00:40:57,046
in whatever language, and
that is basically just a way


901
00:40:57,046 --> 00:41:00,356
that you can cue your users and
say, "hey, don't bother trying


902
00:41:00,356 --> 00:41:01,856
to use this pass: it's
been used already".


903
00:41:02,696 --> 00:41:04,606
There's two keys that
you can use for this.


904
00:41:04,966 --> 00:41:06,916
The first is an expiration date,


905
00:41:07,466 --> 00:41:09,726
after which we'll automatically
mark the pass as expired.


906
00:41:09,776 --> 00:41:15,146
And the second is a voided key
which you can push to the pass


907
00:41:15,406 --> 00:41:16,636
if you want to immediately
update it --


908
00:41:16,636 --> 00:41:18,096
if someone has just
used their ticket


909
00:41:18,096 --> 00:41:20,936
or if their store card is
now entirely out of funds


910
00:41:20,936 --> 00:41:21,636
or anything like that.


911
00:41:23,266 --> 00:41:26,936
And you should note that
this is not an absolute.


912
00:41:27,176 --> 00:41:29,156
You could be looking at a
screen shot of the pass,


913
00:41:29,156 --> 00:41:31,116
the update might not
have made it to the pass,


914
00:41:31,496 --> 00:41:33,556
so this should not be your form


915
00:41:33,556 --> 00:41:35,436
of security just
graying out your barcode.


916
00:41:35,436 --> 00:41:37,996
It's really just meant as
a visual cue to your users


917
00:41:38,226 --> 00:41:40,556
to let them know when they
can and can't use a pass.


918
00:41:41,406 --> 00:41:43,826
So as before, if
it matters to you


919
00:41:43,826 --> 00:41:45,486
about your pass being used
multiple times or being


920
00:41:45,486 --> 00:41:47,156
on multiple devices:
validate it.


921
00:41:47,156 --> 00:41:48,466
Check the barcode
with the server.


922
00:41:48,786 --> 00:41:51,436
That's what it's for.


923
00:41:51,656 --> 00:41:55,356
So to review that, we have the
code-scanning API now available


924
00:41:55,356 --> 00:41:59,246
on AVFoundation, and
we have these new keys


925
00:41:59,246 --> 00:42:01,986
to expire your passes, to mark
them as expired in the UI.


926
00:42:02,916 --> 00:42:06,296
And, again, if it matters
to you your pass being


927
00:42:06,296 --> 00:42:08,996
on multiple places or used
multiple times: validate them.


928
00:42:08,996 --> 00:42:10,576
Check the pass with your server.


929
00:42:11,956 --> 00:42:12,906
So that's what's new.


930
00:42:12,906 --> 00:42:17,016
Let's talk a couple of tips,
tricks, things to help you


931
00:42:17,016 --> 00:42:19,446
with your development
and make your Passbook


932
00:42:19,446 --> 00:42:20,916
integration better.


933
00:42:21,906 --> 00:42:24,366
First, we have some
developer settings


934
00:42:24,596 --> 00:42:25,566
which you may have seen before.


935
00:42:25,686 --> 00:42:27,456
They're in Settings > Developer.


936
00:42:28,386 --> 00:42:32,106
And they're really useful
for debugging your passes


937
00:42:32,336 --> 00:42:34,506
and your web services
and all kinds of things.


938
00:42:35,356 --> 00:42:39,176
First, there's a logging switch,
which allows you to see a bunch


939
00:42:39,176 --> 00:42:40,656
of extra information
about what we're doing,


940
00:42:40,656 --> 00:42:42,956
about what your pass
might be doing.


941
00:42:43,276 --> 00:42:45,206
If you have validation
errors they'll show up there.


942
00:42:45,536 --> 00:42:46,926
If you have weird
things happening


943
00:42:46,956 --> 00:42:49,166
with your web service
like [inaudible].


944
00:42:50,586 --> 00:42:53,846
We have a switch to
allow HTTP services.


945
00:42:53,916 --> 00:42:55,286
If you're doing some
early development,


946
00:42:55,286 --> 00:42:56,866
if you don't have your
server's certificate set up,


947
00:42:57,146 --> 00:42:59,546
you can turn the switch
on, point your passes


948
00:42:59,546 --> 00:43:02,096
at some local server
without any validation


949
00:43:02,096 --> 00:43:04,786
and it will just work.


950
00:43:04,786 --> 00:43:07,776
And finally, we have a new
switch which ties into a feature


951
00:43:07,776 --> 00:43:11,216
that we haven't really talked
about before but that some


952
00:43:11,216 --> 00:43:13,056
of you may notice,
which is rate limiting.


953
00:43:13,796 --> 00:43:17,056
So if you push a punch of
updates to a pass in a row,


954
00:43:17,696 --> 00:43:19,786
that means we have to keep
downloading the pass over


955
00:43:19,786 --> 00:43:21,636
and over again, and that
uses the user's battery,


956
00:43:21,636 --> 00:43:23,716
it uses a bunch of
your server resources.


957
00:43:24,686 --> 00:43:27,126
And so we will throttle
that back.


958
00:43:27,126 --> 00:43:28,096
If we get a ton of updates


959
00:43:28,096 --> 00:43:29,906
in a row we'll start
decreasing the rate


960
00:43:29,906 --> 00:43:32,616
at which we actually
check for the pass.


961
00:43:33,346 --> 00:43:36,606
And that helps users and means


962
00:43:36,606 --> 00:43:38,586
if you have some
unexpected issues


963
00:43:38,586 --> 00:43:40,806
in your push system
then you're not going


964
00:43:40,806 --> 00:43:43,446
to get an unexpected spike of
server load, which is great.


965
00:43:43,446 --> 00:43:45,506
But if you're testing something,
if you're actually trying


966
00:43:45,506 --> 00:43:47,076
to send a ton of pushes
to a pass in a row,


967
00:43:47,386 --> 00:43:49,076
then that's kind of
a problem for you.


968
00:43:49,406 --> 00:43:51,006
And so you can turn this on


969
00:43:51,006 --> 00:43:53,336
and we will update
the pass immediately


970
00:43:53,336 --> 00:43:54,836
for every push that
you send to us.


971
00:43:55,776 --> 00:43:58,266
So use that if you need it.


972
00:43:58,976 --> 00:44:01,476
Something to note
about all of these is


973
00:44:01,476 --> 00:44:03,446
that they're only available
on development devices.


974
00:44:03,446 --> 00:44:06,796
Your users will not have
these switches in most cases


975
00:44:06,796 --> 00:44:08,556
and they will almost certainly
not have them turned on.


976
00:44:08,756 --> 00:44:12,236
So your web services in
production do need to be HTTPS,


977
00:44:12,386 --> 00:44:16,996
and they do need to be aware
at least of the rate limiting


978
00:44:16,996 --> 00:44:18,746
that we do if you're
sending a ton of pushes.


979
00:44:20,356 --> 00:44:25,186
So I mentioned that the logging
could help you find issues


980
00:44:25,186 --> 00:44:26,086
with your web services.


981
00:44:26,326 --> 00:44:28,826
And that will work great
for you if you're doing this


982
00:44:28,826 --> 00:44:30,536
in a development
environment and testing


983
00:44:30,536 --> 00:44:33,936
out the first implementation
of your server.


984
00:44:34,386 --> 00:44:37,226
But in production we have
something else for you.


985
00:44:37,346 --> 00:44:40,216
And this was mentioned
briefly in last year's talk


986
00:44:40,426 --> 00:44:42,196
about the web service API.


987
00:44:43,576 --> 00:44:47,336
And all it is is a way for
you to easily catch issues


988
00:44:47,656 --> 00:44:48,626
with your implementation.


989
00:44:49,216 --> 00:44:51,236
If your web service is
sending us down things


990
00:44:51,236 --> 00:44:53,946
that aren't passes, or if you're
sending pushes that don't result


991
00:44:53,946 --> 00:44:56,396
in an actual change to the
pass, we will tell you.


992
00:44:56,396 --> 00:45:00,146
We will send a message to
this URL with logs on the end,


993
00:45:00,146 --> 00:45:03,566
and that will let you know
that something is happening.


994
00:45:03,566 --> 00:45:04,756
So watch this endpoint.


995
00:45:05,096 --> 00:45:07,486
If you're getting reports
from your users of some issues


996
00:45:07,486 --> 00:45:11,026
in production, you could make
a ton of surveys and ask people


997
00:45:11,026 --> 00:45:13,816
"what were you doing when you
didn't get this pass updated".


998
00:45:14,196 --> 00:45:17,516
Or, you can just watch
this endpoint and find


999
00:45:17,516 --> 00:45:19,996
out what's going on
from us directly.


1000
00:45:20,896 --> 00:45:22,066
So that's really useful.


1001
00:45:23,226 --> 00:45:25,246
The most common issue
that we've seen --


1002
00:45:25,246 --> 00:45:27,206
and that we do message
to this endpoint --


1003
00:45:28,076 --> 00:45:31,676
is people not using the
Last-Modified/If-Modified-Since


1004
00:45:31,766 --> 00:45:32,196
system.


1005
00:45:32,706 --> 00:45:35,576
And the way that works -- again
more detail in last year's talk,


1006
00:45:35,576 --> 00:45:37,136
but I can summarize it --


1007
00:45:37,516 --> 00:45:40,306
is that when you update a
pass you can send out a header


1008
00:45:40,646 --> 00:45:42,576
with a blob of information
saying "here is


1009
00:45:42,576 --> 00:45:43,756
when we last changed this pass".


1010
00:45:43,896 --> 00:45:46,876
And then the next request we
make will include that header


1011
00:45:46,876 --> 00:45:48,896
and say "have you
changed it since then?"


1012
00:45:48,896 --> 00:45:52,566
If the answer is "no", your
server sends down an HTTP 304


1013
00:45:52,956 --> 00:45:55,686
"nothing changed" and we
don't download the pass.


1014
00:45:55,776 --> 00:45:59,026
And that saves both your users'
batteries and cellular usage,


1015
00:45:59,026 --> 00:46:01,616
and it saves your
server resources.


1016
00:46:01,766 --> 00:46:03,216
So: use that.


1017
00:46:04,446 --> 00:46:06,156
It's kind of nice.


1018
00:46:06,916 --> 00:46:08,916
So let's review all this.


1019
00:46:09,086 --> 00:46:10,856
First, the ecosystem.


1020
00:46:11,546 --> 00:46:14,016
Passes are information that
can be used in the real world.


1021
00:46:14,676 --> 00:46:15,806
They come from your server.


1022
00:46:16,436 --> 00:46:19,056
They get into the user's
pass library via apps


1023
00:46:19,356 --> 00:46:20,496
of various descriptions.


1024
00:46:21,516 --> 00:46:22,746
They're redeemed or used


1025
00:46:22,746 --> 00:46:24,086
by scanning the barcode
on the pass.


1026
00:46:24,536 --> 00:46:26,816
And you can update them
using our push mechanism.


1027
00:46:28,756 --> 00:46:29,766
What's new with passes?


1028
00:46:30,026 --> 00:46:32,016
We have richer pass content.


1029
00:46:32,836 --> 00:46:34,986
We have some easier ways
to get passes, both APIs


1030
00:46:34,986 --> 00:46:36,596
and user-facing features.


1031
00:46:36,946 --> 00:46:41,166
We have more control over pass
relevance, the new beacon API


1032
00:46:41,166 --> 00:46:42,896
and the new distance
restrictions.


1033
00:46:43,986 --> 00:46:46,216
And we finally have a couple
of things that could help you


1034
00:46:46,456 --> 00:46:48,776
around the whole
using-your-passes experience.


1035
00:46:49,146 --> 00:46:52,776
Tips and tricks: use
the developer settings.


1036
00:46:52,776 --> 00:46:54,676
They have real useful
information for you.


1037
00:46:55,846 --> 00:46:57,316
And use the logging endpoint


1038
00:46:57,476 --> 00:47:00,286
because it will help you catch
your errors in production


1039
00:47:00,356 --> 00:47:01,536
which is super useful.


1040
00:47:03,606 --> 00:47:07,876
Finally, we have a lot of new
APIs, as you've just seen.


1041
00:47:07,876 --> 00:47:10,086
We have a couple of
new user features


1042
00:47:10,086 --> 00:47:13,866
that can affect how you
integrate with Passbook.


1043
00:47:15,226 --> 00:47:17,586
If it matters to you about your
pass being on multiple devices:


1044
00:47:17,586 --> 00:47:19,336
validate them, check
the barcodes,


1045
00:47:19,336 --> 00:47:21,806
because it is way easier for
passes to be everywhere now.


1046
00:47:22,506 --> 00:47:24,556
And, finally, give us feedback.


1047
00:47:25,596 --> 00:47:27,556
You might have noticed that
I keep calling things out as


1048
00:47:27,556 --> 00:47:29,946
"this is from a request
we had from developers".


1049
00:47:29,946 --> 00:47:32,476
And there's a reason for
that, which is that a lot


1050
00:47:32,476 --> 00:47:35,606
of these ideas are based on
requests that we've gotten.


1051
00:47:35,606 --> 00:47:37,066
So tell us what you want.


1052
00:47:37,146 --> 00:47:38,246
We will listen.


1053
00:47:38,246 --> 00:47:40,136
We read every bug that you file.


1054
00:47:40,286 --> 00:47:43,376
You can talk to our evangelist,
Paul Marcos [phonetic].


1055
00:47:44,386 --> 00:47:47,716
There's documentation
on developer.apple.com,


1056
00:47:48,266 --> 00:47:50,406
and we will be in the
Apple developer forums.


1057
00:47:51,816 --> 00:47:55,096
Finally, there's a
couple of new sessions


1058
00:47:55,096 --> 00:47:55,946
that are related to this.


1059
00:47:55,946 --> 00:47:58,826
The What's New in Camera Capture
one is actually right now,


1060
00:47:58,826 --> 00:48:01,036
so you are too late, but you
can watch the video later.


1061
00:48:01,736 --> 00:48:05,286
That talks about the new
AVFoundation code-scanning APIs.


1062
00:48:06,086 --> 00:48:09,416
The next talk, Integrating
Passbook Into Your Ecosystem,


1063
00:48:09,666 --> 00:48:11,366
is actually really
interesting because it's


1064
00:48:11,366 --> 00:48:13,066
from the Apple Store app team


1065
00:48:13,406 --> 00:48:17,006
who developed a really nice
integration of Passbook


1066
00:48:17,006 --> 00:48:20,396
with their gift cards that
was based entirely on the API


1067
00:48:20,396 --> 00:48:23,616
that you guys are using,
on the public APIs.


1068
00:48:23,666 --> 00:48:26,526
They aren't us, and you
can go to their talk


1069
00:48:26,526 --> 00:48:29,746
to get a really good idea for
what Passbook integration looks


1070
00:48:29,746 --> 00:48:33,026
like in a really large
scale, high value system.


1071
00:48:33,946 --> 00:48:36,246
So, go to that talk:
it is at 3:15.


1072
00:48:37,246 --> 00:48:41,016
Finally, the iBeacons API that
I mentioned is in CoreLocation.


1073
00:48:41,406 --> 00:48:46,086
Thanks for coming.


1074
00:48:46,086 --> 00:48:46,153
[ Applause ]


1075
00:48:46,153 --> 00:48:46,220
NW

